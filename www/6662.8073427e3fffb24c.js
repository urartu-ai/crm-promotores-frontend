"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6662],{6906:(x,C,a)=>{a.d(C,{CP:()=>f,I:()=>v,Rl:()=>g,qA:()=>y});let f=["#686868","#00C751","#C98BDB","#C0AC4C","#3A50E4","#F14E1C"],v={"#686868":"#F0F0F0","#00C751":"#E5F9EE","#C98BDB":"#FAF3FB","#C0AC4C":"#FFFBE8","#3A50E4":"#ECF2FF","#F14E1C":"#FEEDE8"};const g=[{key:"sole_administrator",label:"Administrador \xfanico"},{key:"joint_and_several_administrator",label:"Administrador solidario"},{key:"joint_administrator",label:"Administrador mancomunado"},{key:"delegated_director",label:"Consejero delegado"},{key:"general_attorney",label:"Apoderado general"},{key:"special_attorney",label:"Apoderado especial"},{key:"chairman_of_board",label:"Presidente del Consejo"}],y={sole_administrator:"Administrador \xfanico",joint_and_several_administrator:"Administrador solidario",joint_administrator:"Administrador mancomunado",delegated_director:"Consejero delegado",general_attorney:"Apoderado general",special_attorney:"Apoderado especial",chairman_of_board:"Presidente del Consejo"}},4954:(x,C,a)=>{a.d(C,{R:()=>n});var t=a(3953),f=a(8359),v=a(467),g=a(1413),y=a(152),d=a(5558),_=a(2081);let A=(()=>{var i;class r{constructor(o){this.api=o,this.searchTermSubject=new g.B,this.searchResults$=this.searchTermSubject.pipe((0,y.B)(300),(0,d.n)(u=>this.performSearch(u)))}search(o){this.searchTermSubject.next(o)}performSearch(o){var u=this;return(0,v.A)(function*(){var h;o=(o=o.trim()).toLowerCase();const b=yield u.api.getUser({OR:[{name:{contains:o,mode:"insensitive"}},{email:{contains:o,mode:"insensitive"}}]},null,{page:0,itemsPerPage:10});return(null==b||null===(h=b.success)||void 0===h?void 0:h.data)||[]})()}}return(i=r).\u0275fac=function(o){return new(o||i)(t.KVO(_.i))},i.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"}),r})();var S=a(177),p=a(9417);const k=["wrapper"];function I(i,r){if(1&i){const l=t.RV6();t.j41(0,"div",9),t.bIt("click",function(u){const h=t.eBV(l).$implicit,b=t.XpG(2);return t.Njj(b.onUserSelect(h,u))}),t.j41(1,"div",10)(2,"div",11),t.nrm(3,"img",12),t.k0s(),t.j41(4,"div",13)(5,"div",14),t.EFF(6),t.k0s(),t.j41(7,"div",15),t.EFF(8),t.k0s()()(),t.nrm(9,"div",16),t.k0s()}if(2&i){const l=r.$implicit;t.R7$(3),t.Y8G("src",null==l?null:l.photoUrl,t.B4B),t.R7$(3),t.SpI(" ",null==l?null:l.name," "),t.R7$(2),t.SpI(" ",null==l?null:l.email," ")}}function e(i,r){1&i&&(t.j41(0,"div",17),t.EFF(1," No hay resultados "),t.k0s())}function s(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,I,10,3,"div",7,t.fX1),t.DNE(3,e,2,0,"div",8),t.k0s()),2&i){const l=t.XpG();t.R7$(),t.Dyx(l.searchResults),t.R7$(2),t.Y8G("ngIf",0===l.searchResults.length)}}let n=(()=>{var i;class r{constructor(o,u){this.renderer=o,this.searchbarService=u,this.userSelected=new t.bkB,this.clickOutSide=new t.bkB,this.searchTerm="",this.dropdownOpen=!1,this.searchResults=[],this.clicked=!1,this.globalClickUnlistener=null,this.documentClickListenerCleanup=null,this.searchSubscription=new f.yU}ngOnInit(){this.searchSubscription=this.searchbarService.searchResults$.subscribe(o=>{this.searchResults=o})}ngAfterViewInit(){this.documentClickListenerCleanup=this.renderer.listen("document","click",o=>{!this.wrapperRef.nativeElement.contains(o.target)&&this.clicked&&this.clickOutSide.emit(),this.clicked=!0})}onInputClick(o){o.stopPropagation(),this.dropdownOpen||(this.openDropdown(),this.searchbarService.performSearch(""))}onSearchTermChange(o){this.searchTerm=o,this.searchbarService.search(o)}onUserSelect(o,u){u.stopPropagation(),this.closeDropdown(),this.userSelected.emit(o)}openDropdown(){this.dropdownOpen=!0,this.attachDocumentClickListener()}closeDropdown(){this.dropdownOpen=!1,this.detachDocumentClickListener()}attachDocumentClickListener(){this.globalClickUnlistener=this.renderer.listen("document","click",o=>{o.target.closest(".agents-searchbar-container")||(this.closeDropdown(),this.clickOutSide.emit())})}detachDocumentClickListener(){this.globalClickUnlistener&&(this.globalClickUnlistener(),this.globalClickUnlistener=null)}ngOnDestroy(){this.detachDocumentClickListener(),this.searchSubscription.unsubscribe(),this.documentClickListenerCleanup&&(this.documentClickListenerCleanup(),this.documentClickListenerCleanup=null)}}return(i=r).\u0275fac=function(o){return new(o||i)(t.rXU(t.sFG),t.rXU(A))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-agents-searchbar"]],viewQuery:function(o,u){if(1&o&&t.GBs(k,5),2&o){let h;t.mGM(h=t.lsd())&&(u.wrapperRef=h.first)}},outputs:{userSelected:"userSelected",clickOutSide:"clickOutSide"},decls:6,vars:2,consts:[["wrapper",""],[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar","crm-input-input-searchbar-square","agents-searchbar-container",3,"click"],[1,"fas","fa-search"],["type","text","placeholder","Nombre",3,"ngModelChange","ngModel"],["class","dropdown-options",4,"ngIf"],[1,"dropdown-options"],[1,"crm-item-searchbar-agent-result"],["class","no-results",4,"ngIf"],[1,"crm-item-searchbar-agent-result",3,"click"],[1,"crm-item-searchbar-agent-result-left"],[1,"crm-item-searchbar-agent-result-left-image"],["alt","",3,"src"],[1,"crm-item-searchbar-agent-result-left-info"],[1,"crm-item-searchbar-agent-result-left-info-name"],[1,"crm-item-searchbar-agent-result-left-info-email"],[1,"crm-item-searchbar-agent-result-right"],[1,"no-results"]],template:function(o,u){if(1&o){const h=t.RV6();t.j41(0,"div",1)(1,"div",2,0),t.bIt("click",function(m){return t.eBV(h),t.Njj(u.onInputClick(m))}),t.nrm(3,"i",3),t.j41(4,"input",4),t.mxI("ngModelChange",function(m){return t.eBV(h),t.DH7(u.searchTerm,m)||(u.searchTerm=m),t.Njj(m)}),t.bIt("ngModelChange",function(m){return t.eBV(h),t.Njj(u.onSearchTermChange(m))}),t.k0s(),t.DNE(5,s,4,1,"div",5),t.k0s()()}2&o&&(t.R7$(4),t.R50("ngModel",u.searchTerm),t.R7$(),t.Y8G("ngIf",u.dropdownOpen))},dependencies:[S.bT,p.me,p.BC,p.vS],styles:[".agents-searchbar-container[_ngcontent-%COMP%]{position:relative;cursor:pointer}.dropdown-options[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:100%;z-index:9999;background-color:#fff;padding:8px 0;border-radius:8px;border:1px solid var(--crm-border-light-color);max-height:200px;overflow-y:auto;font-size:14px}.option[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;cursor:pointer;font-size:14px}.option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.no-results[_ngcontent-%COMP%]{padding:8px;color:#888}"]}),r})()},4035:(x,C,a)=>{a.d(C,{y:()=>I});var t=a(3953),f=a(8359),v=a(3323),g=a(5188),y=a(177),d=a(9417);function _(e,s){if(1&e){const n=t.RV6();t.j41(0,"div",8),t.bIt("click",function(r){t.eBV(n);const l=t.XpG().$implicit,o=t.XpG(2);return t.Njj(o.onContactSelect(l,r))}),t.j41(1,"div",9)(2,"div",10),t.nrm(3,"img",11),t.k0s(),t.j41(4,"div",12)(5,"div",13),t.EFF(6),t.k0s(),t.j41(7,"div",14),t.EFF(8),t.k0s()()(),t.j41(9,"div",15),t.EFF(10),t.k0s()()}if(2&e){const n=t.XpG().$implicit;t.R7$(3),t.Y8G("src",(null==n?null:n.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==n?null:n.name," "),t.R7$(2),t.SpI(" ",null==n||null==n.emails?null:n.emails[0]," "),t.R7$(2),t.SpI(" ",null==n?null:n.reference," ")}}function A(e,s){if(1&e&&t.DNE(0,_,11,4,"div",7),2&e){const n=s.$implicit,i=t.XpG(2);t.vxM(i.excludeItems.includes(n.id)?-1:0)}}function S(e,s){1&e&&(t.j41(0,"div",17)(1,"a",18),t.EFF(2," Crear nuevo contacto"),t.k0s()())}function p(e,s){if(1&e&&(t.j41(0,"div",16)(1,"div"),t.EFF(2,"No hay resultados"),t.k0s(),t.DNE(3,S,3,0,"div",17),t.k0s()),2&e){const n=t.XpG(2);t.R7$(3),t.vxM("show_create_contact"===n.context?3:-1)}}function k(e,s){if(1&e&&(t.j41(0,"div",5),t.Z7z(1,A,1,1,null,null,t.fX1),t.DNE(3,p,4,1,"div",6),t.k0s()),2&e){const n=t.XpG();t.R7$(),t.Dyx(n.searchResults),t.R7$(2),t.Y8G("ngIf",0===n.searchResults.length)}}let I=(()=>{var e;class s{constructor(i,r,l){this.renderer=i,this.searchbarService=r,this.router=l,this.contactSelected=new t.bkB,this.changeInput=new t.bkB,this.searchTerm="",this.context="",this.excludeItems=[],this.dropdownOpen=!1,this.searchResults=[],this.globalClickUnlistener=null,this.searchSubscription=new f.yU}ngOnInit(){this.searchSubscription=this.searchbarService.searchResults$.subscribe(i=>{this.searchResults=i})}onInputClick(i){i.stopPropagation(),this.searchTerm&&this.searchbarService.search(this.searchTerm,[],!1,this.additionalFilters),this.dropdownOpen||this.openDropdown()}onSearchTermChange(i){this.searchTerm=i,this.searchbarService.search(i,[],!1,this.additionalFilters),this.changeInput.emit(i)}onContactSelect(i,r){r.stopPropagation(),this.closeDropdown(),this.contactSelected.emit(i)}openDropdown(){this.dropdownOpen=!0,this.attachDocumentClickListener()}closeDropdown(){this.dropdownOpen=!1,this.detachDocumentClickListener()}attachDocumentClickListener(){this.globalClickUnlistener=this.renderer.listen("document","click",i=>{i.target.closest(".agents-searchbar-container")||this.closeDropdown()})}detachDocumentClickListener(){this.globalClickUnlistener&&(this.globalClickUnlistener(),this.globalClickUnlistener=null)}ngOnDestroy(){this.detachDocumentClickListener(),this.searchSubscription.unsubscribe()}}return(e=s).\u0275fac=function(i){return new(i||e)(t.rXU(t.sFG),t.rXU(v.g),t.rXU(g.Ix))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contacts-searchbar"]],inputs:{searchTerm:"searchTerm",context:"context",excludeItems:"excludeItems",additionalFilters:"additionalFilters"},outputs:{contactSelected:"contactSelected",changeInput:"changeInput"},decls:5,vars:2,consts:[[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar","crm-input-input-searchbar-square","agents-searchbar-container",3,"click"],[1,"fas","fa-search"],["type","text","placeholder","Nombre",3,"ngModelChange","ngModel"],["class","dropdown-options mt-[5px]",4,"ngIf"],[1,"dropdown-options","mt-[5px]"],["class","no-results",4,"ngIf"],[1,"crm-item-searchbar-agent-result"],[1,"crm-item-searchbar-agent-result",3,"click"],[1,"crm-item-searchbar-agent-result-left"],[1,"crm-item-searchbar-agent-result-left-image"],["alt","",3,"src"],[1,"crm-item-searchbar-agent-result-left-info"],[1,"crm-item-searchbar-agent-result-left-info-name","!text-[14px]"],[1,"crm-item-searchbar-agent-result-left-info-email","!text-[12px]"],[1,"crm-item-searchbar-agent-result-right","!text-[13px]","text-secondary"],[1,"no-results"],[1,"text-[12px]","cursor-pointer","mt-[15px]"],["href","/contacts/create"]],template:function(i,r){1&i&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(o){return r.onInputClick(o)}),t.nrm(2,"i",2),t.j41(3,"input",3),t.mxI("ngModelChange",function(o){return t.DH7(r.searchTerm,o)||(r.searchTerm=o),o}),t.bIt("ngModelChange",function(o){return r.onSearchTermChange(o)}),t.k0s(),t.DNE(4,k,4,1,"div",4),t.k0s()()),2&i&&(t.R7$(3),t.R50("ngModel",r.searchTerm),t.R7$(),t.Y8G("ngIf",r.dropdownOpen))},dependencies:[y.bT,d.me,d.BC,d.vS],styles:[".agents-searchbar-container[_ngcontent-%COMP%]{position:relative;cursor:pointer}.dropdown-options[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:100%;z-index:9999;background-color:#fff;padding:8px 0;border-radius:8px;border:1px solid var(--crm-border-light-color);max-height:150px;overflow-y:auto;font-size:14px}.option[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;cursor:pointer;font-size:14px}.option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.no-results[_ngcontent-%COMP%]{padding:8px;color:#888}"]}),s})()},3323:(x,C,a)=>{a.d(C,{g:()=>S});var t=a(467),f=a(1413),v=a(152),g=a(8141),y=a(5558),d=a(4668),_=a(3953),A=a(2081);let S=(()=>{var p;class k{constructor(e){this.api=e,this.searchTermSubject=new f.B,this.searchResults$=this.searchTermSubject.pipe((0,v.B)(300),(0,g.M)(()=>console.log("\u{1f50d} searchResults$ subscriber triggered")),(0,y.n)(({term:s,fieldsToSearch:n,exactMatch:i,additionalFilters:r})=>this.performSearch(s,n,i,r)),(0,d.t)(1))}search(e,s,n=!1,i){this.searchTermSubject.next({term:e,fieldsToSearch:s,exactMatch:n,additionalFilters:i})}performSearch(e,s,n=!1,i){var r=this;return(0,t.A)(function*(){var l;e=(e=e.trim()).toLowerCase();const b={OR:(s&&s.length>0?s:["name","email1","email2","email3","email4","email5","phone1","phone2","phone3","phone4","phone5"]).map(O=>({[O]:n?{equals:e,mode:"insensitive"}:{contains:e,mode:"insensitive"}}))};i&&Object.keys(i).length>0&&(b.AND=Object.entries(i).map(([O,T])=>({[O]:T})));const m=yield r.api.getContacts(b,null,{page:0,itemsPerPage:10},{contactsRelation:{apply:!0,filter:{},onlyCount:!1}});return(null==m||null===(l=m.success)||void 0===l?void 0:l.data)||[]})()}}return(p=k).\u0275fac=function(e){return new(e||p)(_.KVO(A.i))},p.\u0275prov=_.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),k})()},8129:(x,C,a)=>{a.d(C,{K:()=>f});var t=a(3953);let f=(()=>{var v;class g{constructor(d,_){this.el=d,this.renderer=_,this.isLoading=!1}ngOnChanges(d){"isLoading"in d&&this.updateButtonState()}updateButtonState(){const d=this.el.nativeElement;if(this.isLoading){d.getAttribute("data-original-content")||this.renderer.setAttribute(d,"data-original-content",d.innerHTML),this.renderer.setProperty(d,"disabled",!0),this.renderer.setStyle(d,"opacity","0.6"),this.renderer.setStyle(d,"pointer-events","none"),this.renderer.setStyle(d,"cursor","not-allowed");const _=this.renderer.createElement("ion-spinner"),A=this.renderer.createText(" Cargando...");this.renderer.setProperty(d,"innerHTML",""),this.renderer.appendChild(d,_),this.renderer.appendChild(d,A)}else{this.renderer.setProperty(d,"disabled",!1),this.renderer.removeStyle(d,"opacity"),this.renderer.removeStyle(d,"pointer-events"),this.renderer.removeStyle(d,"cursor");const _=d.getAttribute("data-original-content");_&&(this.renderer.setProperty(d,"innerHTML",_),this.renderer.removeAttribute(d,"data-original-content"))}}}return(v=g).\u0275fac=function(d){return new(d||v)(t.rXU(t.aKT),t.rXU(t.sFG))},v.\u0275dir=t.FsC({type:v,selectors:[["","appLoadingButton",""]],inputs:{isLoading:[0,"appLoadingButton","isLoading"]},standalone:!0,features:[t.OA$]}),g})()},9333:(x,C,a)=>{a.d(C,{F:()=>S});var t=a(467);const f=[{id:"1",name:"Juan P\xe9rez",emails:["juan.perez@example.com"],phones:["+34 600 123 456"],address:"Calle Mayor 123, 28013 Madrid, Espa\xf1a",reference:"Ref001",origin:"Idealista",photoUrl:"https://randomuser.me/api/portraits/men/1.jpg",photoName:"juan_perez.jpg",createdAt:new Date("2024-01-15T10:00:00"),updatedAt:new Date("2024-04-20T15:30:00"),tags:[{id:"tag1",value:"Interested",text:"Interested in product"},{id:"tag2",value:"Follow-Up",text:"Requires follow-up"}]},{id:"2",name:"Mar\xeda L\xf3pez",emails:["maria.lopez@example.com"],phones:["+34 600 789 012"],address:"Avenida de la Constituci\xf3n 45, 41004 Sevilla, Espa\xf1a",reference:"Ref002",origin:"Fotocasa",photoUrl:"https://randomuser.me/api/portraits/women/2.jpg",photoName:"maria_lopez.png",createdAt:new Date("2023-11-10T09:30:00"),updatedAt:new Date("2024-03-18T11:45:00"),tags:[{id:"tag3",value:"VIP",text:"VIP customer"}]},{id:"3",name:"Carlos Garc\xeda",emails:["carlos.garcia@example.com","cgarcia@personalmail.com"],phones:["+34 600 345 678"],address:"Calle de la Luna 78, 08002 Barcelona, Espa\xf1a",reference:"Ref003",origin:"Manual",photoUrl:"https://randomuser.me/api/portraits/men/3.jpg",photoName:"carlos_garcia.jpg",createdAt:new Date("2024-02-05T14:20:00"),updatedAt:new Date("2024-05-10T16:00:00"),tags:[{id:"tag4",value:"Needs Info",text:"Needs more information"},{id:"tag5",value:"Interested",text:"Interested in product"}]},{id:"4",name:"Luc\xeda Fern\xe1ndez",emails:["lucia.fernandez@example.com"],phones:["+34 600 901 234","+34 600 567 890"],address:"Paseo de Gracia 256, 08007 Barcelona, Espa\xf1a",reference:"Ref004",origin:"Habitaclia",photoUrl:"https://randomuser.me/api/portraits/women/4.jpg",photoName:"lucia_fernandez.png",createdAt:new Date("2023-12-22T08:15:00"),updatedAt:new Date("2024-06-25T13:50:00"),tags:[{id:"tag6",value:"Repeat Client",text:"Repeat client"}]},{id:"5",name:"Pedro Mart\xednez",emails:["pedro.martinez@example.com"],phones:["+34 600 234 567"],address:"Calle de Alcal\xe1 89, 28014 Madrid, Espa\xf1a",reference:"Ref005",origin:"Idealista",photoUrl:"https://randomuser.me/api/portraits/men/5.jpg",photoName:"pedro_martinez.jpg",createdAt:new Date("2024-03-12T12:00:00"),updatedAt:new Date("2024-07-30T10:25:00"),tags:[{id:"tag7",value:"New",text:"New contact"},{id:"tag8",value:"Potential",text:"Potential client"}]},{id:"6",name:"Ana Torres",emails:["ana.torres@example.com"],phones:["+34 600 678 901"],address:"Gran V\xeda 45, 28013 Madrid, Espa\xf1a",reference:"Ref006",origin:"Manual",photoUrl:"https://randomuser.me/api/portraits/women/6.jpg",photoName:"ana_torres.jpg",createdAt:new Date("2024-04-01T11:00:00"),updatedAt:new Date("2024-08-15T14:30:00"),tags:[{id:"tag9",value:"VIP",text:"VIP customer"},{id:"tag10",value:"Loyal",text:"Loyal customer"}]}];var v=a(7376),g=a(3953),y=a(8397),d=a(2081),_=a(6552),A=a(3955);let S=(()=>{var p;class k{constructor(e,s,n,i){this.toastService=e,this.api=s,this.utils=n,this.translate=i,this.mockContacts=f,this.possibleValues={contactType:["potential_client","client"],origin:["Idealista","Fotocasa","Manual","Habitaclia"],nationality:["spain","france","germany"],gender:["male","female","other"]}}getContacts(e,s,n,i){var r=this;return(0,t.A)(function*(){const l=yield r.api.getContacts(e,s||{field:"createdAt",order:"desc"},n||{page:0,itemsPerPage:50},i||{tag:{apply:!0,filter:null,onlyCount:!1},operations:{apply:!0,filter:null,onlyCount:!1},contactsRelated:{apply:!0,filter:{},onlyCount:!1},contactsRelation:{apply:!0,filter:{},onlyCount:!1},responsableUsers:{apply:!0,filter:null,onlyCount:!1}});return console.log("ELS CONTACTS",l),l.success})()}updateContactById(e,s){var n=this;return(0,t.A)(function*(){yield n.api.updateContactById(e,s)})()}createOrUpdateContactFromForm(e,s){var n=this;return(0,t.A)(function*(){try{const m=e.contactForm;if(m.markAllAsTouched(),m.valid){var i,r,l,o;let O=v.cloneDeep(m.value),T=n.buildContactFromForm(O);if(T=yield e.fileUploaderManager.processProfilePic(T),T=n.utils.parseProperties(T),T.languages=(null==e||null===(i=e.contact)||void 0===i?void 0:i.languages)||[],T.nationality=(null==e||null===(r=e.contact)||void 0===r?void 0:r.nationality)||null,console.log("EL CONTACT",v.cloneDeep(T)),s)yield n.api.updateContactById(s,T);else{var u;const c=yield n.api.createContact(T);s=null==c||null===(u=c.success)||void 0===u||null===(u=u.data)||void 0===u?void 0:u.id}const R=(null==e||null===(l=e.contact)||void 0===l?void 0:l.responsableUsers)||[];for(let c of R)null!=c&&c.removed&&(yield n.api.removeUserFromContact(s,c.id)),null!=c&&c.new&&(yield n.api.addUserToContact(s,c.id));const P=(null==e||null===(o=e.contact)||void 0===o?void 0:o.contactsRelation)||[];for(let c of P){var h,b;if(console.log("LA CONTACT RELATION",c),null!=c&&c.removed)yield n.api.removeContactRelation(s,null==c||null===(h=c.contactRelated)||void 0===h?void 0:h.id);if(null!=c&&c.new)yield n.api.addContactRelation(s,null==c||null===(b=c.contactRelated)||void 0===b?void 0:b.id,null==c?void 0:c.relationType);null!=c&&c.edited&&(yield n.api.editContactRelation(null==c?void 0:c.id,null==c?void 0:c.relationType))}return n.toastService.showToast({text:n.translate.instant("contacts.service.saved"),time:2e3,theme:"success"}),!0}return n.toastService.showToast({text:n.translate.instant("contacts.service.invalid_fields"),time:3e3,theme:"red"}),!1}catch(m){return console.error(m),!1}})()}deleteContact(e){var s=this;return(0,t.A)(function*(){yield s.api.deleteContactById(e),yield s.toastService.showToast({text:s.translate.instant("contacts.service.deleted"),theme:"success",time:3e3}),s.getContacts()})()}getContactById(e){var s=this;return(0,t.A)(function*(){var n;let i=null===(n=yield s.api.getContactById(e))||void 0===n||null===(n=n.success)||void 0===n?void 0:n.data;return i||s.toastService.showToast({text:s.translate.instant("contacts.service.not_found"),icon:"fas fa-exclamation-triangle",theme:"red",time:3e3}),i})()}removeAllContactTags(e){var s=this;return(0,t.A)(function*(){return yield s.api.removeAllContactTags(e)})()}updateContactsTags(e,s){var n=this;return(0,t.A)(function*(){for(let i of e){yield n.removeAllContactTags(i.id);for(let r of s)yield n.api.addTagToContact(i.id,r.id)}})()}buildContactFromForm(e){const s={id:"",name:e.name,contactType:e.contactType,dniPassport:e.dniPassport,typeOfIdentification:e.typeOfIdentification,nationality:e.nationality,origin:e.origin,birthdate:e.birthdate,gender:e.gender,alias:e.alias,address:e.address,phones:e.contactPhones.map(n=>n.phoneNumber),emails:e.contactEmails.map(n=>n.emailAddress),urlFacebook:e.urlFacebook,urlInstagram:e.urlInstagram,urlLinkedIn:e.urlLinkedIn,photoName:e.photoName,photoUrl:e.photoUrl,reference:e.reference,type:e.type};return s.phones=s.phones.filter(n=>n),s.emails=s.emails.filter(n=>n),s}replaceContactsTags(e,s){return e=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(s)),e.map(n=>s.find(r=>r.id===n.id)||n)}createJoinTablesForTags(e){let s={};if(e.tags&&e.tags.length>0){const n=e.tags.map(i=>i.id).filter(i=>void 0!==i);n.length>0&&(s.tag={apply:!0,filter:{id:{in:n}},onlyCount:!1})}return s}transformFilterDataToFilterI(e,s=""){const n={};if(null!=e&&e.name&&(n.name={contains:e.name,mode:"insensitive"}),null!=e&&e.dniPassport&&(n.dniPassport={contains:e.dniPassport,mode:"insensitive"}),null!=e&&e.alias&&(n.alias={contains:e.alias,mode:"insensitive"}),null!=e&&e.address&&(n.address={contains:e.address,mode:"insensitive"}),null!=e&&e.urlFacebook&&(n.urlFacebook={contains:e.urlFacebook,mode:"insensitive"}),null!=e&&e.urlInstagram&&(n.urlInstagram={contains:e.urlInstagram,mode:"insensitive"}),null!=e&&e.urlLinkedIn&&(n.urlLinkedIn={contains:e.urlLinkedIn,mode:"insensitive"}),null!=e&&e.emailAddress&&(n.emails={has:e.emailAddress}),null!=e&&e.phoneNumber&&(n.phones={has:e.phoneNumber}),null!=e&&e.contactType&&e.contactType.length>0){const i=e.contactType.filter(r=>this.possibleValues.contactType.includes(r));i.length>0&&(n.contactType={in:i})}if(null!=e&&e.origin&&e.origin.length>0&&(n.origin={in:e.origin}),null!=e&&e.nationality&&e.nationality.length>0&&(n.nationality={in:e.nationality}),null!=e&&e.agencyRegisteredId&&(n.agencyRegisteredId={equals:e.agencyRegisteredId}),null!=e&&e.gender&&e.gender.length>0){const i=e.gender.filter(r=>this.possibleValues.gender.includes(r));i.length>0&&(n.gender={in:i})}if((null!=e&&e.birthdateFrom||null!=e&&e.birthdateTo)&&(n.birthdate={},e.birthdateFrom&&(n.birthdate.gte=new Date(e.birthdateFrom)),e.birthdateTo&&(n.birthdate.lte=new Date(e.birthdateTo))),(null!=e&&e.createdAtFrom||null!=e&&e.createdAtTo)&&(n.createdAt={},e.createdAtFrom&&(n.createdAt.gte=new Date(e.createdAtFrom)),e.createdAtTo&&(n.createdAt.lte=new Date(e.createdAtTo))),null!=e&&e.associatedUser&&(n.associatedUser={name:{contains:e.associatedUser,mode:"insensitive"}}),s&&""!==s.trim()){const i=this.possibleValues.contactType.filter(o=>o.toLowerCase().includes(s.toLowerCase())),r=this.possibleValues.origin.filter(o=>o.toLowerCase().includes(s.toLowerCase())),l={OR:[{name:{contains:s,mode:"insensitive"}},{dniPassport:{contains:s,mode:"insensitive"}},{alias:{contains:s,mode:"insensitive"}},{address:{contains:s,mode:"insensitive"}},{urlFacebook:{contains:s,mode:"insensitive"}},{urlInstagram:{contains:s,mode:"insensitive"}},{urlLinkedIn:{contains:s,mode:"insensitive"}},{nationality:{contains:s,mode:"insensitive"}},{gender:{contains:s,mode:"insensitive"}},{emails:{has:s}},{phones:{has:s}},...i.length>0?[{contactType:{in:i}}]:[],...r.length>0?[{origin:{in:r}}]:[]]};return Object.keys(n).length>0?{AND:[n,l]}:l}return n}}return(p=k).\u0275fac=function(e){return new(e||p)(g.KVO(y.f),g.KVO(d.i),g.KVO(_.T),g.KVO(A.c$))},p.\u0275prov=g.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),k})()},8392:(x,C,a)=>{a.d(C,{R:()=>t});const t={contactType:[{value:"client",label:"Cliente"},{value:"potential_client",label:"Cliente potencial"},{value:"owner",label:"Propietario"},{value:"external_broker",label:"Broker externo"},{value:"referred",label:"Referido"},{value:"investor",label:"Inversor"}],origin:[{value:"registered_agency",label:"Registrado por agencia"},{value:"a_place_in_the_sun",label:"A Place in the Sun"},{value:"facebook_ads",label:"Facebook Ads"},{value:"fotocasa",label:"Fotocasa"},{value:"google_ads",label:"Google Ads"},{value:"green_acres",label:"Green-Acres"},{value:"habitaclia",label:"Habitaclia"},{value:"james_edition",label:"JamesEdition"},{value:"immobilienscout24",label:"ImmobilienScout24"},{value:"immonet",label:"Immonet"},{value:"immowelt",label:"ImmoWelt"},{value:"idealista",label:"Idealista"},{value:"instagram_ads",label:"Instagram Ads"},{value:"kyero",label:"Kyero"},{value:"linkedin_ads",label:"LinkedIn Ads"},{value:"list_globally",label:"ListGlobally"},{value:"luxury_estate",label:"LuxuryEstate"},{value:"newsletter",label:"Newsletter"},{value:"network_de_agentes_o_brokers",label:"Network de agentes o brokers"},{value:"networking_en_eventos",label:"Networking en eventos"},{value:"pisos_com",label:"Pisos.com"},{value:"prop_go_luxury",label:"PropGoLuxury"},{value:"referido_por_redes_sociales",label:"Referido por redes sociales"},{value:"recomendacion_de_cliente",label:"Recomendaci\xf3n de cliente"},{value:"recomendacion_interna",label:"Recomendaci\xf3n interna (de otros departamentos o contactos)"},{value:"rightmove",label:"Rightmove"},{value:"think_spain",label:"ThinkSpain"},{value:"visitas_presenciales_en_ferias_internacionales",label:"Visitas presenciales en ferias internacionales"},{value:"web_propio",label:"Web propio"},{value:"yaencontre",label:"Yaencontre"},{value:"youtube_ads",label:"YouTube Ads"},{value:"zoopla",label:"Zoopla"}]}}}]);