"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2280],{3274:(M,C,o)=>{o.d(C,{K:()=>p});var h=o(177),s=o(3953);let p=(()=>{var g;class u{}return(g=u).\u0275fac=function(l){return new(l||g)},g.\u0275mod=s.$C({type:g}),g.\u0275inj=s.G2t({imports:[h.MD]}),u})()},5603:(M,C,o)=>{o.d(C,{P:()=>g});var h=o(177),s=o(9417),p=o(3953);let g=(()=>{var u;class v{}return(u=v).\u0275fac=function(n){return new(n||u)},u.\u0275mod=p.$C({type:u}),u.\u0275inj=p.G2t({imports:[h.MD,s.YN]}),v})()},3895:(M,C,o)=>{o.d(C,{b:()=>v});var h=o(177),s=o(9417),p=o(9465),g=o(4842),u=o(3953);let v=(()=>{var l;class n{}return(l=n).\u0275fac=function(_){return new(_||l)},l.\u0275mod=u.$C({type:l}),l.\u0275inj=u.G2t({imports:[h.MD,s.YN,p.bv,g.h]}),n})()},2280:(M,C,o)=>{o.r(C),o.d(C,{SettingsPageModule:()=>B});var h=o(177),s=o(9417),p=o(9465),g=o(3895),u=o(5603),v=o(517),l=o(467),n=o(3953),E=o(6039),_=o(4501),A=o(410),I=o(5970),S=o(1296),b=o(8397),P=o(1213),F=o(8129);function j(a,d){if(1&a){const m=n.RV6();n.j41(0,"div",14),n.bIt("click",function(){const e=n.eBV(m).$implicit,i=n.XpG();return n.Njj(i.onClickAutoLeadInboxEmailAccount(e))}),n.j41(1,"div",15)(2,"div",16),n.nrm(3,"div",17),n.j41(4,"div",18),n.EFF(5),n.k0s()()(),n.j41(6,"div",19)(7,"div",20),n.nrm(8,"i",21),n.k0s(),n.j41(9,"div",22),n.bIt("click",function(e){const i=n.eBV(m).$implicit,c=n.XpG();return n.Njj(c.deleteAutoLeadInboxEmailAccount(e,null==i?null:i.id))}),n.nrm(10,"i",23),n.k0s()()()}if(2&a){const m=d.$implicit;n.R7$(5),n.SpI(" ",null==m?null:m.email," ")}}function D(a,d){1&a&&(n.j41(0,"div",5),n.EFF(1," A\xfan no hay cuentas de correo Inbound "),n.k0s())}const f=a=>({"has-error":a}),y=[{path:"",component:(()=>{var a;class d{constructor(t,e,i,c,r,w,k,U){this.api=t,this.headerService=e,this.route=i,this.modalsService=c,this.popoversService=r,this.tableService=w,this.toastService=k,this.byvaroState=U,this.autoLeadInboxEmailAccounts=[],this.newEmailAccount="",this.loadingButton=!1}ngOnInit(){this.getState()}getState(){return this.byvaroState.getState().subscribe(t=>{this.stateData=t})}ionViewWillEnter(){this.headerService.setConfig({title:"settings"}),this.getData()}getData(){var t=this;return(0,l.A)(function*(){yield t.api.createDefaultAutoLeadInboxEmailAccounts();const i=yield t.api.getAutoLeadInboxEmailAccounts(null,null,null);i.success?t.autoLeadInboxEmailAccounts=i.success.data:t.toastService.showErrorToast("Error getting data")})()}onClickAutoLeadInboxEmailAccount(t){var e=this;return(0,l.A)(function*(){const i=yield e.modalsService.onShowAutoLeadModal(t);console.log("Popover result:",i),e.getData()})()}createAutoLeadInboxEmailAccount(){var t=this;return(0,l.A)(function*(){if(!t.newEmailAccount)return void t.toastService.showErrorToast("Email is required");t.loadingButton=!0;const e=t.stateData.agency||t.stateData.promoter;t.newEmailAccount=t.newEmailAccount.trim(),t.newEmailAccount=t.newEmailAccount.toLowerCase(),t.newEmailAccount=t.newEmailAccount.replace(/[^a-zA-Z0-9]/g,"");const i="leads."+t.newEmailAccount+"."+e.byvaroId+"@leads.byvaro.com";if(!/^[a-zA-Z0-9]{4,20}$/.test(t.newEmailAccount))return t.toastService.showErrorToast("Email must be between 4 and 20 characters and only contain letters and numbers"),void(t.loadingButton=!1);const c=yield t.api.createAutoLeadInboxEmailAccounts({email:i});t.loadingButton=!1,c.success?(t.toastService.showSuccessToast("Email account created"),t.newEmailAccount="",t.getData()):t.toastService.showErrorToast("Error creating email account:"+c.error.errorMessage)})()}deleteAutoLeadInboxEmailAccount(t,e){var i=this;return(0,l.A)(function*(){t.stopPropagation(),t.preventDefault();const c=yield i.api.deleteAutoLeadInboxEmailAccountsById(e);c.success?(i.toastService.showSuccessToast("Email account deleted"),i.getData()):i.toastService.showErrorToast("Error deleting email account:"+c.error.errorMessage)})()}goToImapList(){window.location.href="/settings/imap-accounts"}}return(a=d).\u0275fac=function(t){return new(t||a)(n.rXU(E.i),n.rXU(_.d),n.rXU(v.nX),n.rXU(A.M),n.rXU(I.m),n.rXU(S.a),n.rXU(b.f),n.rXU(P.c))},a.\u0275cmp=n.VBU({type:a,selectors:[["app-settings"]],decls:23,vars:6,consts:[[3,"fullscreen","scrollY"],[1,"crm-block-content"],[1,"crm-block-body",2,"padding","20px"],[1,"crm-section-smaller-title","crm-section-margin-top"],[1,"crm-item-associated-user",2,"width","400px","margin-top","10px","cursor","pointer"],[1,"crm-text"],[1,"crm-input",2,"width","400px"],[1,"crm-input-label"],[1,"crm-input-input"],["placeholder","introduce el nombre del correo",3,"ngModelChange","ngModel"],[1,"crm-input-input-symbol"],[1,"crm-buttons-group"],[1,"crm-button",3,"click","appLoadingButton"],[2,"padding","50px","cursor","pointer",3,"click"],[1,"crm-item-associated-user",2,"width","400px","margin-top","10px","cursor","pointer",3,"click"],[1,"crm-item-associated-user-left"],[1,"crm-item-associated-user-left-info"],[1,"crm-item-associated-user-left-info-name"],[1,"crm-item-associated-user-left-info-email"],[1,"crm-section-buttons-group"],[1,"crm-item-option-edit",2,"margin-right","5px"],[1,"fas","fa-edit"],[1,"crm-item-option-remove",3,"click"],[1,"fas","fa-trash"]],template:function(t,e){1&t&&(n.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3),n.EFF(4," Cuentas de correo Inbound "),n.k0s(),n.nrm(5,"br"),n.Z7z(6,j,11,1,"div",4,n.fX1),n.DNE(8,D,2,0,"div",5),n.nrm(9,"br"),n.j41(10,"div",6)(11,"div",7),n.EFF(12,"Nombre del correo"),n.k0s(),n.j41(13,"div",8)(14,"input",9),n.mxI("ngModelChange",function(c){return n.DH7(e.newEmailAccount,c)||(e.newEmailAccount=c),c}),n.k0s(),n.j41(15,"div",10),n.EFF(16),n.k0s()()(),n.nrm(17,"br"),n.j41(18,"div",11)(19,"button",12),n.bIt("click",function(){return e.createAutoLeadInboxEmailAccount()}),n.EFF(20," Crear cuenta de correo "),n.k0s()()(),n.j41(21,"a",13),n.bIt("click",function(){return e.goToImapList()}),n.EFF(22," Ver cuentas IMAP configuradas "),n.k0s()()()),2&t&&(n.Y8G("fullscreen",!0)("scrollY",!1),n.R7$(6),n.Dyx(e.autoLeadInboxEmailAccounts),n.R7$(2),n.vxM(0==e.autoLeadInboxEmailAccounts.length?8:-1),n.R7$(6),n.R50("ngModel",e.newEmailAccount),n.R7$(2),n.JRh("@leads.byvaro.com"),n.R7$(3),n.Y8G("appLoadingButton",e.loadingButton))},dependencies:[s.me,s.BC,s.vS,p.W9,F.K]}),d})()},{path:"imap-accounts",component:(()=>{var a;class d{constructor(t,e){this.api=t,this.toastService=e,this.imapConnection={email:"",password:"",host:"",port:993,tls:!0}}ngOnInit(){}addImapConnection(){var t=this;return(0,l.A)(function*(){if(t.imapConnection.email&&t.imapConnection.password&&t.imapConnection.host&&t.imapConnection.port)try{yield t.api.addImapConnection(t.imapConnection),t.toastService.showSuccessToast("Buz\xf3n IMAP guardado correctamente.")}catch(e){t.toastService.showErrorToast("Error al guardar el buz\xf3n IMAP."+(null==e?void 0:e.toString()))}else t.toastService.showErrorToast("Por favor, complete todos los campos obligatorios.")})()}}return(a=d).\u0275fac=function(t){return new(t||a)(n.rXU(E.i),n.rXU(b.f))},a.\u0275cmp=n.VBU({type:a,selectors:[["app-imap-connections"]],decls:47,vars:19,consts:[["imapForm","ngForm"],[3,"fullscreen","scrollY"],[1,"crm-block-content"],[1,"crm-block-body",2,"padding","20px"],[2,"max-width","500px",3,"ngSubmit"],[1,"crm-header-icon",2,"margin-bottom","20px"],[1,"crm-header-icon-left"],[1,"crm-square-icon"],[1,"fas","fa-envelope"],[1,"crm-header-icon-title"],[1,"crm-input",3,"ngClass"],[1,"crm-input-label"],[1,"crm-input-input"],["type","email","name","email","placeholder","info@example.com","required","",3,"ngModelChange","ngModel"],["type","text","name","host","placeholder","imap.example.com","required","",3,"ngModelChange","ngModel"],["type","number","name","port","placeholder","993","required","",3,"ngModelChange","ngModel"],[1,"crm-input"],[1,"crm-input-checkboxes"],[1,"crm-input-checkbox"],["name","tls",3,"ngModelChange","ngModel"],[1,"crm-input-checkbox-label"],["type","password","name","password","placeholder","Contrase\xf1a","required","",3,"ngModelChange","ngModel"],[2,"margin-top","20px"],["type","submit",1,"crm-button","crm-button-success"],[1,"fas","fa-check"]],template:function(t,e){if(1&t){const i=n.RV6();n.j41(0,"ion-content",1)(1,"div",2)(2,"div",3)(3,"form",4,0),n.bIt("ngSubmit",function(){return n.eBV(i),n.Njj(e.addImapConnection())}),n.j41(5,"div",5)(6,"div",6)(7,"div",7),n.nrm(8,"i",8),n.k0s(),n.j41(9,"div",9),n.EFF(10,"Integraci\xf3n del buz\xf3n"),n.k0s()()(),n.nrm(11,"br"),n.j41(12,"div",10)(13,"div",11),n.EFF(14,"E-mail"),n.k0s(),n.j41(15,"div",12)(16,"input",13),n.mxI("ngModelChange",function(r){return n.eBV(i),n.DH7(e.imapConnection.email,r)||(e.imapConnection.email=r),n.Njj(r)}),n.k0s()()(),n.nrm(17,"br"),n.j41(18,"div",10)(19,"div",11),n.EFF(20,"Direcci\xf3n del servidor IMAP"),n.k0s(),n.j41(21,"div",12)(22,"input",14),n.mxI("ngModelChange",function(r){return n.eBV(i),n.DH7(e.imapConnection.host,r)||(e.imapConnection.host=r),n.Njj(r)}),n.k0s()()(),n.nrm(23,"br"),n.j41(24,"div",10)(25,"div",11),n.EFF(26,"Puerto"),n.k0s(),n.j41(27,"div",12)(28,"input",15),n.mxI("ngModelChange",function(r){return n.eBV(i),n.DH7(e.imapConnection.port,r)||(e.imapConnection.port=r),n.Njj(r)}),n.k0s()()(),n.nrm(29,"br"),n.j41(30,"div",16)(31,"div",17)(32,"div",18)(33,"ion-checkbox",19),n.mxI("ngModelChange",function(r){return n.eBV(i),n.DH7(e.imapConnection.tls,r)||(e.imapConnection.tls=r),n.Njj(r)}),n.k0s(),n.j41(34,"div",20),n.EFF(35,"Usar SSL"),n.k0s()()()(),n.nrm(36,"br"),n.j41(37,"div",10)(38,"div",11),n.EFF(39,"Contrase\xf1a"),n.k0s(),n.j41(40,"div",12)(41,"input",21),n.mxI("ngModelChange",function(r){return n.eBV(i),n.DH7(e.imapConnection.password,r)||(e.imapConnection.password=r),n.Njj(r)}),n.k0s()()(),n.nrm(42,"br"),n.j41(43,"div",22)(44,"button",23),n.nrm(45,"i",24),n.EFF(46," Guardar configuraci\xf3n "),n.k0s()()()()()()}if(2&t){const i=n.sdS(4);n.Y8G("fullscreen",!0)("scrollY",!1),n.R7$(12),n.Y8G("ngClass",n.eq3(11,f,i.submitted&&!e.imapConnection.email)),n.R7$(4),n.R50("ngModel",e.imapConnection.email),n.R7$(2),n.Y8G("ngClass",n.eq3(13,f,i.submitted&&!e.imapConnection.host)),n.R7$(4),n.R50("ngModel",e.imapConnection.host),n.R7$(2),n.Y8G("ngClass",n.eq3(15,f,i.submitted&&!e.imapConnection.port)),n.R7$(4),n.R50("ngModel",e.imapConnection.port),n.R7$(5),n.R50("ngModel",e.imapConnection.tls),n.R7$(4),n.Y8G("ngClass",n.eq3(17,f,i.submitted&&!e.imapConnection.password)),n.R7$(4),n.R50("ngModel",e.imapConnection.password)}},dependencies:[h.YU,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.vS,s.cV,p.eY,p.W9,p.hB]}),d})()}];let L=(()=>{var a;class d{}return(a=d).\u0275fac=function(t){return new(t||a)},a.\u0275mod=n.$C({type:a}),a.\u0275inj=n.G2t({imports:[v.iI.forChild(y),v.iI]}),d})();var R=o(3274);let B=(()=>{var a;class d{}return(a=d).\u0275fac=function(t){return new(t||a)},a.\u0275mod=n.$C({type:a}),a.\u0275inj=n.G2t({imports:[h.MD,s.YN,p.bv,L,g.b,u.P,R.K]}),d})()}}]);