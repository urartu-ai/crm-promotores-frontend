"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2320],{9491:(b,v,l)=>{l.d(v,{j:()=>u});var p=l(177),_=l(9465),r=l(9417),g=l(3953);let u=(()=>{var d;class f{}return(d=f).\u0275fac=function(t){return new(t||d)},d.\u0275mod=g.$C({type:d}),d.\u0275inj=g.G2t({imports:[p.MD,_.bv,r.YN,r.X1]}),f})()},2320:(b,v,l)=>{l.r(v),l.d(v,{ContactsListPageModule:()=>$t});var p=l(177),_=l(9417),r=l(9465),g=l(5188),u=l(467),d=l(9969),f=l(1413),k=l(152),t=l(3953),T=l(4501),R=l(9333),j=l(5952),x=l(8397),I=l(6039),$=l(5970),C=l(8147),E=l(8392),S=l(5484);const y=o=>({"crm-item-tag-active":o});function G(o,a){if(1&o){const i=t.RV6();t.j41(0,"div",20)(1,"ion-checkbox",21),t.bIt("ionChange",function(e){const c=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.onCheckboxChange(c,e,"contactType"))}),t.k0s(),t.j41(2,"div",22),t.EFF(3),t.k0s()()}if(2&o){const i=a.$implicit,n=t.XpG();t.R7$(),t.Y8G("value",i.value)("checked",n.filterData.contactType.includes(i.value)),t.R7$(2),t.SpI(" ",i.name," ")}}function M(o,a){if(1&o&&(t.j41(0,"ion-select-option",23),t.EFF(1),t.k0s()),2&o){const i=a.$implicit;t.Y8G("value",i.value),t.R7$(),t.JRh(i.label)}}function D(o,a){if(1&o){const i=t.RV6();t.j41(0,"div",20)(1,"ion-checkbox",21),t.bIt("ionChange",function(e){const c=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.onCheckboxChange(c,e,"gender"))}),t.k0s(),t.j41(2,"div",22),t.EFF(3),t.k0s()()}if(2&o){const i=a.$implicit,n=t.XpG();t.R7$(),t.Y8G("value",i.value)("checked",n.filterData.gender.includes(i.value)),t.R7$(2),t.SpI(" ",i.name," ")}}function P(o,a){if(1&o){const i=t.RV6();t.j41(0,"div",24),t.bIt("click",function(){const e=t.eBV(i).$implicit,c=t.XpG();return t.Njj(c.onToggleTag(e))}),t.EFF(1),t.k0s()}if(2&o){const i=a.$implicit;t.Y8G("ngClass",t.eq3(2,y,i.active)),t.R7$(),t.SpI(" ",null==i?null:i.text," ")}}let U=(()=>{var o;class a{constructor(n){this.tagsEditorService=n,this.onFilter=new t.bkB,this.allTags=[],this.selectedOrigin="",this.contactTypes=[{name:"Cliente potencial",value:"potential_client"},{name:"Cliente",value:"client"}],this.origins=E.R.origin,this.nationalities=[{name:"Espa\xf1a",value:"spain"},{name:"Francia",value:"france"},{name:"Alemania",value:"germany"}],this.genders=[{name:"Hombre",value:"male"},{name:"Mujer",value:"female"},{name:"Otro",value:"other"}],this.filterData={name:"",contactType:[],origin:[],dniPassport:"",nationality:[],birthdateFrom:"",birthdateTo:"",gender:[],alias:"",address:"",phoneNumber:"",emailAddress:"",urlFacebook:"",urlInstagram:"",urlLinkedIn:"",associatedUser:"",createdAtFrom:"",createdAtTo:"",tags:[]},this.baseFilters=null,this.baseFilters=JSON.parse(JSON.stringify(this.filterData))}ngOnInit(){this.selectedOrigin="",this.filterData.origin.push(this.selectedOrigin),this.filterData={name:"",contactType:[],origin:[],dniPassport:"",nationality:[],birthdateFrom:"",birthdateTo:"",gender:[],alias:"",address:"",phoneNumber:"",emailAddress:"",urlFacebook:"",urlInstagram:"",urlLinkedIn:"",associatedUser:"",createdAtFrom:"",createdAtTo:""},this.savedFilters&&(this.filterData=this.savedFilters),this.getTags()}setOriginFilter(n){this.filterData.origin=n.detail.value}getTags(){var n=this;return(0,u.A)(function*(){n.allTags=yield n.tagsEditorService.getAllTags(),n.setActiveTags()})()}onClickFilter(){let n=!1;Object.keys(this.filterData).forEach(e=>{JSON.stringify(this.filterData[e])!==JSON.stringify(this.baseFilters[e])&&(n=!0)}),this.onFilter.emit(n?this.filterData:null)}onResetFilters(){this.selectedOrigin="",this.filterData.origin.push(this.selectedOrigin),this.filterData={name:"",contactType:[],origin:[],dniPassport:"",nationality:[],birthdateFrom:"",birthdateTo:"",gender:[],alias:"",address:"",phoneNumber:"",emailAddress:"",urlFacebook:"",urlInstagram:"",urlLinkedIn:"",associatedUser:"",createdAtFrom:"",createdAtTo:""},this.onFilter.emit(null)}onCheckboxChange(n,e,c){if(e.detail.checked)this.filterData[c].push(n.value);else{const s=this.filterData[c].indexOf(n.value);s>-1&&this.filterData[c].splice(s,1)}}onToggleTag(n){this.allTags=this.tagsEditorService.toggleTag(n,this.allTags),this.filterData.tags=[],this.allTags.forEach(e=>{null!=e&&e.active&&this.filterData.tags.push(e)})}setActiveTags(){this.allTags.forEach(n=>{n.active=!1}),this.filterData.tags.forEach(n=>{const e=this.allTags.findIndex(c=>c.id===n.id);e>-1&&(this.allTags[e].active=!0)})}}return(o=a).\u0275fac=function(n){return new(n||o)(t.rXU(S.H))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-filters-block"]],inputs:{savedFilters:"savedFilters"},outputs:{onFilter:"onFilter"},decls:47,vars:6,consts:[[2,"position","relative"],[1,"crm-header-modal","crm-header-modal-fixed-top"],[1,"crm-modal-header-title"],[1,"crm-buttons-group"],[1,"crm-button",3,"click"],[1,"crm-button-secondary","crm-button-secondary-red",3,"click"],[1,"crm-block-inputs","crm-block-filters-inputs"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-checkboxes"],["class","crm-input-checkbox",4,"ngFor","ngForOf"],["toggleIcon","chevron-down-outline","justify","end","interface","popover","multiple","true",1,"crm-select-item",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"crm-section-inputs-double-input"],[1,"crm-input-input"],["type","date","placeholder","Desde","name","createdAtFrom",3,"ngModelChange","ngModel"],["type","date","placeholder","Hasta","name","createdAtTo",3,"ngModelChange","ngModel"],[1,"crm-section-small-title"],[1,"crm-section-tags"],[1,"crm-item-tag",3,"ngClass"],[1,"crm-input-checkbox"],[3,"ionChange","value","checked"],[1,"crm-input-checkbox-label"],[3,"value"],[1,"crm-item-tag",3,"click","ngClass"]],template:function(n,e){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Filtrar"),t.k0s(),t.j41(4,"div",3)(5,"button",4),t.bIt("click",function(){return e.onClickFilter()}),t.EFF(6,"Filtrar"),t.k0s(),t.j41(7,"button",5),t.bIt("click",function(){return e.onResetFilters()}),t.EFF(8," Reiniciar "),t.k0s()()(),t.j41(9,"div",6)(10,"div",7)(11,"div",8),t.EFF(12,"Tipo de contacto"),t.k0s(),t.j41(13,"div",9),t.DNE(14,G,4,3,"div",10),t.k0s()(),t.j41(15,"div",7)(16,"div",8),t.EFF(17,"Origen"),t.k0s(),t.j41(18,"ion-list")(19,"ion-item")(20,"ion-select",11),t.mxI("ngModelChange",function(s){return t.DH7(e.selectedOrigin,s)||(e.selectedOrigin=s),s}),t.bIt("ionChange",function(s){return e.setOriginFilter(s)}),t.DNE(21,M,2,2,"ion-select-option",12),t.k0s()()()(),t.j41(22,"div",13)(23,"div",7)(24,"div",8),t.EFF(25,"Creado desde"),t.k0s(),t.j41(26,"div",14)(27,"input",15),t.mxI("ngModelChange",function(s){return t.DH7(e.filterData.createdAtFrom,s)||(e.filterData.createdAtFrom=s),s}),t.k0s()()(),t.j41(28,"div",7)(29,"div",8),t.EFF(30,"Creado hasta"),t.k0s(),t.j41(31,"div",14)(32,"input",16),t.mxI("ngModelChange",function(s){return t.DH7(e.filterData.createdAtTo,s)||(e.filterData.createdAtTo=s),s}),t.k0s()()()(),t.j41(33,"div",7)(34,"div",8),t.EFF(35,"G\xe9nero"),t.k0s(),t.j41(36,"div",9),t.DNE(37,D,4,3,"div",10),t.k0s()(),t.j41(38,"div",17),t.EFF(39,"Filtrar por etiquetas"),t.k0s(),t.j41(40,"div",18),t.Z7z(41,P,2,4,"div",19,t.fX1),t.k0s(),t.nrm(43,"br")(44,"br")(45,"br")(46,"br"),t.k0s()()),2&n&&(t.R7$(14),t.Y8G("ngForOf",e.contactTypes),t.R7$(6),t.R50("ngModel",e.selectedOrigin),t.R7$(),t.Y8G("ngForOf",e.origins),t.R7$(6),t.R50("ngModel",e.filterData.createdAtFrom),t.R7$(5),t.R50("ngModel",e.filterData.createdAtTo),t.R7$(5),t.Y8G("ngForOf",e.genders),t.R7$(4),t.Dyx(e.allTags))},dependencies:[p.YU,p.Sq,r.eY,r.uz,r.nf,r.Nm,r.Ip,r.hB,r.Je,_.me,_.BC,_.vS],styles:[".crm-select-item[_ngcontent-%COMP%]{font-size:var(--crm-input-input-font-size)}.crm-select-item[_ngcontent-%COMP%]   ion-select-option[_ngcontent-%COMP%]{font-size:var(--crm-input-input-font-size)}"]}),a})();var Y=l(4420),N=l(6552);const B=o=>({"crm-card-user-active":o});function L(o,a){1&o&&(t.j41(0,"div",0)(1,"div",2)(2,"div",3),t.nrm(3,"ion-skeleton-text",4),t.k0s()(),t.j41(4,"div",5)(5,"div",6),t.nrm(6,"ion-skeleton-text",7),t.k0s(),t.j41(7,"div",8),t.nrm(8,"ion-skeleton-text",9),t.k0s()(),t.j41(9,"div",10)(10,"div",11)(11,"div",12)(12,"div",13),t.nrm(13,"ion-skeleton-text",14),t.j41(14,"span",15),t.nrm(15,"ion-skeleton-text",16),t.k0s()(),t.j41(16,"div",17),t.nrm(17,"ion-skeleton-text",18),t.k0s(),t.j41(18,"div",19),t.nrm(19,"ion-skeleton-text",18),t.k0s()(),t.j41(20,"div",20)(21,"div",21)(22,"div",22),t.nrm(23,"ion-skeleton-text",9),t.k0s(),t.j41(24,"div",23),t.nrm(25,"ion-skeleton-text",24),t.k0s()(),t.j41(26,"div",21)(27,"div",22),t.nrm(28,"ion-skeleton-text",9),t.k0s(),t.j41(29,"div",23),t.nrm(30,"ion-skeleton-text",24),t.k0s()(),t.j41(31,"div",25)(32,"div",22),t.nrm(33,"ion-skeleton-text",9),t.k0s(),t.j41(34,"div",23),t.nrm(35,"ion-skeleton-text",14),t.k0s()(),t.j41(36,"div",21)(37,"div",22),t.nrm(38,"ion-skeleton-text",9),t.k0s(),t.j41(39,"div",23),t.nrm(40,"ion-skeleton-text",18),t.k0s()(),t.j41(41,"div",26)(42,"div",22),t.nrm(43,"ion-skeleton-text",9),t.k0s(),t.j41(44,"div",27),t.nrm(45,"i",28)(46,"ion-skeleton-text",18),t.k0s()(),t.j41(47,"div",25)(48,"div",22),t.nrm(49,"ion-skeleton-text",9),t.k0s(),t.j41(50,"div",23),t.nrm(51,"ion-skeleton-text",14),t.k0s()()()(),t.j41(52,"div",29)(53,"div",30),t.nrm(54,"ion-skeleton-text",18)(55,"ion-skeleton-text",9),t.k0s()()()()),2&o&&(t.R7$(3),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(5),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(4),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(),t.Y8G("animated",!0))}function X(o,a){if(1&o&&(t.j41(0,"span",15),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.SpI(" (",null==i.contact?null:i.contact.alias,") ")}}function A(o,a){if(1&o&&(t.j41(0,"div",45)(1,"div",46)(2,"div",47),t.nrm(3,"span",48),t.k0s()()()),2&o){let i,n;const e=t.XpG().$implicit,c=t.XpG(3);t.R7$(3),t.HbH(null==(i=c.utils.getLanguageInfo(e))?null:i.flagClass),t.Y8G("title",null==(n=c.utils.getLanguageInfo(e))?null:n.name)}}function O(o,a){1&o&&t.DNE(0,A,4,3,"div",45),2&o&&t.vxM(a.$index<4?0:-1)}function V(o,a){if(1&o&&(t.j41(0,"div",36),t.EFF(1),t.k0s()),2&o){const i=t.XpG(3);t.R7$(),t.SpI(" +",(null==i.contact?null:i.contact.languages.length)-4," ")}}function w(o,a){if(1&o&&(t.j41(0,"div",44),t.Z7z(1,O,1,1,null,null,t.fX1),t.k0s(),t.DNE(3,V,2,1,"div",36)),2&o){const i=t.XpG(2);t.R7$(),t.Dyx(null==i.contact?null:i.contact.languages),t.R7$(2),t.vxM((null==i.contact?null:i.contact.languages.length)>4?3:-1)}}function J(o,a){1&o&&t.nrm(0,"div",36)}function z(o,a){1&o&&(t.j41(0,"span"),t.EFF(1,"s"),t.k0s())}function H(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.JRh(null==i.contact||null==i.contact.phones?null:i.contact.phones[0])}}function Z(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.JRh(null==i.contact||null==i.contact.phones?null:i.contact.phones[1])}}function W(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.SpI("+",(null==i.contact||null==i.contact.phones?null:i.contact.phones.length)-2,"")}}function K(o,a){1&o&&(t.j41(0,"span"),t.EFF(1,"s"),t.k0s())}function Q(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.JRh(null==i.contact||null==i.contact.emails?null:i.contact.emails[0])}}function q(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.JRh(null==i.contact||null==i.contact.emails?null:i.contact.emails[1])}}function tt(o,a){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.SpI("+",(null==i.contact||null==i.contact.emails?null:i.contact.emails.length)-2,"")}}function nt(o,a){if(1&o&&(t.j41(0,"div",23)(1,"div",49)(2,"div",50),t.EFF(3),t.k0s()()()),2&o){const i=a.$implicit;t.R7$(3),t.SpI(" ",null==i||null==i.contact?null:i.contact.name," ")}}function et(o,a){if(1&o&&(t.j41(0,"div",23)(1,"div",49)(2,"div",50),t.EFF(3),t.k0s()()()),2&o){const i=a.$implicit;t.R7$(3),t.SpI(" ",null==i||null==i.contactRelated?null:i.contactRelated.name," ")}}function ot(o,a){if(1&o&&(t.j41(0,"div",25)(1,"div",22),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.Z7z(4,nt,4,1,"div",23,t.fX1),t.Z7z(6,et,4,1,"div",23,t.fX1),t.k0s()),2&o){const i=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,1,"contacts.card.related_with")),t.R7$(2),t.Dyx(i.contact.contactsRelated),t.R7$(2),t.Dyx(i.contact.contactsRelation)}}function it(o,a){if(1&o&&(t.j41(0,"div",38),t.EFF(1),t.k0s()),2&o){const i=a.$implicit;t.R7$(),t.SpI(" ",null==i?null:i.text," ")}}function at(o,a){if(1&o&&(t.j41(0,"div",41)(1,"div",51),t.nrm(2,"img",33),t.k0s(),t.j41(3,"div",52)(4,"div",53),t.EFF(5),t.k0s(),t.j41(6,"div",54),t.EFF(7),t.nI1(8,"translate"),t.k0s()()()),2&o){const i=t.XpG(2);t.R7$(2),t.Y8G("src",(null==i.contact||null==i.contact.responsableUsers||null==i.contact.responsableUsers[0]?null:i.contact.responsableUsers[0].photoUrl)||"assets/images/avatar.png",t.B4B)("alt",null==i.contact||null==i.contact.responsableUsers||null==i.contact.responsableUsers[0]?null:i.contact.responsableUsers[0].photoUrl),t.R7$(3),t.SpI(" ",null==i.contact||null==i.contact.responsableUsers||null==i.contact.responsableUsers[0]?null:i.contact.responsableUsers[0].name," "),t.R7$(2),t.SpI(" ",t.bMT(8,4,"contacts.card.responsible")," ")}}function ct(o,a){if(1&o){const i=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"ion-checkbox",31),t.mxI("ngModelChange",function(e){t.eBV(i);const c=t.XpG();return t.DH7(c.contact.checked,e)||(c.contact.checked=e),t.Njj(e)}),t.bIt("ngModelChange",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onToggleContactCheckbox())}),t.k0s()()(),t.j41(4,"div",32),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onNavigateToContact())}),t.j41(5,"div",6),t.nrm(6,"img",33),t.k0s(),t.j41(7,"div",8),t.EFF(8),t.k0s()(),t.j41(9,"div",10)(10,"div",11)(11,"div",12)(12,"div",34),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onNavigateToContact())}),t.EFF(13),t.DNE(14,X,2,1,"span",35),t.k0s(),t.j41(15,"div",17),t.EFF(16),t.k0s(),t.j41(17,"div",19),t.DNE(18,w,4,1)(19,J,1,0,"div",36),t.k0s()(),t.j41(20,"div",20)(21,"div",21)(22,"div",22),t.EFF(23),t.nI1(24,"translate"),t.k0s(),t.j41(25,"div",23)(26,"div"),t.EFF(27),t.k0s()()(),t.j41(28,"div",25)(29,"div",22),t.EFF(30),t.nI1(31,"translate"),t.DNE(32,z,2,0,"span",37),t.k0s(),t.j41(33,"div",23),t.DNE(34,H,2,1,"div",37)(35,Z,2,1,"div",37)(36,W,2,1,"div",37),t.k0s()(),t.j41(37,"div",25)(38,"div",22),t.EFF(39),t.nI1(40,"translate"),t.DNE(41,K,2,0,"span",37),t.k0s(),t.j41(42,"div",23),t.DNE(43,Q,2,1,"div",37)(44,q,2,1,"div",37)(45,tt,2,1,"div",37),t.k0s()(),t.j41(46,"div",21)(47,"div",22),t.EFF(48),t.nI1(49,"translate"),t.k0s(),t.j41(50,"div",23)(51,"div"),t.EFF(52),t.nI1(53,"translate"),t.k0s()()(),t.j41(54,"div",26)(55,"div",22),t.EFF(56),t.nI1(57,"translate"),t.k0s(),t.j41(58,"div",27),t.nrm(59,"i",28),t.EFF(60),t.k0s()(),t.DNE(61,ot,8,3,"div",25),t.k0s()(),t.j41(62,"div",29)(63,"div",30),t.Z7z(64,it,2,1,"div",38,t.fX1),t.j41(66,"div",39),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onEditTags())}),t.nrm(67,"i",40),t.EFF(68),t.nI1(69,"translate"),t.k0s()()()(),t.DNE(70,at,9,6,"div",41),t.j41(71,"div",42)(72,"div",43)(73,"div",22),t.EFF(74),t.nI1(75,"translate"),t.nI1(76,"date"),t.k0s()()()()}if(2&o){let i;const n=t.XpG();t.Y8G("ngClass",t.eq3(50,B,null==n.contact?null:n.contact.checked)),t.R7$(3),t.R50("ngModel",n.contact.checked),t.R7$(3),t.Y8G("src",(null==n.contact?null:n.contact.photoUrl)||"assets/images/avatar.png",t.B4B)("alt",null==n.contact?null:n.contact.photoUrl),t.R7$(2),t.SpI(" #",(null==n.contact?null:n.contact.byvaroId)||""," "),t.R7$(5),t.SpI(" ",null==n.contact?null:n.contact.name," "),t.R7$(),t.Y8G("ngIf",null==n.contact?null:n.contact.alias),t.R7$(2),t.SpI(" ",null==n.contact?null:n.contact.contactType," "),t.R7$(2),t.vxM(null!=n.contact&&n.contact.languages&&(null==n.contact?null:n.contact.languages.length)>0?18:19),t.R7$(5),t.JRh(t.bMT(24,31,"contacts.card.nationality")),t.R7$(4),t.JRh(null==(i=n.utils.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:i.name),t.R7$(3),t.SpI(" ",t.bMT(31,33,"contacts.card.phone"),""),t.R7$(2),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>1),t.R7$(2),t.Y8G("ngIf",null==n.contact||null==n.contact.phones?null:n.contact.phones[0]),t.R7$(),t.Y8G("ngIf",null==n.contact||null==n.contact.phones?null:n.contact.phones[0]),t.R7$(),t.Y8G("ngIf",(null==n.contact||null==n.contact.phones?null:n.contact.phones.length)>2),t.R7$(3),t.SpI(" ",t.bMT(40,35,"contacts.card.email"),""),t.R7$(2),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>1),t.R7$(2),t.Y8G("ngIf",null==n.contact||null==n.contact.emails?null:n.contact.emails[0]),t.R7$(),t.Y8G("ngIf",null==n.contact||null==n.contact.emails?null:n.contact.emails[0]),t.R7$(),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>2),t.R7$(3),t.JRh(t.bMT(49,37,"contacts.card.origin")),t.R7$(4),t.JRh(t.bMT(53,39,"text."+(null==n.contact?null:n.contact.origin))),t.R7$(4),t.JRh(t.bMT(57,41,"contacts.card.operations")),t.R7$(4),t.Lme(" ",null==n.contact||null==n.contact.operations?null:n.contact.operations.length," / ",null==n.contact||null==n.contact.operations?null:n.contact.operations.length," "),t.R7$(),t.vxM((null==n.contact||null==n.contact.contactsRelation?null:n.contact.contactsRelation.length)>0||(null==n.contact||null==n.contact.contactsRelated?null:n.contact.contactsRelated.length)>0?61:-1),t.R7$(3),t.Dyx(n.contact.tags),t.R7$(4),t.SpI(" \xa0 ",t.bMT(69,43,"contacts.card.edit_tags")," "),t.R7$(2),t.vxM(null!=n.contact&&null!=n.contact.responsableUsers&&null!=n.contact.responsableUsers[0]&&n.contact.responsableUsers[0].name?70:-1),t.R7$(4),t.Lme("",t.bMT(75,45,"contacts.card.created_at")," ",t.i5U(76,47,null==n.contact?null:n.contact.createdAt,"dd/MM/yyyy HH:mm"),"")}}let st=(()=>{var o;class a{constructor(n,e){this.router=n,this.utils=e,this.isSkeleton=!1,this.toggleContactCheckbox=new t.bkB,this.editTags=new t.bkB,this.activeOperations=0}ngOnInit(){}onToggleContactCheckbox(){this.toggleContactCheckbox.emit()}onNavigateToContact(){this.router.navigate([`/contacts/${this.contact.id}`])}onEditTags(){this.editTags.emit(this.contact)}setActiveOportunities(){}}return(o=a).\u0275fac=function(n){return new(n||o)(t.rXU(g.Ix),t.rXU(N.T))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-card-user"]],inputs:{isSkeleton:"isSkeleton",contact:"contact"},outputs:{toggleContactCheckbox:"toggleContactCheckbox",editTags:"editTags"},decls:2,vars:1,consts:[[1,"crm-card-contact"],[1,"crm-card-contact",3,"ngClass"],[1,"crm-card-contact-checkbox"],[1,"crm-input-checkbox"],[2,"width","20px","height","20px",3,"animated"],[1,"crm-card-contact-left"],[1,"crm-card-contact-left-img"],[2,"width","50px","height","50px","border-radius","50%",3,"animated"],[1,"crm-card-contact-left-reference"],[2,"width","80px",3,"animated"],[1,"crm-card-contact-right"],[1,"crm-card-contact-right-top"],[1,"crm-card-contact-main-data"],[1,"crm-card-contact-name"],[2,"width","150px",3,"animated"],[1,"crm-card-contact-reference"],[2,"width","50px",3,"animated"],[1,"crm-card-contact-subtitle"],[2,"width","100px",3,"animated"],[1,"crm-card-contact-flags"],[1,"crm-block-info-horizontal"],[1,"crm-info","crm-info-size-small"],[1,"crm-info-title"],[1,"crm-info-content"],[2,"width","120px",3,"animated"],[1,"crm-info","crm-info-size-medium"],[1,"crm-info"],[1,"crm-info-content","crm-info-content-with-icon"],[1,"fas","fa-bullseye"],[1,"crm-card-contact-right-bottom"],[1,"crm-section-tags"],[3,"ngModelChange","ngModel"],[1,"crm-card-contact-left",3,"click"],[3,"src","alt"],[1,"crm-card-contact-name",3,"click"],["class","crm-card-contact-reference",4,"ngIf"],[1,"crm-info-content-langs-plus"],[4,"ngIf"],[1,"crm-item-tag"],[1,"crm-item-tag",3,"click"],[1,"fas","fa-edit"],[1,"crm-card-user-header","small","crm-card-contact-floating-user"],[1,"crm-card-contact-floating-creation-date"],[1,"crm-info","crm-info-size-large"],[1,"crm-info-content-langs-langs"],[1,"crm-item-option","crm-item-option-lang"],[1,"crm-item-option-left"],[1,"crm-item-option-flag"],[3,"title"],[1,"crm-item-reference"],[1,"crm-item-reference-text"],[1,"crm-card-user-header-photo"],[1,"crm-card-user-header-data"],[1,"crm-card-user-header-data-name"],[1,"crm-card-user-header-data-subtitle"]],template:function(n,e){1&n&&t.DNE(0,L,56,21,"div",0)(1,ct,77,52,"div",1),2&n&&t.vxM(e.isSkeleton?0:1)},dependencies:[p.YU,p.bT,_.BC,_.vS,r.eY,r.ds,r.hB,p.vh,C.D9]}),a})();const lt=o=>({"crm-button-secondary-primary":o}),F=o=>({count:o});function rt(o,a){if(1&o){const i=t.RV6();t.j41(0,"button",38),t.nrm(1,"i",39),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"button",40),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onEditContactTags())}),t.nrm(5,"i",41),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"button",42),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onDeleteContacts())}),t.nrm(9,"i",43),t.EFF(10),t.nI1(11,"translate"),t.k0s(),t.nrm(12,"div",44)}2&o&&(t.Y8G("@fadeSlideIn",void 0),t.R7$(2),t.SpI(" ",t.bMT(3,6,"contacts.list.export")," "),t.R7$(2),t.Y8G("@fadeSlideIn",void 0),t.R7$(2),t.SpI(" ",t.bMT(7,8,"contacts.list.edit_tags")," "),t.R7$(2),t.Y8G("@fadeSlideIn",void 0),t.R7$(2),t.SpI(" ",t.bMT(11,10,"contacts.list.delete")," "))}function dt(o,a){1&o&&(t.nrm(0,"i",45),t.EFF(1," Cerrar filtros "))}function ut(o,a){1&o&&(t.nrm(0,"i",46),t.EFF(1," Filtros activados "))}function mt(o,a){1&o&&(t.nrm(0,"i",46),t.EFF(1," Filtrar "))}function pt(o,a){if(1&o&&t.DNE(0,ut,2,0)(1,mt,2,0),2&o){const i=t.XpG();t.vxM(i.filters?0:1)}}function _t(o,a){if(1&o&&(t.j41(0,"div",30),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o){const i=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,"contacts.list.selected_label",t.eq3(4,F,i.checkedContacts))," ")}}function gt(o,a){1&o&&t.nrm(0,"app-card-user",47)(1,"app-card-user",47)(2,"app-card-user",47),2&o&&(t.Y8G("isSkeleton",!0),t.R7$(),t.Y8G("isSkeleton",!0),t.R7$(),t.Y8G("isSkeleton",!0))}function ht(o,a){if(1&o){const i=t.RV6();t.j41(0,"app-card-user",50),t.bIt("toggleContactCheckbox",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.onToggleContactCheckbox())})("editTags",function(e){t.eBV(i);const c=t.XpG(2);return t.Njj(c.onEditContactTags(e))}),t.k0s()}2&o&&t.Y8G("contact",a.$implicit)}function vt(o,a){1&o&&(t.j41(0,"div",49),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"contacts.list.empty_list")," "))}function ft(o,a){if(1&o&&(t.j41(0,"div",36),t.Z7z(1,ht,1,1,"app-card-user",48,t.fX1),t.DNE(3,vt,3,3,"div",49),t.k0s()),2&o){const i=t.XpG();t.R7$(),t.Dyx(i.contacts),t.R7$(2),t.vxM(0===i.contacts.length?3:-1)}}function Ct(o,a){if(1&o){const i=t.RV6();t.j41(0,"app-filters-block",53),t.bIt("onFilter",function(e){t.eBV(i);const c=t.XpG(2);return t.Njj(c.onFilter(e))}),t.k0s()}if(2&o){const i=t.XpG(2);t.Y8G("savedFilters",i.filters)}}function kt(o,a){if(1&o){const i=t.RV6();t.j41(0,"app-tags-editor-block",54),t.bIt("updateContacts",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.onUpdateContactsTags())})("closeAside",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.onCloseAside())})("uncheckAllContacts",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.uncheckAllContacts())}),t.k0s()}if(2&o){const i=t.XpG(2);t.Y8G("contacts",i.contacts)}}function Ft(o,a){if(1&o&&(t.j41(0,"div",37),t.DNE(1,Ct,1,1,"app-filters-block",51)(2,kt,1,1,"app-tags-editor-block",52),t.k0s()),2&o){const i=t.XpG();t.Y8G("@biggerFadeSlideIn",void 0),t.R7$(),t.vxM("filters"===(null==i.aside?null:i.aside.type)?1:-1),t.R7$(),t.vxM("tags"===(null==i.aside?null:i.aside.type)?2:-1)}}const bt=[{path:"",component:(()=>{var o;class a{constructor(n,e,c,s,m,h,Et,St){this.headerService=n,this.contactsService=e,this.modalsService=c,this.toastService=s,this.router=m,this.api=h,this.popoversService=Et,this.translate=St,this.contacts=[],this.allSystemContactsCount=0,this.checkedContacts=0,this.searchString="",this.searchSubject=new f.B,this.aside={visible:!1},this.showFilters=!1,this.filters=null,this.sort=null,this.pagination={page:0,itemsPerPage:25},this.loadingList=!1}ngOnInit(){this.searchSubject.pipe((0,k.B)(800)).subscribe(n=>{this.onSearchChanged(n)}),this.filters=localStorage.getItem("byvaroContactsFilters")?JSON.parse(localStorage.getItem("byvaroContactsFilters")):null,this.sort=localStorage.getItem("byvaroContactsSort")?JSON.parse(localStorage.getItem("byvaroContactsSort")):null}ionViewWillEnter(){this.headerService.setConfig({title:"contacts"}),this.getData()}getData(){var n=this;return(0,u.A)(function*(){try{n.loadingList=!0;const e=yield n.getContacts();if(null!=e&&e.errors)throw new Error("Error fetching contacts");n.contacts=null==e?void 0:e.data,n.allSystemContactsCount=null==e?void 0:e.metadata,n.setNumberOfCheckedContacts(),n.updatePagination(),n.loadingList=!1}catch{n.toastService.showToast({text:n.translate.instant("contacts.list.error_fetching_contacts"),theme:"red",time:1e4}),n.loadingList=!1}})()}getContacts(){var n=this;return(0,u.A)(function*(){const e=n.contactsService.transformFilterDataToFilterI(n.filters,n.searchString);console.log("transformedFilters:",e);const c=n.filters?n.contactsService.createJoinTablesForTags(n.filters):null;return n.contactsService.getContacts(e,n.sort,n.pagination,c)})()}deleteContact(n){var e=this;return(0,u.A)(function*(){yield e.contactsService.deleteContact(n)})()}onSearchInputChange(n){this.searchSubject.next(n.target.value)}onSearchChanged(n){this.searchString=n,this.getData()}onToggleContactCheckbox(){this.setNumberOfCheckedContacts()}onToggleAllCheckboxes(n){this.contacts.forEach(e=>e.checked=n.detail.checked),this.setNumberOfCheckedContacts()}onClickMoreTools(n){var e=this;return(0,u.A)(function*(){const c=yield e.popoversService.onShowMenuPopover(n,"contacts-list-more-tools");console.log("Popover result:",c),"import-users"===(null==c?void 0:c.data)&&e.openImportContactsModal()})()}openImportContactsModal(){var n=this;return(0,u.A)(function*(){yield n.modalsService.onShowImportContactsModal(),n.getData()})()}onSort(n){var e=this;return(0,u.A)(function*(){const c=yield e.popoversService.onShowMenuPopover(n,"list-order");if(console.log("Popover result:",c),null!=c&&c.data){const s=c.data;if(s.includes("_")){const m=s.split("_")[0],h=s.split("_")[1];e.sort={field:m,order:h}}else e.sort={field:s,order:"asc"};localStorage.setItem("byvaroContactsSort",JSON.stringify(e.sort)),e.getData()}})()}onShowMenuSelectAll(n){var e=this;return(0,u.A)(function*(){const c=yield e.popoversService.onShowMenuPopover(n,"select-all");null!=c&&c.data&&"selectAll"===c.data&&(e.checkedContacts=e.allSystemContactsCount,e.contacts.forEach(m=>m.checked=!0))})()}updatePagination(){return{startIndex:this.pagination.page*this.pagination.itemsPerPage+1,endIndex:Math.min((this.pagination.page+1)*this.pagination.itemsPerPage,this.allSystemContactsCount)}}onGoNextPage(){(this.pagination.page+1)*this.pagination.itemsPerPage<this.allSystemContactsCount&&(this.pagination.page++,this.getData())}onGoPreviousPage(){this.pagination.page>0&&(this.pagination.page--,this.getData())}onDeleteContacts(){var n=this;return(0,u.A)(function*(){const e=yield n.modalsService.openConfirmationModal({title:n.translate.instant("contacts.list.delete_contacts_title"),message:n.translate.instant("contacts.list.delete_contacts_message"),icon:"fas fa-trash",iconTheme:"red",buttons:[{text:n.translate.instant("contacts.list.delete_contacts_cancel"),theme:"btn-secondary",id:"cancel"},{text:n.translate.instant("contacts.list.delete_contacts_confirm"),theme:"btn-red",id:"delete"}]});if("delete"===(null==e?void 0:e.data)){const c=yield n.toastService.showToast({text:n.translate.instant("contacts.list.deleting_contacts"),loading:!0});yield c.present(),n.contacts.filter(m=>m.checked).forEach(function(){var m=(0,u.A)(function*(h){return yield n.deleteContact(h.id)});return function(h){return m.apply(this,arguments)}}()),yield c.dismiss(),n.toastService.showToast({text:n.translate.instant("contacts.list.contacts_deleted_success"),theme:"success",time:3e3}),n.getData()}})()}onFilter(n){localStorage.setItem("byvaroContactsFilters",JSON.stringify(n)),this.filters=n,this.getData()}onToggleAside(n){this.aside.visible&&this.aside.type===n&&"filters"===n?this.aside.visible=!1:(this.aside.visible=!0,this.aside.type=n)}onCloseAside(){this.aside.visible=!1,this.aside.type=void 0}onEditContactTags(n){var e=this;return(0,u.A)(function*(){var c;n&&e.checkContact(n),e.setNumberOfCheckedContacts();const s=yield e.modalsService.onShowTagsEditorModal(e.contacts.filter(m=>m.checked));console.log("Popover result:",s),null!=s&&null!==(c=s.data)&&void 0!==c&&c.reload&&e.getData()})()}onUpdateContactsTags(){this.getData(),this.toastService.showToast({text:this.translate.instant("contacts.list.tags_updated_success"),theme:"success",time:3e3})}uncheckAllContacts(){this.contacts.forEach(n=>n.checked=!1),this.setNumberOfCheckedContacts()}checkContact(n){this.contacts.forEach(e=>{e.checked=e.id===n.id})}setNumberOfCheckedContacts(){this.checkedContacts=this.contacts.filter(n=>n.checked).length}}return(o=a).\u0275fac=function(n){return new(n||o)(t.rXU(T.d),t.rXU(R.F),t.rXU(j.M),t.rXU(x.f),t.rXU(g.Ix),t.rXU(I.i),t.rXU($.m),t.rXU(C.c$))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-contacts-list"]],decls:54,vars:31,consts:[[3,"fullscreen","scrollY"],[1,"crm-block-content"],[1,"crm-block-body"],[1,"crm-block-body-fixed"],[1,"crm-header-modal"],[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar"],[1,"fas","fa-search"],["type","text",3,"input","placeholder"],[1,"crm-buttons-group"],[1,"crm-button",3,"routerLink"],[1,"fa","fa-plus"],[1,"crm-button-secondary",3,"click","ngClass"],[1,"crm-button-secondary","crm-button-secondary-icon-solo",3,"click"],[1,"fa","fa-ellipsis"],[1,"crm-block-pagination-selectors"],[1,"crm-button-pagination"],[1,"crm-button-pagination-text"],[1,"crm-button-pagination-buttons"],[1,"crm-button-pagination-arrow","crm-button-icon-solo",3,"click"],[1,"fas","fa-arrow-left"],[1,"crm-button-pagination-number"],[1,"fas","fa-arrow-right"],[1,"crm-dropdown",3,"click"],[1,"crm-dropdown-text"],[1,"crm-dropdown-right"],[1,"crm-dropdown-value"],[1,"crm-dropdown-arrow"],[1,"fas","fa-chevron-down"],[1,"crm-input-checkbox"],[1,"crm-input-checkbox-pre-label"],[3,"ionChange"],[1,"crm-input-checkbox-label"],[1,"crm-button-pagination-arrow","crm-button-icon-solo",2,"margin-left","4px",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],[1,"crm-block-body-blue-content",2,"overflow-x","auto"],[1,"crm-card-user-list"],[1,"crm-block-content-aside"],[1,"crm-button-secondary"],[1,"fa-solid","fa-file-export"],[1,"crm-button-secondary",3,"click"],[1,"fa-solid","fa-tag"],[1,"crm-button-secondary","crm-button-secondary-red",3,"click"],[1,"fas","fa-trash"],[1,"crm-vertical-separator"],[1,"fa","fa-times"],[1,"fa","fa-filter"],[3,"isSkeleton"],[3,"contact"],[1,"crm-empty-list","crm-text"],[3,"toggleContactCheckbox","editTags","contact"],[3,"savedFilters"],[3,"contacts"],[3,"onFilter","savedFilters"],[3,"updateContacts","closeAside","uncheckAllContacts","contacts"]],template:function(n,e){1&n&&(t.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t.nrm(7,"i",7),t.j41(8,"input",8),t.nI1(9,"translate"),t.bIt("input",function(s){return e.onSearchInputChange(s)}),t.k0s()()(),t.j41(10,"div",9),t.DNE(11,rt,13,12),t.j41(12,"button",10),t.nrm(13,"i",11),t.EFF(14),t.nI1(15,"translate"),t.k0s(),t.j41(16,"button",12),t.bIt("click",function(){return e.onToggleAside("filters")}),t.DNE(17,dt,2,0)(18,pt,2,1),t.k0s(),t.j41(19,"button",13),t.bIt("click",function(s){return e.onClickMoreTools(s)}),t.nrm(20,"i",14),t.k0s()()(),t.j41(21,"div",15)(22,"div",16)(23,"div",17),t.EFF(24),t.k0s(),t.j41(25,"div",18)(26,"button",19),t.bIt("click",function(){return e.onGoPreviousPage()}),t.nrm(27,"i",20),t.k0s(),t.j41(28,"div",21),t.EFF(29),t.k0s(),t.j41(30,"button",19),t.bIt("click",function(){return e.onGoNextPage()}),t.nrm(31,"i",22),t.k0s()(),t.j41(32,"div",23),t.bIt("click",function(s){return e.onSort(s)}),t.j41(33,"div",24),t.EFF(34),t.nI1(35,"translate"),t.k0s(),t.j41(36,"div",25)(37,"div",26),t.EFF(38),t.k0s(),t.j41(39,"div",27),t.nrm(40,"i",28),t.k0s()()()(),t.j41(41,"div")(42,"div",29),t.DNE(43,_t,3,6,"div",30),t.j41(44,"ion-checkbox",31),t.bIt("ionChange",function(s){return e.onToggleAllCheckboxes(s)}),t.k0s(),t.j41(45,"div",32),t.EFF(46),t.nI1(47,"translate"),t.k0s(),t.j41(48,"button",33),t.bIt("click",function(s){return e.onShowMenuSelectAll(s)}),t.nrm(49,"i",34),t.k0s()()()()(),t.j41(50,"div",35),t.DNE(51,gt,3,3)(52,ft,4,1,"div",36),t.k0s()(),t.DNE(53,Ft,3,3,"div",37),t.k0s()()),2&n&&(t.Y8G("fullscreen",!0)("scrollY",!1),t.R7$(8),t.Y8G("placeholder",t.bMT(9,18,"contacts.list.search_placeholder")),t.R7$(3),t.vxM(e.checkedContacts?11:-1),t.R7$(),t.Y8G("routerLink","/contacts/create"),t.R7$(2),t.SpI(" ",t.bMT(15,20,"contacts.list.add_contact")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(27,lt,!("filters"===(null==e.aside?null:e.aside.type)&&null!=e.aside&&e.aside.visible)&&e.filters)),t.R7$(),t.vxM("filters"===(null==e.aside?null:e.aside.type)&&null!=e.aside&&e.aside.visible?17:18),t.R7$(7),t.E5c(" ",e.updatePagination().startIndex," - ",e.updatePagination().endIndex," de ",e.allSystemContactsCount," "),t.R7$(5),t.SpI(" P\xe1g ",e.pagination.page+1," "),t.R7$(5),t.SpI(" ",t.bMT(35,22,"contacts.list.order_by")," "),t.R7$(4),t.SpI(" ",null!=e.sort&&e.sort.field?(null==e.sort?null:e.sort.field)+" "+(null==e.sort?null:e.sort.order):"Fecha de creaci\xf3n"," "),t.R7$(5),t.vxM(e.checkedContacts?43:-1),t.R7$(3),t.SpI(" ",t.i5U(47,24,"contacts.list.select_all_label",t.eq3(29,F,e.contacts.length))," "),t.R7$(5),t.vxM(e.loadingList?51:52),t.R7$(2),t.vxM(null!=e.aside&&e.aside.visible?53:-1))},dependencies:[p.YU,r.eY,r.W9,r.hB,r.N7,g.Wk,U,Y.T,st,C.D9],data:{animation:[(0,d.hZ)("fadeSlideIn",[(0,d.kY)(":enter",[(0,d.iF)({opacity:0,transform:"translateX(30px)"}),(0,d.i0)("150ms ease-out",(0,d.iF)({opacity:1,transform:"translateX(0)"}))])]),(0,d.hZ)("biggerFadeSlideIn",[(0,d.kY)(":enter",[(0,d.iF)({opacity:0,transform:"translateX(150px)"}),(0,d.i0)("100ms ease-out",(0,d.iF)({opacity:1,transform:"translateX(0)"}))])])]}}),a})()}];let Tt=(()=>{var o;class a{}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.iI.forChild(bt),g.iI]}),a})();var Rt=l(9491),jt=l(3732);let xt=(()=>{var o;class a{}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[p.MD,_.YN]}),a})();var It=l(7754);let $t=(()=>{var o;class a{}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[p.MD,_.YN,r.bv,Tt,Rt.j,jt.D,xt,It.X,C.h]}),a})()}}]);