"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4259],{4259:(W,y,c)=>{c.r(y),c.d(y,{CompraVentaOperationProcessPageModule:()=>Z});var m=c(177),p=c(9417),l=c(9465),_=c(5188),t=c(3953);const P=(o,r)=>r.paymentID,C=o=>({"hide-delete-payment":o}),f=o=>({"last-payment":o}),g=(o,r)=>({"show-error-input":o,"hide-error-input":r}),v=(o,r)=>({"show-delete-payment":o,"hide-delete-payment":r});function b(o,r){if(1&o&&(t.j41(0,"div",9)(1,"p"),t.EFF(2),t.k0s()()),2&o){const a=t.XpG();t.R7$(2),t.SpI(" Precio restante ",a.isPaymentStandard?0:a.remainingPayment," \u20ac ")}}function M(o,r){if(1&o&&(t.j41(0,"div",12)(1,"div",18),t.EFF(2,"Reserva"),t.k0s(),t.j41(3,"div",18)(4,"div",19)(5,"p"),t.EFF(6),t.k0s()()(),t.j41(7,"div",18),t.EFF(8),t.k0s(),t.nrm(9,"div",18),t.j41(10,"button",20),t.nrm(11,"i",21),t.k0s()()),2&o){const a=t.XpG(2);t.R7$(6),t.JRh(a.reservationDate),t.R7$(2),t.SpI("- ",a.reservationPayment," \u20ac"),t.R7$(2),t.Y8G("ngClass",t.eq3(3,C,0!=a.reservationPayment))}}function x(o,r){1&o&&(t.j41(0,"p"),t.EFF(1,"\xdaltimo pago"),t.k0s())}function O(o,r){if(1&o){const a=t.RV6();t.j41(0,"input",28),t.mxI("ngModelChange",function(e){t.eBV(a);const i=t.XpG().$implicit;return t.DH7(i.paymentPercentage,e)||(i.paymentPercentage=e),t.Njj(e)}),t.bIt("ngModelChange",function(){t.eBV(a);const e=t.XpG().$index,i=t.XpG(2);return t.Njj(i.setAmount(e))})("focusin",function(){t.eBV(a);const e=t.XpG(3);return t.Njj(e.hideError())}),t.k0s()}if(2&o){const a=t.XpG(),n=a.$implicit,e=a.$index,i=t.XpG(2);t.Mz_("id","percentage_",e,""),t.Y8G("ngClass",t.l_i(4,g,i.showError,!i.showError)),t.R50("ngModel",n.paymentPercentage)}}function F(o,r){if(1&o&&t.EFF(0),2&o){const a=t.XpG().$implicit;t.SpI(" ",a.paymentPercentage," ")}}function k(o,r){if(1&o){const a=t.RV6();t.j41(0,"input",29),t.mxI("ngModelChange",function(e){t.eBV(a);const i=t.XpG().$implicit;return t.DH7(i.paymentAmount,e)||(i.paymentAmount=e),t.Njj(e)}),t.bIt("ngModelChange",function(){t.eBV(a);const e=t.XpG().$index,i=t.XpG(2);return t.Njj(i.setPercentage(e))})("focusin",function(){t.eBV(a);const e=t.XpG(3);return t.Njj(e.hideError())}),t.k0s()}if(2&o){const a=t.XpG(),n=a.$implicit,e=a.$index,i=t.XpG(2);t.Mz_("id","amount_",e,""),t.Y8G("ngClass",t.l_i(4,g,i.showError,!i.showError)),t.R50("ngModel",n.paymentAmount)}}function V(o,r){if(1&o&&t.EFF(0),2&o){const a=t.XpG().$implicit;t.SpI(" ",a.paymentAmount," ")}}function E(o,r){if(1&o){const a=t.RV6();t.j41(0,"ion-icon",30),t.bIt("click",function(){t.eBV(a);const e=t.XpG().$index,i=t.XpG(2);return t.Njj(i.finishEdit(e))}),t.k0s()}}function j(o,r){if(1&o){const a=t.RV6();t.j41(0,"div",12)(1,"div",22),t.EFF(2),t.DNE(3,x,2,0,"p"),t.k0s(),t.j41(4,"div",18),t.DNE(5,O,1,7,"input",23)(6,F,1,1),t.EFF(7," % "),t.k0s(),t.j41(8,"div",18),t.DNE(9,k,1,7,"input",24)(10,V,1,1),t.EFF(11," \u20ac "),t.k0s(),t.j41(12,"div",18)(13,"input",25),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.removeDateError())}),t.mxI("ngModelChange",function(e){const i=t.eBV(a).$implicit;return t.DH7(i.paymentDate,e)||(i.paymentDate=e),t.Njj(e)}),t.k0s()(),t.j41(14,"button",26),t.bIt("click",function(){const e=t.eBV(a).$index,i=t.XpG(2);return t.Njj(i.deletePayment(e))}),t.nrm(15,"i",21),t.k0s(),t.DNE(16,E,1,0,"ion-icon",27),t.k0s()}if(2&o){const a=r.$implicit,n=r.$index,e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(9,f,n==e.payments.length-1)),t.R7$(),t.SpI(" ",a.paymentID," "),t.R7$(),t.vxM(n==e.payments.length-1?3:-1),t.R7$(2),t.vxM(e.isPaymentStandard?6:5),t.R7$(4),t.vxM(e.isPaymentStandard?10:9),t.R7$(4),t.Y8G("ngClass",t.l_i(11,g,e.showDateError&&""==a.paymentDate,!e.showDateError)),t.R50("ngModel",a.paymentDate),t.R7$(),t.Y8G("ngClass",t.l_i(14,v,!e.isPaymentStandard&&n>=2,e.isPaymentStandard||n<=1)),t.R7$(2),t.Y8G("ngIf",e.isPaymentStandard&&a.isEditing)}}function S(o,r){if(1&o){const a=t.RV6();t.j41(0,"button",31),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.addMorePayments())}),t.nrm(1,"ion-icon",32),t.j41(2,"p"),t.EFF(3,"A\xf1adir m\xe1s pagos"),t.k0s()()}}function T(o,r){if(1&o&&(t.j41(0,"div",33),t.EFF(1),t.k0s()),2&o){const a=t.XpG(2);t.R7$(),t.SpI(" La suma de los pagos debe ser el precio de compra (",a.totalPromotionPrice,"\u20ac) ")}}function D(o,r){1&o&&(t.j41(0,"div",33),t.EFF(1," Las fechas de los pagos no pueden estar vac\xedas "),t.k0s())}function I(o,r){if(1&o){const a=t.RV6();t.j41(0,"div",10)(1,"div",11),t.DNE(2,M,12,5,"div",12),t.Z7z(3,j,17,17,"div",12,P),t.DNE(5,S,4,0,"button",13),t.k0s(),t.DNE(6,T,2,1,"div",14)(7,D,2,0,"div",14),t.j41(8,"div",15)(9,"button",16),t.EFF(10," Anterior "),t.k0s(),t.j41(11,"button",17),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.updateOperation())}),t.EFF(12," Siguiente "),t.k0s()()()}if(2&o){const a=t.XpG();t.R7$(2),t.vxM(0!=a.reservationPayment?2:-1),t.R7$(),t.Dyx(a.payments),t.R7$(2),t.vxM(a.isPaymentStandard?-1:5),t.R7$(),t.Y8G("ngIf",a.showError&&!a.showDateError),t.R7$(),t.Y8G("ngIf",!a.showError&&a.showDateError)}}let R=(()=>{var o;class r{constructor(){this.selectPaymentMethod=new t.bkB,this.selectedPaymentMethod="",this.isPaymentStandard=!1,this.payments=[],this.totalPromotionPrice=0,this.remainingPayment=0,this.reservationPayment=0,this.validPercentage=!1,this.validAmount=!1,this.showError=!1,this.showDateError=!1,this.reservationDate=""}formatReservationDate(){let n=this.operation.reservationDate.toString().split("T")[0],e=n.split("-")[0],i=n.split("-")[1],s=n.split("-")[2];this.reservationDate=s+"."+i+"."+e}hideError(){this.showError=!1}removeDateError(){this.showDateError=!1}updateOperation(){if(this.payments.some(n=>""==n.paymentDate))this.showDateError=!0,this.showError=!1;else if(0==this.validateValues())this.showDateError=!1,this.showError=!0;else{this.showDateError=!1,this.showError=!1;let n=[];this.operation.buyProcessPaymentMethod="standard"==this.selectedPaymentMethod?"standard":"individual";for(let e=0;e<this.payments.length;e++){const i=this.payments[e];n.push({percentage:i.paymentPercentage,price:0==e?i.paymentAmount-this.reservationPayment:i.paymentAmount,date:i.paymentDate})}this.operation.buyProcessPayments=n,this.selectPaymentMethod.emit(this.operation)}}checkValues(){let n=0;for(let i=0;i<this.payments.length;i++)n+=Math.round(100*this.payments[i].paymentAmount);n>Math.round(100*this.totalPromotionPrice)?this.showError=!0:(this.showError=!1,this.calculateRemainingPayment())}validateValues(){let n=0,e=!1;for(let s=0;s<this.payments.length;s++)n+=Math.round(100*this.payments[s].paymentAmount);return e=n==Math.round(100*this.totalPromotionPrice),e}setAmount(n){clearTimeout(this.debounceTimer),this.hideError(),this.debounceTimer=setTimeout(()=>{this.payments[n].paymentAmount=this.calculateAmount(this.payments[n].paymentPercentage),this.checkValues(),this.calculateRemainingPayment()},1750)}setPercentage(n){clearTimeout(this.debounceTimer),this.hideError(),this.debounceTimer=setTimeout(()=>{this.payments[n].paymentPercentage=this.calculatePercentage(this.payments[n].paymentAmount),this.checkValues(),this.calculateRemainingPayment()},1750)}calculateRemainingPayment(){let n=0;for(let e=0;e<this.payments.length;e++)n+=this.payments[e].paymentAmount;this.remainingPayment=this.totalPromotionPrice-n}calculateAmount(n){const e=Math.round(100*this.totalPromotionPrice);return Math.round(e*n/100)/100}calculatePercentage(n){const e=Math.round(100*this.totalPromotionPrice),s=100*Math.round(100*n)/e;return parseFloat(s.toFixed(1))}finishEdit(n){this.payments[n].isEditing=!1}editPayment(n){this.payments[n].isEditing=!0}deletePayment(n){this.hideError(),this.remainingPayment+=this.payments[n].paymentAmount,this.payments.splice(n,1);for(let e=2;e<this.payments.length;e++)this.payments[e].paymentID="Pago "+(e+1)}addMorePayments(){this.payments.push({paymentID:"Pago "+(this.payments.length+1),paymentPercentage:null,paymentAmount:null,paymentDate:"",isEditing:!1})}setPaymentMethod(){if(this.showError=!1,this.showDateError=!1,this.remainingPayment=this.totalPromotionPrice,this.payments=[],"standard"==this.selectedPaymentMethod)if(this.isPaymentStandard=!0,null==this.operation.mainProperty.promotion.certificationsCharges||null!=this.operation.mainProperty.promotion.certificationsCharges&&0==this.operation.mainProperty.promotion.certificationsCharges.length){let n=this.operation.mainProperty.promotion.buyAndSellContractPaymentQuantityPercentage,e=100-n,i={paymentID:"Pago 1",paymentPercentage:n,paymentAmount:this.calculateAmount(n),paymentDate:"",isEditing:!1},s={paymentID:"Pago 2",paymentPercentage:e,paymentAmount:this.calculateAmount(e),paymentDate:"",isEditing:!1};this.payments.push(i),this.payments.push(s)}else{let n=this.operation.mainProperty.promotion.buyAndSellContractPaymentQuantityPercentage,e={paymentID:"Pago 1",paymentPercentage:n,paymentAmount:this.calculateAmount(n),paymentDate:"",isEditing:!1};this.payments.push(e);let i=this.operation.mainProperty.promotion.certificationsCharges;for(let s=0;s<i.length;s++){const u=i[s];this.payments.push({paymentID:"Pago "+(s+2),paymentPercentage:u.percentage,paymentAmount:this.calculateAmount(u.percentage),paymentDate:"",isEditing:!1})}}else{this.isPaymentStandard=!1;let e={paymentID:"Pago 2",paymentPercentage:null,paymentAmount:null,paymentDate:"",isEditing:!1};this.payments.push({paymentID:"Pago 1",paymentPercentage:null,paymentAmount:null,paymentDate:"",isEditing:!1}),this.payments.push(e)}}ngOnInit(){this.totalPromotionPrice=this.operation.mainProperty.price,this.reservationPayment=this.operation.reservationAmount,this.remainingPayment=this.totalPromotionPrice,this.formatReservationDate()}}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-compra-venta-select-payment-method"]],inputs:{operation:"operation"},outputs:{selectPaymentMethod:"selectPaymentMethod"},decls:20,vars:4,consts:[[1,"venta-component","payment-method-component"],[1,"title"],[1,"content"],[1,"payment-method-radio-group",3,"ngModelChange","ionChange","ngModel"],[1,"crm-input-radio","payment-method-item"],["value","standard"],[1,"crm-input-radio-label"],["value","custom"],[1,"total-payment-price"],[1,"remaining-price"],[1,"payment-items-container"],[1,"price-table"],[1,"price-table-row"],[1,"crm-button-secondary","add-payments-button"],["class","crm-input-error payment-error",4,"ngIf"],[1,"payment-method-button-container"],[1,"crm-button-secondary","previous-step-button"],[1,"crm-button",3,"click"],[1,"price-table-cell"],[1,"paid-reservation-chip"],[1,"crm-button-icon-solo",3,"ngClass"],[1,"fas","fa-trash"],[1,"price-table-cell",3,"ngClass"],["placeholder","0","type","number","name","","min","0","max","100",1,"percentage-input",3,"ngClass","id","ngModel"],["placeholder","0","type","number","name","","min","0",1,"amount-input",3,"ngClass","id","ngModel"],["type","date",3,"click","ngModelChange","ngClass","ngModel"],[1,"crm-button-icon-solo",3,"click","ngClass"],["name","checkmark-outline",3,"click",4,"ngIf"],["placeholder","0","type","number","name","","min","0","max","100",1,"percentage-input",3,"ngModelChange","focusin","ngClass","id","ngModel"],["placeholder","0","type","number","name","","min","0",1,"amount-input",3,"ngModelChange","focusin","ngClass","id","ngModel"],["name","checkmark-outline",3,"click"],[1,"crm-button-secondary","add-payments-button",3,"click"],["name","add-outline"],[1,"crm-input-error","payment-error"]],template:function(n,e){1&n&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2,"Forma de pago"),t.k0s(),t.j41(3,"div",2)(4,"ion-radio-group",3),t.mxI("ngModelChange",function(s){return t.DH7(e.selectedPaymentMethod,s)||(e.selectedPaymentMethod=s),s}),t.bIt("ionChange",function(){return e.setPaymentMethod()}),t.j41(5,"div",4),t.nrm(6,"ion-radio",5),t.j41(7,"div",6),t.EFF(8,"Pago est\xe1ndar"),t.k0s()(),t.j41(9,"div",4),t.nrm(10,"ion-radio",7),t.j41(11,"div",6),t.EFF(12,"Pago personalizado"),t.k0s()()(),t.j41(13,"div",8)(14,"p"),t.EFF(15),t.k0s(),t.j41(16,"span"),t.EFF(17,"Impuestos incluidos"),t.k0s()(),t.DNE(18,b,3,1,"div",9)(19,I,13,4,"div",10),t.k0s()()),2&n&&(t.R7$(4),t.R50("ngModel",e.selectedPaymentMethod),t.R7$(11),t.SpI("Precio de compra ",e.totalPromotionPrice," \u20ac"),t.R7$(3),t.vxM(""!=e.selectedPaymentMethod?18:-1),t.R7$(),t.vxM(""!=e.selectedPaymentMethod?19:-1))},dependencies:[m.YU,m.bT,p.me,p.Q0,p.BC,p.VZ,p.zX,p.vS,l.iq,l.KO,l.f0,l.Je],styles:[".payment-method-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:-moz-fit-content;width:fit-content}.paid-reservation-chip[_ngcontent-%COMP%]{display:flex;align-items:center;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:100px;background-color:var(--crm-success-color-lighter)}.paid-reservation-chip[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 15px!important;font-size:10px;color:var(--crm-success-color);font-weight:700;font-style:normal!important}.total-payment-price[_ngcontent-%COMP%]{display:flex;align-items:center;margin:5px 0 15px}.total-payment-price[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:var(--crm-font-family);color:var(--crm-black-color);font-weight:600;font-size:13px;margin:0 7px 0 0}.total-payment-price[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0;font-family:var(--crm-font-family);color:var(--crm-text-color);font-size:10px;font-style:italic}.remaining-price[_ngcontent-%COMP%]{display:flex;align-items:center;margin:5px 0 15px}.remaining-price[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:var(--crm-font-family);color:var(--crm-black-color);font-size:13px;margin:0 7px 0 0}.remaining-price[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0;font-family:var(--crm-font-family);color:var(--crm-text-color);font-size:10px;font-style:italic}.reservation-payment[_ngcontent-%COMP%]{display:flex;align-items:center;margin:5px 0 20px}.reservation-payment[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:var(--crm-font-family);color:var(--crm-black-color);font-weight:400;font-size:13px;margin:0 7px 0 0}.reservation-payment[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0;font-family:var(--crm-font-family);color:var(--crm-text-color);font-size:10px;font-style:italic}.payment-method-item[_ngcontent-%COMP%]{margin-bottom:20px}.show-delete-payment[_ngcontent-%COMP%]{visibility:visible}.hide-delete-payment[_ngcontent-%COMP%]{visibility:hidden}.price-table[_ngcontent-%COMP%]{border-radius:12px;padding:0 16px;background:var(--crm-primary-background)}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 0;border-bottom:1px solid var(--crm-border-light-color)}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.price-table[_ngcontent-%COMP%]   .last-payment[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:normal!important}.price-table[_ngcontent-%COMP%]   .last-payment[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:7px 0 0!important;font-size:10px!important}.price-table[_ngcontent-%COMP%]   .price-table-cell[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1;font-size:14px;padding:8px;height:45px}.price-table[_ngcontent-%COMP%]   .price-table-cell[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 0 5px;font-size:12px;font-style:italic}.price-table[_ngcontent-%COMP%]   .price-table-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#fff;outline:none;border:1px solid var(--crm-border-light-color);border-radius:8px;height:35px;padding-left:8px}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-cell[_ngcontent-%COMP%]{display:flex;align-items:center}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]{cursor:pointer;display:inline-flex;gap:8px;align-items:center}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color)}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]{display:inline-flex;gap:8px;align-items:center}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:120px;background:#fff;outline:none;border:1px solid var(--crm-border-light-color);border-radius:8px;padding:4px 8px}.price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--crm-text-color);cursor:pointer}.percentage-input[_ngcontent-%COMP%]{max-width:90px}.amount-input[_ngcontent-%COMP%]{max-width:120px}.hide-input[_ngcontent-%COMP%]{visibility:hidden}.date-input[_ngcontent-%COMP%]{max-width:130px}.reservation-text[_ngcontent-%COMP%]{font-style:italic!important}.add-payments-button[_ngcontent-%COMP%]{display:flex;margin:10px auto}.payment-method-button-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;margin:15px auto 0}.previous-step-button[_ngcontent-%COMP%]{margin-right:15px}.payment-items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;margin:15px auto}.payment-error[_ngcontent-%COMP%]{margin-top:15px}.show-error-input[_ngcontent-%COMP%]{border:1px solid var(--crm-input-error-color)!important}.hide-error-input[_ngcontent-%COMP%]{border:none!important}"]}),r})();var w=c(467),h=c(6039);let G=(()=>{var o;class r{constructor(n){this.api=n,this.previousStep=new t.bkB}navigatePreviousStep(){this.previousStep.emit(!0)}finishFlow(){var n=this;return(0,w.A)(function*(){console.log(n.operation)})()}ngOnInit(){}}return(o=r).\u0275fac=function(n){return new(n||o)(t.rXU(h.i))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-compra-venta-select-finish-questionnaire"]],inputs:{operation:"operation"},outputs:{previousStep:"previousStep"},decls:14,vars:0,consts:[[1,"venta-component","end-of-questionnaire-component"],[1,"title"],[1,"content"],[1,"crm-block"],[1,"crm-text",2,"margin-top","16px"],[1,"crm-text",2,"margin-top","8px"],[1,"crm-buttons-group",2,"margin-top","24px"],[1,"crm-button-secondary",3,"click"],[1,"crm-button","crm-button-primary",3,"click"]],template:function(n,e){1&n&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2,"Fin del cuestionario"),t.k0s(),t.j41(3,"div",2)(4,"div",3)(5,"div",4),t.EFF(6," Su contrato de compraventa est\xe1 listo. "),t.k0s(),t.j41(7,"div",5),t.EFF(8," Puede cambiar sus respuestas volviendo atr\xe1s o pulsar \u201ccontinuar\u201d para proceder a la firma del contrato. "),t.k0s(),t.j41(9,"div",6)(10,"button",7),t.bIt("click",function(){return e.navigatePreviousStep()}),t.EFF(11," Anterior "),t.k0s(),t.j41(12,"button",8),t.bIt("click",function(){return e.finishFlow()}),t.EFF(13," Siguiente "),t.k0s()()()()())}}),r})(),$=(()=>{var o;class r{constructor(n,e){this.api=n,this.route=e,this.selectContractDetails=new t.bkB,this.contractType="byvaro",this.signatureType="electronica"}setContractType(){this.operation.buyProcessContractType="byvaro"==this.contractType?"byvaro":"propio"}setSignatureType(){this.operation.buyProcessSignatureType="electronica"==this.signatureType?"electronica":"papel"}setContractDetails(){this.setContractType(),this.setSignatureType(),this.selectContractDetails.emit(this.operation)}getOperationData(){const n=this.route.snapshot.paramMap.get("operationId");n?this.api.getOperation({id:{equals:n}},null,null,{contact:{apply:!0,filter:null,onlyCount:!1},createdBy:{apply:!0,filter:null,onlyCount:!1},responsible:{apply:!0,filter:null,onlyCount:!1},mainProperty:{apply:!0,filter:null,onlyCount:!1},currentPipeline:{apply:!0,filter:null,onlyCount:!1},currentPipelineStep:{apply:!0,filter:null,onlyCount:!1},promotions:{apply:!0,filter:null,onlyCount:!1},selectedProperties:{apply:!0,filter:null,onlyCount:!1},notes:{apply:!0,filter:null,onlyCount:!1},operations:{apply:!0,filter:null,onlyCount:!1},operationRegisters:{apply:!0,filter:null,onlyCount:!1}}).then(e=>{e.success&&e.success.data&&e.success.data.length&&(this.operation=e.success.data[0],console.log("Retrieved operation:",this.operation))}).catch(e=>{console.error("Error retrieving operation:",e)}):console.warn("No operationId parameter found in the URL.")}ngOnInit(){this.getOperationData()}}return(o=r).\u0275fac=function(n){return new(n||o)(t.rXU(h.i),t.rXU(_.nX))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-compra-venta-contract-details"]],outputs:{selectContractDetails:"selectContractDetails"},decls:35,vars:2,consts:[[1,"venta-component","contract-details-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"margin-bottom","16px"],[1,"crm-text"],[3,"ngModelChange","ngModel"],[1,"crm-input-radio"],["value","byvaro"],[1,"crm-input-radio-label"],["value","propio"],[2,"border","none","border-bottom","1px solid #e5e5e5","margin","24px 0"],["value","electronica"],["value","papel"],[1,"contract-details-button-container"],[1,"crm-button-secondary","previous-step-button"],[1,"crm-button",3,"click"]],template:function(n,e){1&n&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2,"Detalles del contrato y firma"),t.k0s(),t.j41(3,"div",2)(4,"div",3)(5,"div",4),t.EFF(6,"Redacci\xf3n del contrato:"),t.k0s(),t.j41(7,"ion-radio-group",5),t.mxI("ngModelChange",function(s){return t.DH7(e.contractType,s)||(e.contractType=s),s}),t.j41(8,"div",6),t.nrm(9,"ion-radio",7),t.j41(10,"div",8),t.EFF(11,"Contrato redactado en Byvaro"),t.k0s()(),t.j41(12,"div",6),t.nrm(13,"ion-radio",9),t.j41(14,"div",8),t.EFF(15,"Contrato propio"),t.k0s()()()(),t.nrm(16,"hr",10),t.j41(17,"div",3)(18,"div",4),t.EFF(19,"T\xe9rminos y condiciones de la firma:"),t.k0s(),t.j41(20,"ion-radio-group",5),t.mxI("ngModelChange",function(s){return t.DH7(e.signatureType,s)||(e.signatureType=s),s}),t.j41(21,"div",6),t.nrm(22,"ion-radio",11),t.j41(23,"div",8),t.EFF(24,"Firma electr\xf3nica"),t.k0s()(),t.j41(25,"div",6),t.nrm(26,"ion-radio",12),t.j41(27,"div",8),t.EFF(28,"Firma en papel"),t.k0s()()()(),t.nrm(29,"hr",10),t.j41(30,"div",13)(31,"button",14),t.EFF(32," Anterior "),t.k0s(),t.j41(33,"button",15),t.bIt("click",function(){return e.setContractDetails()}),t.EFF(34," Siguiente "),t.k0s()()()()),2&n&&(t.R7$(7),t.R50("ngModel",e.contractType),t.R7$(13),t.R50("ngModel",e.signatureType))},dependencies:[p.BC,p.vS,l.KO,l.f0,l.Je],styles:[".crm-text[_ngcontent-%COMP%]{font-style:normal;margin-bottom:8px}.crm-input-radio[_ngcontent-%COMP%]{margin-bottom:8px}ion-radio-group[_ngcontent-%COMP%]{display:flex;gap:16px}.mb8[_ngcontent-%COMP%]{margin-bottom:8px}.mb16[_ngcontent-%COMP%]{margin-bottom:16px}.contract-details-button-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;margin:15px auto 0}.previous-step-button[_ngcontent-%COMP%]{margin-right:15px}"]}),r})();const d=o=>({"hidden-step":o}),A=(o,r)=>({"crm-steps-container-step-current":o,"crm-steps-container-step-inactive":r});function X(o,r){1&o&&t.nrm(0,"i",19)}function N(o,r){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const a=t.XpG().index;t.R7$(),t.JRh(a+1)}}function Y(o,r){1&o&&t.nrm(0,"div",20)}function z(o,r){if(1&o&&(t.j41(0,"div",13)(1,"div",14),t.DNE(2,X,1,0,"i",15)(3,N,2,1,"span",16),t.k0s(),t.j41(4,"div",17),t.EFF(5),t.k0s(),t.DNE(6,Y,1,0,"div",18),t.k0s()),2&o){const a=r.$implicit,n=r.index,e=t.XpG();t.Y8G("ngClass",t.l_i(5,A,n==e.activeIndex,n>e.activeIndex)),t.R7$(2),t.Y8G("ngIf",n<e.activeIndex),t.R7$(),t.Y8G("ngIf",n>=e.activeIndex),t.R7$(2),t.JRh(a),t.R7$(),t.Y8G("ngIf",n<e.steps.length-1)}}function B(o,r){if(1&o){const a=t.RV6();t.j41(0,"app-compra-venta-select-payment-method",21),t.bIt("selectPaymentMethod",function(e){t.eBV(a);const i=t.XpG();return t.Njj(i.onSelectPaymentMethod(e))}),t.k0s()}if(2&o){const a=t.XpG();t.Y8G("operation",a.updatedOperation)}}function Q(o,r){if(1&o){const a=t.RV6();t.j41(0,"app-compra-venta-select-finish-questionnaire",22),t.bIt("previousStep",function(e){t.eBV(a);const i=t.XpG();return t.Njj(i.onFinishFormPreviousStep(e))}),t.k0s()}if(2&o){const a=t.XpG();t.Y8G("operation",a.updatedOperation)}}function U(o,r){if(1&o){const a=t.RV6();t.j41(0,"div",30),t.bIt("click",function(){t.eBV(a);const e=t.XpG(3);return t.Njj(e.changeStep(0))}),t.nrm(1,"i",31),t.k0s()}}function q(o,r){if(1&o&&(t.j41(0,"div",25)(1,"div",26)(2,"div",27),t.EFF(3," 1. Detalles del contrato "),t.k0s(),t.DNE(4,U,2,0,"div",28),t.k0s(),t.j41(5,"div",29),t.EFF(6),t.k0s()()),2&o){const a=t.XpG(2);t.R7$(4),t.Y8G("ngIf",0!=a.activeIndex),t.R7$(2),t.SpI(" ",a.data.buyProcessContractType," ")}}function H(o,r){if(1&o){const a=t.RV6();t.j41(0,"div",25)(1,"div",26)(2,"div",27),t.EFF(3," 3. Forma de pago "),t.k0s(),t.j41(4,"div",30),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.changeStep(2))}),t.nrm(5,"i",31),t.k0s()(),t.j41(6,"div",29),t.EFF(7),t.k0s()()}if(2&o){const a=t.XpG(2);t.R7$(7),t.SpI(" ",a.data.buyProcessPaymentMethod," ")}}function J(o,r){if(1&o&&(t.j41(0,"div",23),t.DNE(1,q,7,2,"div",24)(2,H,8,1,"div",24),t.k0s()),2&o){const a=t.XpG();t.R7$(),t.Y8G("ngIf",null!=a.data.buyProcessContractType),t.R7$(),t.Y8G("ngIf",null!=a.data.buyProcessPaymentMethod)}}const L=[{path:"",component:(()=>{var o;class r{constructor(){this.steps=["Detalles del contrato","Tipo de comprador","Forma de pago","Fin del cuestionario"],this.data={buyProcessContractType:null,buyProcessPaymentMethod:null,buyProcessPayments:null,buyProcessSignatureType:null},this.activeIndex=0}onSelectContractDetails(n){this.activeIndex=2,this.updatedOperation=n,this.data.buyProcessContractType=n.buyProcessContractType,this.data.buyProcessSignatureType=n.buyProcessSignatureType}onSelectPaymentMethod(n){this.activeIndex=3,this.updatedOperation=n,this.data.buyProcessPaymentMethod=n.buyProcessPaymentMethod,this.data.buyProcessPayments=n.buyProcessPayments}onFinishFormPreviousStep(n){n&&(this.activeIndex=2,this.data.buyProcessPaymentMethod=null,this.data.buyProcessPayments=null)}changeStep(n){this.activeIndex=n,0==n?(this.data.buyProcessContractType=null,this.data.buyProcessPaymentMethod=null,this.data.buyProcessPayments=null,this.data.buyProcessSignatureType=null):2==n&&(this.data.buyProcessPaymentMethod=null,this.data.buyProcessPayments=null)}ngOnInit(){}}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-compra-venta-operation-process"]],decls:16,vars:17,consts:[[3,"fullscreen"],[1,"crm-block-content"],[1,"crm-block-body"],[1,"crm-block-body-blue-content"],[1,"crm-steps-container"],["class","crm-steps-container-step",3,"ngClass",4,"ngFor","ngForOf"],[1,"venta-body"],[1,"venta-body-component"],[3,"ngClass"],[3,"selectContractDetails"],[3,"operation","selectPaymentMethod",4,"ngIf"],[3,"operation","previousStep",4,"ngIf"],["class","steps-cards-body",4,"ngIf"],[1,"crm-steps-container-step",3,"ngClass"],[1,"crm-steps-container-step-circle"],["class","fa fa-check",4,"ngIf"],[4,"ngIf"],[1,"crm-steps-container-step-label"],["class","crm-steps-container-step-separator",4,"ngIf"],[1,"fa","fa-check"],[1,"crm-steps-container-step-separator"],[3,"selectPaymentMethod","operation"],[3,"previousStep","operation"],[1,"steps-cards-body"],["class","steps-cards-body-card",4,"ngIf"],[1,"steps-cards-body-card"],[1,"steps-cards-body-card-header"],[1,"steps-cards-body-card-header-title"],["class","steps-cards-body-card-header-icon",3,"click",4,"ngIf"],[1,"steps-cards-body-card-text"],[1,"steps-cards-body-card-header-icon",3,"click"],[1,"fa-solid","fa-pencil"]],template:function(n,e){1&n&&(t.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.DNE(5,z,7,8,"div",5),t.k0s(),t.j41(6,"div",6)(7,"div",7)(8,"div",8)(9,"app-compra-venta-contract-details",9),t.bIt("selectContractDetails",function(s){return e.onSelectContractDetails(s)}),t.k0s()(),t.nrm(10,"div",8),t.j41(11,"div",8),t.DNE(12,B,1,1,"app-compra-venta-select-payment-method",10),t.k0s(),t.j41(13,"div",8),t.DNE(14,Q,1,1,"app-compra-venta-select-finish-questionnaire",11),t.k0s()(),t.DNE(15,J,3,2,"div",12),t.k0s()()()()()),2&n&&(t.Y8G("fullscreen",!0),t.R7$(5),t.Y8G("ngForOf",e.steps),t.R7$(3),t.Y8G("ngClass",t.eq3(9,d,0!==e.activeIndex)),t.R7$(2),t.Y8G("ngClass",t.eq3(11,d,1!==e.activeIndex)),t.R7$(),t.Y8G("ngClass",t.eq3(13,d,2!==e.activeIndex)),t.R7$(),t.Y8G("ngIf",null!=e.updatedOperation),t.R7$(),t.Y8G("ngClass",t.eq3(15,d,3!==e.activeIndex)),t.R7$(),t.Y8G("ngIf",null!=e.updatedOperation),t.R7$(),t.Y8G("ngIf",null!=e.data.buyProcessContractType))},dependencies:[m.YU,m.Sq,m.bT,l.W9,R,G,$],styles:[".back-button[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:15px;margin-left:15px;width:-moz-fit-content;width:fit-content;height:20px;margin-bottom:10px}.back-button[_ngcontent-%COMP%]:hover{cursor:pointer}.back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--crm-primary-color-500);margin-right:5px}.back-button[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-family:var(--crm-font-family);color:var(--crm-primary-color-500);font-size:13px}.crm-steps-container[_ngcontent-%COMP%], .crm-steps-container-step[_ngcontent-%COMP%]{display:flex;align-items:center}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#3a50e4;border:1px solid #3a50e4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#3a50e4}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#a8a8a8;border:1px solid rgb(168,168,168)}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#a8a8a8}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#a8a8a8}.crm-steps-container-step-circle[_ngcontent-%COMP%]{width:21px;min-width:21px;height:21px;min-height:21px;border-radius:50%;background:#3a50e4;color:#fff;display:flex;justify-content:center;align-items:center;font-weight:700;font-size:12px;margin-right:8px}.crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4;font-weight:500;margin-right:16px;font-size:13px}.crm-steps-container-step-separator[_ngcontent-%COMP%]{width:20px;height:1px;background:#3a50e4;margin-right:16px}.hidden-step[_ngcontent-%COMP%]{height:0;overflow:hidden;opacity:0;position:absolute;width:0;visibility:hidden}.steps-cards-body[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:16px}.steps-cards-body-card[_ngcontent-%COMP%]{border:1px solid var(--crm-border-light-color);border-radius:6px;padding:12px}.steps-cards-body-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--crm-border-light-color);padding-bottom:16px}.steps-cards-body-card-header-title[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:var(--crm-text-color)}.steps-cards-body-card-header-icon[_ngcontent-%COMP%]{font-size:14px;cursor:pointer;color:var(--crm-text-color)}.steps-cards-body-card-text[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color);padding-top:16px}.venta-body[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px}.venta-body[_ngcontent-%COMP%]   .steps-cards-body[_ngcontent-%COMP%]{min-width:300px;width:300px;flex-shrink:0}.venta-body-component[_ngcontent-%COMP%]{flex:1 1 0;min-width:0;overflow-y:auto}"]}),r})()}];let K=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[_.iI.forChild(L),_.iI]}),r})(),Z=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[m.MD,p.YN,l.bv,K]}),r})()}}]);