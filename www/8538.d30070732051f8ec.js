"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8538],{3895:(k,M,s)=>{s.d(M,{b:()=>e});var p=s(177),d=s(9417),h=s(9465),f=s(8147),P=s(3953);let e=(()=>{var C;class b{}return(C=b).\u0275fac=function(y){return new(y||C)},C.\u0275mod=P.$C({type:C}),C.\u0275inj=P.G2t({imports:[p.MD,d.YN,h.bv,f.h]}),b})()},1129:(k,M,s)=>{s.d(M,{Z:()=>P});var p=s(3953),d=s(6069),h=s(1982);function f(e,C){if(1&e){const b=p.RV6();p.j41(0,"app-country-selector-popover",4),p.bIt("countrySelected",function(y){p.eBV(b);const I=p.XpG();return p.Njj(I.selectCountry(y))})("closePopover",function(){p.eBV(b);const y=p.XpG();return p.Njj(y.dropdownOpen=!1)}),p.k0s()}2&e&&p.Y8G("showCountryCode",!0)}let P=(()=>{var e;class C{constructor(){this.emitCountrySelected=new p.bkB,this.countries=d.X,this.selectedCountry=d.X[0],this.dropdownOpen=!1}ngOnChanges(){const g=this.extractCountryPhoneCodeFromPhoneNumber(this.selectedPhoneNumber);g!==this.extractCountryPhoneCodeFromPhoneNumber(this.selectedCountry.phoneCode)&&this.selectCountryByPhoneCode(g)}toggleDropdown(g){g.stopPropagation(),this.dropdownOpen=!this.dropdownOpen}selectCountry(g){g.event.stopPropagation(),this.selectedCountry=g.country,this.emitCountrySelected.emit(g.country),this.dropdownOpen=!1}selectCountryByPhoneCode(g){const y=this.countries.find(I=>I.phoneCode===g);y&&(this.selectedCountry=y,this.emitCountrySelected.emit(y))}extractCountryPhoneCodeFromPhoneNumber(g){return null==g?void 0:g.split(" ")[0]}}return(e=C).\u0275fac=function(g){return new(g||e)},e.\u0275cmp=p.VBU({type:e,selectors:[["app-flag-country-selector"]],inputs:{selectedPhoneNumber:"selectedPhoneNumber"},outputs:{emitCountrySelected:"emitCountrySelected"},features:[p.OA$],decls:5,vars:3,consts:[["tabindex","0",1,"flag-country-selector-container",3,"click"],[1,"selected-country"],[1,"fas","fa-caret-down","dropdown-arrow"],[3,"showCountryCode"],[3,"countrySelected","closePopover","showCountryCode"]],template:function(g,y){1&g&&(p.j41(0,"div",0),p.bIt("click",function(i){return y.toggleDropdown(i)}),p.j41(1,"div",1),p.nrm(2,"span")(3,"i",2),p.k0s(),p.DNE(4,f,1,1,"app-country-selector-popover",3),p.k0s()),2&g&&(p.R7$(2),p.HbH(null==y.selectedCountry?null:y.selectedCountry.flagClass),p.R7$(2),p.vxM(y.dropdownOpen?4:-1))},dependencies:[h.u],styles:[".flag-country-selector-container[_ngcontent-%COMP%]{position:relative;width:50px;cursor:pointer;color:#000}.selected-country[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:40px;width:50px}.dropdown-arrow[_ngcontent-%COMP%]{margin-left:8px}.dropdown-options[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:200px;z-index:9999;background-color:#fff;border:1px solid #ccc;padding:8px 0;border-radius:12px;border:1px solid var(--crm-border-light-color);color:#000;max-height:150px;overflow-y:auto}.option[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;cursor:pointer;font-size:14px}.option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;display:inline-block;margin-right:8px}.option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.flag-country-selector-container[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{color:#000}.selected-country[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;width:18px;height:18px}"]}),C})()},6812:(k,M,s)=>{s.d(M,{u:()=>P});var p=s(177),d=s(9417),h=s(7754),f=s(3953);let P=(()=>{var e;class C{}return(e=C).\u0275fac=function(g){return new(g||e)},e.\u0275mod=f.$C({type:e}),e.\u0275inj=f.G2t({imports:[p.MD,d.YN,h.X]}),C})()},7754:(k,M,s)=>{s.d(M,{X:()=>P});var p=s(177),d=s(9417),h=s(9465),f=s(3953);let P=(()=>{var e;class C{}return(e=C).\u0275fac=function(g){return new(g||e)},e.\u0275mod=f.$C({type:e}),e.\u0275inj=f.G2t({imports:[p.MD,d.YN,h.bv]}),C})()},8538:(k,M,s)=>{s.r(M),s.d(M,{VentaOperationProcessPageModule:()=>de});var p=s(177),d=s(9417),h=s(9465),f=s(5188),P=s(467),e=s(3953),C=s(6039),b=s(8397);function g(o,l){if(1&o){const r=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(r);const t=e.XpG().$implicit,c=e.XpG();return e.Njj(c.onSelectPromotion(t))}),e.EFF(1," Seleccionada "),e.k0s()}}function y(o,l){if(1&o){const r=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(r);const t=e.XpG().$implicit,c=e.XpG();return e.Njj(c.onSelectPromotion(t))}),e.EFF(1," Seleccionar "),e.k0s()}}function I(o,l){if(1&o&&(e.j41(0,"div",14)(1,"div",15),e.EFF(2),e.k0s(),e.j41(3,"div",16),e.EFF(4),e.k0s(),e.j41(5,"div",17),e.DNE(6,g,2,0,"button",18)(7,y,2,0,"button",19),e.k0s()()),2&o){const r=l.$implicit,n=e.XpG();e.R7$(2),e.SpI(" ",r.projectName," "),e.R7$(2),e.Lme(" ",r.availableProperties.length," / ",r.properties.length," "),e.R7$(2),e.vxM((null==n.selectedPromotion?null:n.selectedPromotion.id)===r.id?6:7)}}let i=(()=>{var o;class l{constructor(n){this.api=n,this.selectPromotion=new e.bkB,this.promotions=[],this.selectedPromotion=null,this.searchTerm=""}ngOnInit(){this.getAllPromotions()}getAllPromotions(){var n=this;return(0,P.A)(function*(){try{const t={page:0,itemsPerPage:500},c=yield n.api.getPromotions({},null,t,{properties:{apply:!0,filter:null,onlyCount:!1},promotionFiles:{apply:!0,filter:null,onlyCount:!1},promoter:{apply:!0,filter:null,onlyCount:!1}});null!=c&&c.success?(n.promotions=c.success.data,n.promotions.forEach(a=>{var v;a.availableProperties=null===(v=a.properties)||void 0===v?void 0:v.filter(F=>"available"===F.availabilityStatus)}),console.log("All Promotions:",n.promotions)):console.error("Error fetching promotions:",null==c?void 0:c.error)}catch(t){console.error("Error in getAllPromotions:",t)}})()}get filteredPromotions(){return this.searchTerm?this.promotions.filter(n=>{var t;return null===(t=n.projectName)||void 0===t?void 0:t.toLowerCase().includes(this.searchTerm.toLowerCase())}):this.promotions}onSelectPromotion(n){this.selectPromotion.emit(n),this.selectedPromotion=n}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(C.i))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-promotion"]],outputs:{selectPromotion:"selectPromotion"},decls:19,vars:3,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"max-width","300px","margin-bottom","16px"],[1,"crm-input-input","crm-input-input-searchbar"],[1,"fas","fa-search"],["type","text","placeholder","Buscar promoci\xf3n...",3,"ngModelChange","ngModel"],[1,"promotions-table"],[1,"promotions-table-header"],[1,"promotions-table-header-title"],[1,"promotions-table-header-availability"],[1,"promotions-table-header-actions"],["class","promotions-table-row",4,"ngFor","ngForOf"],[1,"promotions-table-footer"],[1,"promotions-table-row"],[1,"promotions-table-row-title"],[1,"promotions-table-row-availability"],[1,"promotions-table-row-actions"],["disabled","",1,"crm-button"],[1,"crm-button"],["disabled","",1,"crm-button",3,"click"],[1,"crm-button",3,"click"]],template:function(n,t){1&n&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 1. Promoci\xf3n "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.nrm(6,"i",5),e.j41(7,"input",6),e.mxI("ngModelChange",function(a){return e.DH7(t.searchTerm,a)||(t.searchTerm=a),a}),e.k0s()()(),e.j41(8,"div",7)(9,"div",8)(10,"div",9),e.EFF(11,"Promoci\xf3n"),e.k0s(),e.j41(12,"div",10),e.EFF(13,"Viviendas disponibles"),e.k0s(),e.j41(14,"div",11),e.EFF(15,"Acciones"),e.k0s()(),e.DNE(16,I,8,4,"div",12),e.k0s(),e.j41(17,"div",13),e.EFF(18),e.k0s()()()),2&n&&(e.R7$(7),e.R50("ngModel",t.searchTerm),e.R7$(9),e.Y8G("ngForOf",t.filteredPromotions),e.R7$(2),e.SpI(" Total promociones: ",t.filteredPromotions.length," "))},dependencies:[p.Sq,d.me,d.BC,d.vS]}),l})();var u=s(7376),m=s(1296),_=s(6552),O=s(1880);function S(o,l){if(1&o){const r=e.RV6();e.qex(0),e.j41(1,"div",4),e.EFF(2),e.k0s(),e.j41(3,"app-table",5),e.bIt("rowClicked",function(t){e.eBV(r);const c=e.XpG();return e.Njj(c.onRowClicked(t))}),e.k0s(),e.nrm(4,"div",6),e.bVm()}if(2&o){const r=l.$implicit,n=l.index;e.R7$(2),e.SpI(" ",r.name||"Bloque "+(r.index||n+1)," "),e.R7$(),e.Y8G("table",r.tableConfig)}}let j=(()=>{var o;class l{constructor(n,t,c){this.tableService=n,this.utils=t,this.toastService=c,this.selectProperty=new e.bkB,this.blocks=[],this.allColumnsKeysSelected=["externalReference","reference","m2useful","m2total","terrace","plot","bedrooms","bathrooms","pool","storage","parking","price"],this.tableConfig={uniqueId:"table-1",showSelectors:!1,editCellsMode:!1,columns:[{key:"externalReference",label:"Ref. externa",size:"medium",editMode:{inputType:"text"}},{key:"reference",label:"Identificador",size:"medium",editMode:{inputType:"text"}},{key:"m2useful",label:"M2 \xfatiles",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersUseful?a.totalMeasures_squareMetersUseful+" m\xb2":""},{key:"m2total",label:"M2 total",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersBuilt?a.totalMeasures_squareMetersBuilt+" m\xb2":""},{key:"terrace",label:"Terraza",size:"small",fn:a=>{const T=(a.totalMeasures_squareMetersCoveredTerraces||0)+(a.totalMeasures_squareMetersUncoveredTerraces||0);return T?T+" m\xb2":""}},{key:"plot",label:"Parcela",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersPatch?a.totalMeasures_squareMetersPatch+" m\xb2":""},{key:"bedrooms",label:"Dorm.",size:"small"},{key:"bathrooms",label:"Ba\xf1os",size:"small"},{key:"pool",label:"Piscina",size:"small",fn:a=>a.f_pool_comunitaria?"Comunitaria":a.f_pool_privada?"Privada":"No"},{key:"storage",label:"Trastero",size:"small",fn:a=>a.fcustom_trastero?a.fcustom_trasteroPrice?this.utils.transformThousandSeparator(a.fcustom_trasteroPrice)+" \u20ac":a.fcustom_trasteroIncludedInPrice?"Incluido":"S\xed":"No"},{key:"parking",label:"Parking",size:"small",fn:a=>{let v=a.fcustom_parking?"S\xed":"No";return a.fcustom_parkingPrice&&(v=this.utils.transformThousandSeparator(a.fcustom_parkingPrice)+" \u20ac"),a.fcustom_parkingIncludedInPrice&&(v="Incluido"),a.fcustom_parkingComunitario&&(v+=" (Comunitario)"),v}},{key:"price",label:"Precio",size:"small",fn:a=>null!=a&&a.price?this.utils.transformThousandSeparator(a.price)+" \u20ac":""}],rows:[]}}ngOnInit(){}set selectedPromotion(n){this.promotion=n,this.getData()}getData(){var n;if(this.promotion){this.allColumnsKeysSelected=(null===(n=this.promotion)||void 0===n?void 0:n.tableColumnsKeysSelected)||this.allColumnsKeysSelected,this.blocks=this.promotion.promotionBlocks||[];for(let t=0;t<this.blocks.length;t++){const c=this.blocks[t];!c.properties||0===c.properties.length||(c.tableConfig=u.cloneDeep(this.tableConfig),c.tableConfig.rows=this.tableService.convertDataToTableRows(u.cloneDeep(c.properties),u.cloneDeep(c.tableConfig)),c.tableConfig.rows=this.addBackgroundColorsToTableRows(c.tableConfig.rows))}}}addBackgroundColorsToTableRows(n){for(let t=0;t<n.length;t++)switch(n[t].rawObject.availabilityStatus){case"available":n[t].style={backgroundColor:"success"};break;case"sold":n[t].style={backgroundColor:"red"};break;case"reserved":n[t].style={backgroundColor:"warning"};break;default:n[t].style={backgroundColor:"blocked"}}return n}onRowClicked(n){const t=n.rawObject;console.log("Row clicked, property:",t),this.selectProperty.emit(t)}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(m.a),e.rXU(_.T),e.rXU(b.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-property"]],outputs:{selectProperty:"selectProperty"},decls:5,vars:1,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[4,"ngFor","ngForOf"],[1,"block-title"],[2,"margin-bottom","16px",3,"rowClicked","table"],[2,"margin-bottom","16px"]],template:function(n,t){1&n&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 2. Vivienda principal "),e.k0s(),e.j41(3,"div",2),e.DNE(4,S,5,2,"ng-container",3),e.k0s()()),2&n&&(e.R7$(4),e.Y8G("ngForOf",t.blocks))},dependencies:[p.Sq,O.O],styles:[".block-title[_ngcontent-%COMP%]{margin-bottom:16px;font-size:14px;font-weight:500}"]}),l})();var E=s(4558);function V(o,l){if(1&o&&(e.j41(0,"option",21),e.EFF(1),e.k0s()),2&o){const r=l.$implicit;e.Y8G("value",r),e.R7$(),e.JRh(r)}}function R(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",22),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.editingPrice=!0)}),e.EFF(1),e.nI1(2,"thousandSeparator"),e.nrm(3,"i",23),e.k0s()}if(2&o){const r=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,r.priceSelected.priceWithoutIva)," \u20ac ")}}function B(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",24)(1,"input",25),e.mxI("ngModelChange",function(t){e.eBV(r);const c=e.XpG();return e.DH7(c.priceSelected.priceWithoutIva,t)||(c.priceSelected.priceWithoutIva=t),e.Njj(t)}),e.k0s(),e.j41(2,"i",26),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.onPriceConfirm())}),e.k0s()()}if(2&o){const r=e.XpG();e.R7$(),e.R50("ngModel",r.priceSelected.priceWithoutIva)}}let $=(()=>{var o;class l{constructor(){this.selectPrice=new e.bkB,this.priceSelected={priceWithoutIva:0,priceWithIva:0,finalPrice:0,iva:10},this.taxRates=["0%","10%","21%"],this.selectedTaxRate="10%",this.editingPrice=!1}set selectedProperty(n){this.property=n,this.priceSelected.priceWithoutIva=(null==n?void 0:n.price)||0,this.updateCalculations()}ngOnInit(){this.updateCalculations()}onTaxRateChange(){this.updateCalculations()}onPriceConfirm(){this.updateCalculations(),this.editingPrice=!1}updateCalculations(){const n=parseFloat(this.selectedTaxRate);this.priceSelected.iva=isNaN(n)?0:n,this.priceSelected.priceWithIva=this.priceSelected.priceWithoutIva*(this.priceSelected.iva/100),this.priceSelected.finalPrice=this.priceSelected.priceWithoutIva+this.priceSelected.priceWithIva}goNextSection(){this.selectPrice.emit(this.priceSelected),console.log("Go to the next section...")}}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-price"]],outputs:{selectPrice:"selectPrice"},decls:48,vars:17,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"max-width","200px","margin-bottom","24px"],[1,"crm-input-label"],[1,"crm-input-input","crm-input-input-searchbar-square"],[3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"title",2,"margin-bottom","8px"],[1,"price-table-header",2,"padding","0px 16px"],[1,"price-table-header-cell"],[1,"price-table"],[1,"price-table-row"],[1,"price-table-cell"],[1,"price-table-cell","editable-cell"],["class","editable-price-display",3,"click",4,"ngIf"],["class","editable-price-edit",4,"ngIf"],[1,"price-table-footer"],[1,"price-table-footer-cell"],[1,"crm-block-buttons-right",2,"margin-top","16px"],[1,"crm-button",3,"click"],[3,"value"],[1,"editable-price-display",3,"click"],[1,"fas","fa-pencil",2,"color","rgb(130, 130, 130)"],[1,"editable-price-edit"],["type","number",3,"ngModelChange","ngModel"],[1,"fas","fa-check",2,"color","rgb(11, 169, 11)",3,"click"]],template:function(n,t){1&n&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 3. Por precio "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.EFF(6," Impuestos IVA/IT "),e.k0s(),e.j41(7,"div",5)(8,"select",6),e.mxI("ngModelChange",function(a){return e.DH7(t.selectedTaxRate,a)||(t.selectedTaxRate=a),a}),e.bIt("change",function(){return t.onTaxRateChange()}),e.DNE(9,V,2,2,"option",7),e.k0s()()(),e.j41(10,"div",8),e.EFF(11," Tabla de precios "),e.k0s(),e.j41(12,"div",9)(13,"div",10),e.EFF(14,"Vivienda"),e.k0s(),e.j41(15,"div",10),e.EFF(16,"Precio"),e.k0s(),e.j41(17,"div",10),e.EFF(18,"IVA/ITP"),e.k0s(),e.j41(19,"div",10),e.EFF(20,"PVP"),e.k0s()(),e.j41(21,"div",11)(22,"div",12)(23,"div",13),e.EFF(24," 1A "),e.k0s(),e.j41(25,"div",14),e.DNE(26,R,4,3,"div",15)(27,B,3,1,"div",16),e.k0s(),e.j41(28,"div",13),e.EFF(29),e.k0s(),e.j41(30,"div",13),e.EFF(31),e.nI1(32,"thousandSeparator"),e.k0s()(),e.j41(33,"div",17)(34,"div",18),e.EFF(35," Total "),e.k0s(),e.j41(36,"div",18),e.EFF(37),e.nI1(38,"thousandSeparator"),e.k0s(),e.j41(39,"div",18),e.EFF(40),e.nI1(41,"thousandSeparator"),e.k0s(),e.j41(42,"div",18),e.EFF(43),e.nI1(44,"thousandSeparator"),e.k0s()()(),e.j41(45,"div",19)(46,"button",20),e.bIt("click",function(){return t.goNextSection()}),e.EFF(47," Ir a la siguiente secci\xf3n "),e.k0s()()()()),2&n&&(e.R7$(8),e.R50("ngModel",t.selectedTaxRate),e.R7$(),e.Y8G("ngForOf",t.taxRates),e.R7$(17),e.Y8G("ngIf",!t.editingPrice),e.R7$(),e.Y8G("ngIf",t.editingPrice),e.R7$(2),e.SpI(" ",t.selectedTaxRate," "),e.R7$(2),e.SpI(" ",e.bMT(32,9,t.priceSelected.finalPrice)," \u20ac "),e.R7$(6),e.SpI(" ",e.bMT(38,11,t.priceSelected.priceWithoutIva)," \u20ac "),e.R7$(3),e.SpI(" ",e.bMT(41,13,t.priceSelected.priceWithIva)," \u20ac "),e.R7$(3),e.SpI(" ",e.bMT(44,15,t.priceSelected.finalPrice)," \u20ac "))},dependencies:[p.Sq,p.bT,d.xH,d.y7,d.me,d.Q0,d.wz,d.BC,d.vS,E.w],styles:[".venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .crm-input[_ngcontent-%COMP%]{margin-bottom:16px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table-header[_ngcontent-%COMP%]{display:flex;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table-header[_ngcontent-%COMP%]   .price-table-header-cell[_ngcontent-%COMP%]{flex:1;font-size:14px;padding:8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]{border-radius:12px;padding:0 16px;background:#f9f9f9}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%], .venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 0;border-bottom:1px solid var(--crm-border-light-color)}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer[_ngcontent-%COMP%]{font-weight:500;border:none}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-cell[_ngcontent-%COMP%], .venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer-cell[_ngcontent-%COMP%]{flex:1;font-size:14px;padding:8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-cell[_ngcontent-%COMP%]{display:flex;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]{cursor:pointer;display:inline-flex;gap:8px;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color)}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]{display:inline-flex;gap:8px;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:120px;background:#fff;outline:none;border:1px solid var(--crm-border-light-color);border-radius:8px;padding:4px 8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--crm-text-color);cursor:pointer}"]}),l})(),N=(()=>{var o;class l{constructor(){this.selectDocumentData=new e.bkB,this.formData={contractType:"propio",signatureType:"papel",reservationAmount:null}}ngOnInit(){}onContinue(){console.log("Form data:",this.formData),this.selectDocumentData.emit(this.formData)}}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-document"]],outputs:{selectDocumentData:"selectDocumentData"},decls:44,vars:3,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"margin-bottom","16px"],[1,"crm-text"],[3,"ngModelChange","ngModel"],[1,"crm-input-radio"],["value","byvaro"],[1,"crm-input-radio-label"],["value","propio"],[2,"border","none","border-bottom","1px solid #e5e5e5","margin","24px 0"],["value","electronica"],["value","papel"],[1,"title","mb8"],[1,"crm-text","small","light","mb16"],[1,"crm-input",2,"margin-bottom","24px","max-width","300px"],[1,"crm-input-label"],[1,"crm-input-input"],["type","number","placeholder","Por ejemplo 3000\u20ac",3,"ngModelChange","ngModel"],[1,"crm-block-buttons-right"],[1,"crm-button",3,"click"]],template:function(n,t){1&n&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 4. Documento de reserva "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.EFF(6," Redacci\xf3n del contrato: "),e.k0s(),e.j41(7,"ion-radio-group",5),e.mxI("ngModelChange",function(a){return e.DH7(t.formData.contractType,a)||(t.formData.contractType=a),a}),e.j41(8,"div",6),e.nrm(9,"ion-radio",7),e.j41(10,"div",8),e.EFF(11," Contrato redactado en Byvaro "),e.k0s()(),e.j41(12,"div",6),e.nrm(13,"ion-radio",9),e.j41(14,"div",8),e.EFF(15," Contrato propio "),e.k0s()()()(),e.nrm(16,"hr",10),e.j41(17,"div",3)(18,"div",4),e.EFF(19," T\xe9rminos y condiciones de la firma: "),e.k0s(),e.j41(20,"ion-radio-group",5),e.mxI("ngModelChange",function(a){return e.DH7(t.formData.signatureType,a)||(t.formData.signatureType=a),a}),e.j41(21,"div",6),e.nrm(22,"ion-radio",11),e.j41(23,"div",8),e.EFF(24," Firma electr\xf3nica "),e.k0s()(),e.j41(25,"div",6),e.nrm(26,"ion-radio",12),e.j41(27,"div",8),e.EFF(28," Firma en papel "),e.k0s()()()(),e.nrm(29,"hr",10),e.j41(30,"div",13),e.EFF(31," Cantidad que debe pagar el cliente para reservar: "),e.k0s(),e.j41(32,"div",14),e.EFF(33," Este campo puede heredar autom\xe1ticamente el valor definido en la configuraci\xf3n de la promoci\xf3n."),e.nrm(34,"br"),e.EFF(35," Por favor, rev\xedsalo antes de continuar. "),e.k0s(),e.j41(36,"div",15)(37,"div",16),e.EFF(38," Cantidad de reserva (\u20ac) "),e.k0s(),e.j41(39,"div",17)(40,"input",18),e.mxI("ngModelChange",function(a){return e.DH7(t.formData.reservationAmount,a)||(t.formData.reservationAmount=a),a}),e.k0s()()(),e.j41(41,"div",19)(42,"button",20),e.bIt("click",function(){return t.onContinue()}),e.EFF(43," Continuar la reserva "),e.k0s()()()()),2&n&&(e.R7$(7),e.R50("ngModel",t.formData.contractType),e.R7$(13),e.R50("ngModel",t.formData.signatureType),e.R7$(20),e.R50("ngModel",t.formData.reservationAmount))},dependencies:[d.me,d.Q0,d.BC,d.vS,h.KO,h.f0,h.Je],styles:[".crm-text[_ngcontent-%COMP%]{font-style:normal;margin-bottom:8px}.crm-input-radio[_ngcontent-%COMP%]{margin-bottom:8px}ion-radio-group[_ngcontent-%COMP%]{display:flex;gap:16px}.mb8[_ngcontent-%COMP%]{margin-bottom:8px}.mb16[_ngcontent-%COMP%]{margin-bottom:16px}"]}),l})();var G=s(1129);const w=["addressInput"],x=o=>({"crm-input-input-error":o});function A(o,l){1&o&&(e.j41(0,"div",25),e.EFF(1," Por favor, introduce un correo electr\xf3nico v\xe1lido "),e.k0s())}function U(o,l){1&o&&(e.j41(0,"div",25),e.EFF(1," El nombre es requerido "),e.k0s())}function W(o,l){1&o&&(e.j41(0,"div",25),e.EFF(1," La fecha de nacimiento es requerida "),e.k0s())}function Y(o,l){1&o&&(e.j41(0,"div",25),e.EFF(1," El n\xfamero de tel\xe9fono es requerido "),e.k0s())}function X(o,l){1&o&&(e.j41(0,"div",25),e.EFF(1," El DNI o Pasaporte es requerido "),e.k0s())}let K=(()=>{var o;class l{constructor(n,t,c,a){this.fb=n,this.ngZone=t,this.api=c,this.utils=a,this.selectContactData=new e.bkB,this.mapCenter={lat:40.416775,lng:-3.70379},this.mapZoom=6,this.markerPosition=this.mapCenter,this.mapOptions={disableDefaultUI:!1,styles:[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]}]},this.markerOptions={draggable:!0},this.contactForm=this.fb.group({email:["",[d.k0.required,d.k0.email]],name:["",d.k0.required],birthDate:["",d.k0.required],phoneNumber:["+34 ",d.k0.required],dni:["",d.k0.required],address:["",d.k0.required]})}ngOnInit(){this.contact&&this.patchContactData()}ngAfterViewInit(){this.addressInput&&(this.autocomplete=new google.maps.places.Autocomplete(this.addressInput.nativeElement,{types:["geocode"],componentRestrictions:{country:"es"}}),this.autocomplete.addListener("place_changed",()=>{this.ngZone.run(()=>{const t=this.autocomplete.getPlace();if(!t.geometry)return;this.mapCenter={lat:t.geometry.location.lat(),lng:t.geometry.location.lng()},this.markerPosition=this.mapCenter,this.mapZoom=17;const c=t.formatted_address||t.name||"";this.contactForm.patchValue({address:c}),this.addressInput.nativeElement.value=c})}))}set contactData(n){this.contact=n,this.contact&&this.patchContactData()}patchContactData(){var n,t,c;let a=this.utils.parseBackendDateToFrontendDateInput(null===(n=this.contact)||void 0===n?void 0:n.birthdate);this.contactForm.patchValue({email:(null===(t=this.contact.emails)||void 0===t?void 0:t[0])||"",name:this.contact.name||"",birthDate:a||"",phoneNumber:(null===(c=this.contact.phones)||void 0===c?void 0:c[0])||"+34 ",dni:this.contact.dniPassport||"",address:this.contact.address||""})}isControlInvalid(n){const t=this.contactForm.get(n);return!(!t||!t.invalid||!t.dirty&&!t.touched)}onSelectCountry(n){console.log("Selected country prefix:",n);const t=null==n?void 0:n.phoneCode,c=this.contactForm.get("phoneNumber");if(!c)return;const v=(c.value||"").split(" ");v.shift();const F=v.join(" ");c.setValue(`${t} ${F}`)}onAddressSelected(n){console.log("Address selected:",n),this.contactForm.patchValue({address:(null==n?void 0:n.formatted_address)||(null==n?void 0:n.address)||""})}getAddressFromCoordinates(n,t){(new google.maps.Geocoder).geocode({location:{lat:n,lng:t}},(a,v)=>{"OK"===v&&a&&a[0]&&this.ngZone.run(()=>{const F=a[0].formatted_address;this.contactForm.patchValue({address:F}),this.addressInput&&(this.addressInput.nativeElement.value=F),this.markerPosition={lat:n,lng:t}})})}onPrevStep(){console.log("Going to previous step...")}onNextStep(){var n=this;return(0,P.A)(function*(){var t,c,a;if(n.contactForm.invalid)return void n.contactForm.markAllAsTouched();let v=(null===(t=n.contact)||void 0===t?void 0:t.phones)||[];v.includes(n.contactForm.value.phoneNumber)||v.unshift(n.contactForm.value.phoneNumber);let F=(null===(c=n.contact)||void 0===c?void 0:c.emails)||[];F.includes(n.contactForm.value.email)||F.unshift(n.contactForm.value.email);const T={name:n.contactForm.value.name,birthdate:new Date(n.contactForm.value.birthDate),phones:v,emails:F,dniPassport:n.contactForm.value.dni,address:n.contactForm.value.address};(yield n.api.updateContactById(null===(a=n.contact)||void 0===a?void 0:a.id,T))&&(console.log("Form data:",n.contactForm.value),n.selectContactData.emit())})()}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(d.ok),e.rXU(e.SKi),e.rXU(C.i),e.rXU(_.T))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-contact-data"]],viewQuery:function(n,t){if(1&n&&e.GBs(w,5),2&n){let c;e.mGM(c=e.lsd())&&(t.addressInput=c.first)}},inputs:{contact:"contact",contactData:"contactData"},outputs:{selectContactData:"selectContactData"},decls:54,vars:19,consts:[["addressInput",""],[1,"venta-component"],[1,"title"],[1,"content"],[3,"ngSubmit","formGroup"],[1,"crm-input",2,"margin-bottom","8px"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass"],["type","text","placeholder","Field","formControlName","email"],["class","crm-input-error",4,"ngIf"],[1,"crm-text","small","light",2,"margin-bottom","16px"],[1,"crm-input",2,"margin-bottom","16px"],["type","text","placeholder","ex: Juan","formControlName","name"],[1,"crm-input-input"],["type","date","formControlName","birthDate"],[1,"crm-input"],[1,"crm-input-input-and-icon"],[3,"emitCountrySelected","selectedPhoneNumber"],["type","text","placeholder","N\xfamero de tel\xe9fono","formControlName","phoneNumber"],[1,"crm-text","small","light",2,"margin-bottom","8px"],["type","text","placeholder","ex: 48500285A","formControlName","dni"],["type","text","formControlName","address","placeholder","Escribe la direcci\xf3n"],[2,"display","flex","gap","16px"],["type","button",1,"crm-button-secondary",3,"click"],["type","submit",1,"crm-button",3,"click"],[1,"crm-input-error"]],template:function(n,t){if(1&n){const c=e.RV6();e.j41(0,"div",1)(1,"div",2),e.EFF(2," 5. Datos del contacto "),e.k0s(),e.j41(3,"div",3)(4,"form",4),e.bIt("ngSubmit",function(){return e.eBV(c),e.Njj(t.onNextStep())}),e.j41(5,"div",5)(6,"div",6),e.EFF(7," Correo electr\xf3nico "),e.k0s(),e.j41(8,"div",7),e.nrm(9,"input",8),e.k0s(),e.DNE(10,A,2,0,"div",9),e.k0s(),e.j41(11,"div",10),e.EFF(12," Por favor, compruebe que la direcci\xf3n de correo electr\xf3nico ingresada es correcta. "),e.k0s(),e.j41(13,"div",11)(14,"div",6),e.EFF(15," Nombre y apellidos "),e.k0s(),e.j41(16,"div",7),e.nrm(17,"input",12),e.k0s(),e.DNE(18,U,2,0,"div",9),e.k0s(),e.j41(19,"div",11)(20,"div",6),e.EFF(21," Fecha de nacimiento "),e.k0s(),e.j41(22,"div",13),e.nrm(23,"input",14),e.k0s(),e.DNE(24,W,2,0,"div",9),e.k0s(),e.j41(25,"div",15)(26,"div",6),e.EFF(27," Phone number "),e.k0s(),e.j41(28,"div",16)(29,"div",7)(30,"app-flag-country-selector",17),e.bIt("emitCountrySelected",function(v){return e.eBV(c),e.Njj(t.onSelectCountry(v))}),e.k0s(),e.nrm(31,"input",18),e.k0s()(),e.DNE(32,Y,2,0,"div",9),e.j41(33,"div",19),e.EFF(34," Por favor, compruebe que el n\xfamero de tel\xe9fono m\xf3vil ingresado es correcto. Ser\xe1 utilizado para la firma electr\xf3nica."),e.nrm(35,"br")(36,"br"),e.k0s()(),e.j41(37,"div",11)(38,"div",6),e.EFF(39," Dni / Pasaporte "),e.k0s(),e.j41(40,"div",7),e.nrm(41,"input",20),e.k0s(),e.DNE(42,X,2,0,"div",9),e.k0s(),e.j41(43,"div",11)(44,"div",6),e.EFF(45," Direcci\xf3n "),e.k0s(),e.j41(46,"div",13),e.nrm(47,"input",21,0),e.k0s()(),e.j41(49,"div",22)(50,"button",23),e.bIt("click",function(){return e.eBV(c),e.Njj(t.onPrevStep())}),e.EFF(51," Anterior "),e.k0s(),e.j41(52,"button",24),e.bIt("click",function(){return e.eBV(c),e.Njj(t.onNextStep())}),e.EFF(53," Siguiente "),e.k0s()()()()()}if(2&n){let c;e.R7$(4),e.Y8G("formGroup",t.contactForm),e.R7$(4),e.Y8G("ngClass",e.eq3(11,x,t.isControlInvalid("email"))),e.R7$(2),e.Y8G("ngIf",t.isControlInvalid("email")),e.R7$(6),e.Y8G("ngClass",e.eq3(13,x,t.isControlInvalid("name"))),e.R7$(2),e.Y8G("ngIf",t.isControlInvalid("name")),e.R7$(6),e.Y8G("ngIf",t.isControlInvalid("birthDate")),e.R7$(5),e.Y8G("ngClass",e.eq3(15,x,t.isControlInvalid("phoneNumber"))),e.R7$(),e.Y8G("selectedPhoneNumber",null==(c=t.contactForm.get("phoneNumber"))?null:c.value),e.R7$(2),e.Y8G("ngIf",t.isControlInvalid("phoneNumber")),e.R7$(8),e.Y8G("ngClass",e.eq3(17,x,t.isControlInvalid("dni"))),e.R7$(2),e.Y8G("ngIf",t.isControlInvalid("dni"))}},dependencies:[p.YU,p.bT,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,G.Z],styles:[".venta-component[_ngcontent-%COMP%]{max-width:500px}"]}),l})();const L=["selectPropertyComponent"],z=["selectPriceComponent"],D=o=>({"hidden-step":o}),H=(o,l)=>({"crm-steps-container-step-current":o,"crm-steps-container-step-inactive":l});function J(o,l){1&o&&e.nrm(0,"i",24)}function Z(o,l){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const r=e.XpG().index;e.R7$(),e.JRh(r+1)}}function Q(o,l){1&o&&e.nrm(0,"div",25)}function q(o,l){if(1&o&&(e.j41(0,"div",18)(1,"div",19),e.DNE(2,J,1,0,"i",20)(3,Z,2,1,"span",21),e.k0s(),e.j41(4,"div",22),e.EFF(5),e.k0s(),e.DNE(6,Q,1,0,"div",23),e.k0s()),2&o){const r=l.$implicit,n=l.index,t=e.XpG();e.Y8G("ngClass",e.l_i(5,H,n==t.activeIndex,n>t.activeIndex)),e.R7$(2),e.Y8G("ngIf",n<t.activeIndex),e.R7$(),e.Y8G("ngIf",n>=t.activeIndex),e.R7$(2),e.SpI(" ",r," "),e.R7$(),e.Y8G("ngIf",n<t.steps.length-1)}}function ee(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 1. Promoci\xf3n "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(r);const t=e.XpG(2);return e.Njj(t.changeStep(0))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const r=e.XpG(2);e.R7$(7),e.SpI(" ",null==r.data||null==r.data.promotion?null:r.data.promotion.projectName," ")}}function te(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 2. Vivienda principal "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(r);const t=e.XpG(2);return e.Njj(t.changeStep(1))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const r=e.XpG(2);e.R7$(7),e.SpI(" ",null==r.data||null==r.data.property?null:r.data.property.reference," ")}}function ne(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 3. Por precio "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(r);const t=e.XpG(2);return e.Njj(t.changeStep(2))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.nI1(8,"thousandSeparator"),e.k0s()()}if(2&o){const r=e.XpG(2);e.R7$(7),e.SpI(" ",e.bMT(8,1,null==r.data||null==r.data.priceSelected?null:r.data.priceSelected.finalPrice)," \u20ac ")}}function oe(o,l){if(1&o){const r=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 4. Documento de reserva "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(r);const t=e.XpG(2);return e.Njj(t.changeStep(3))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const r=e.XpG(2);e.R7$(7),e.SpI(" ",null==r.data||null==r.data.documentData?null:r.data.documentData.contractType," ")}}function re(o,l){if(1&o&&(e.j41(0,"div",26),e.DNE(1,ee,8,1,"div",27)(2,te,8,1,"div",27)(3,ne,9,3,"div",27)(4,oe,8,1,"div",27),e.k0s()),2&o){const r=e.XpG();e.R7$(),e.Y8G("ngIf",null==r.data?null:r.data.promotion),e.R7$(),e.Y8G("ngIf",null==r.data?null:r.data.property),e.R7$(),e.Y8G("ngIf",null==r.data||null==r.data.priceSelected?null:r.data.priceSelected.finalPrice),e.R7$(),e.Y8G("ngIf",null==r.data?null:r.data.documentData)}}const ae=[{path:"",component:(()=>{var o;class l{constructor(n,t,c,a){this.api=n,this.route=t,this.toast=c,this.router=a,this.data={promotion:null,property:null,priceSelected:{priceWithoutIva:null,priceWithIva:null,finalPrice:null,iva:10},documentData:null},this.steps=["Promoci\xf3n","Vivienda principal","Por precio","Documento de reserva","Datos del cliente"],this.activeIndex=0}ngOnInit(){const n=this.route.snapshot.paramMap.get("operationId");n?this.api.getOperation({id:{equals:n}},null,null,{contact:{apply:!0,filter:null,onlyCount:!1},createdBy:{apply:!0,filter:null,onlyCount:!1},responsible:{apply:!0,filter:null,onlyCount:!1},mainProperty:{apply:!0,filter:null,onlyCount:!1},currentPipeline:{apply:!0,filter:null,onlyCount:!1},currentPipelineStep:{apply:!0,filter:null,onlyCount:!1},promotions:{apply:!0,filter:null,onlyCount:!1},selectedProperties:{apply:!0,filter:null,onlyCount:!1},notes:{apply:!0,filter:null,onlyCount:!1},operations:{apply:!0,filter:null,onlyCount:!1},operationRegisters:{apply:!0,filter:null,onlyCount:!1}}).then(t=>{t.success&&t.success.data&&t.success.data.length&&(this.operation=t.success.data[0],console.log("Retrieved operation:",this.operation))}).catch(t=>{console.error("Error retrieving operation:",t)}):console.warn("No operationId parameter found in the URL.")}onSelectPromotion(n){var t=this;return(0,P.A)(function*(){var c;t.data.promotion=n,t.activeIndex=1;const a=yield t.api.getPromotionFullDataById(t.data.promotion.id);t.data.promotion=null==a||null===(c=a.success)||void 0===c?void 0:c.data,t.selectPropertyComponent.selectedPromotion=t.data.promotion})()}onSelectProperty(n){var t=this;return(0,P.A)(function*(){t.data.property=n,t.selectPriceComponent.selectedProperty=n,t.activeIndex=2})()}onSelectPrice(n){this.data.priceSelected=n,this.activeIndex=3}onSelectDocumentData(n){this.data.documentData=n,this.activeIndex=4}onSelectContactData(){console.log("Contact data selected:",this.data.documentData),this.finishFlow()}finishFlow(){var n=this;return(0,P.A)(function*(){const t={propertyId:n.data.property.id,operationId:n.operation.id,priceSelected:n.data.priceSelected,documentData:n.data.documentData};(yield n.api.reserveProperty(t)).success?(n.toast.showSuccessToast("Reserva realizada correctamente"),n.router.navigate(["/contacts",n.operation.contactId,"operations",n.operation.id])):n.toast.showErrorToast("Error al realizar la reserva")})()}changeStep(n){this.activeIndex=n,0===n&&(this.data.property=null,this.data.priceSelected=null,this.data.documentData=null,this.selectPropertyComponent.selectedPromotion=null),1===n&&(this.data.priceSelected=null,this.data.documentData=null,this.selectPriceComponent.selectedProperty=null),console.log("DATAAAA",this.data)}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(C.i),e.rXU(f.nX),e.rXU(b.f),e.rXU(f.Ix))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-operation-process"]],viewQuery:function(n,t){if(1&n&&(e.GBs(L,7),e.GBs(z,7)),2&n){let c;e.mGM(c=e.lsd())&&(t.selectPropertyComponent=c.first),e.mGM(c=e.lsd())&&(t.selectPriceComponent=c.first)}},decls:22,vars:19,consts:[["selectPropertyComponent",""],["selectPriceComponent",""],["selectClientComponent",""],[3,"fullscreen"],[1,"crm-block-content"],[1,"crm-block-body"],[1,"crm-block-body-blue-content"],[1,"crm-steps-container"],["class","crm-steps-container-step",3,"ngClass",4,"ngFor","ngForOf"],[1,"venta-body"],[1,"venta-body-component"],[3,"ngClass"],[3,"selectPromotion"],[3,"selectProperty"],[3,"selectPrice"],[3,"selectDocumentData"],[3,"selectContactData","contactData"],["class","steps-cards-body",4,"ngIf"],[1,"crm-steps-container-step",3,"ngClass"],[1,"crm-steps-container-step-circle"],["class","fa fa-check",4,"ngIf"],[4,"ngIf"],[1,"crm-steps-container-step-label"],["class","crm-steps-container-step-separator",4,"ngIf"],[1,"fa","fa-check"],[1,"crm-steps-container-step-separator"],[1,"steps-cards-body"],["class","steps-cards-body-card",4,"ngIf"],[1,"steps-cards-body-card"],[1,"steps-cards-body-card-header"],[1,"steps-cards-body-card-header-title"],[1,"steps-cards-body-card-header-icon",3,"click"],[1,"fa-solid","fa-pencil"],[1,"steps-cards-body-card-text"]],template:function(n,t){if(1&n){const c=e.RV6();e.j41(0,"ion-content",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7),e.DNE(5,q,7,8,"div",8),e.k0s(),e.j41(6,"div",9)(7,"div",10)(8,"div",11)(9,"app-venta-select-promotion",12),e.bIt("selectPromotion",function(v){return e.eBV(c),e.Njj(t.onSelectPromotion(v))}),e.k0s()(),e.j41(10,"div",11)(11,"app-venta-select-property",13,0),e.bIt("selectProperty",function(v){return e.eBV(c),e.Njj(t.onSelectProperty(v))}),e.k0s()(),e.j41(13,"div",11)(14,"app-venta-select-price",14,1),e.bIt("selectPrice",function(v){return e.eBV(c),e.Njj(t.onSelectPrice(v))}),e.k0s()(),e.j41(16,"div",11)(17,"app-venta-select-document",15,2),e.bIt("selectDocumentData",function(v){return e.eBV(c),e.Njj(t.onSelectDocumentData(v))}),e.k0s()(),e.j41(19,"div",11)(20,"app-venta-select-contact-data",16),e.bIt("selectContactData",function(){return e.eBV(c),e.Njj(t.onSelectContactData())}),e.k0s()()(),e.DNE(21,re,5,4,"div",17),e.k0s()()()()()}2&n&&(e.Y8G("fullscreen",!0),e.R7$(5),e.Y8G("ngForOf",t.steps),e.R7$(3),e.Y8G("ngClass",e.eq3(9,D,0!==t.activeIndex)),e.R7$(2),e.Y8G("ngClass",e.eq3(11,D,1!==t.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(13,D,2!==t.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(15,D,3!==t.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(17,D,4!==t.activeIndex)),e.R7$(),e.Y8G("contactData",null==t.operation?null:t.operation.contact),e.R7$(),e.Y8G("ngIf",null==t.data?null:t.data.promotion))},dependencies:[p.YU,p.Sq,p.bT,h.W9,i,j,$,N,K,E.w],styles:[".crm-steps-container[_ngcontent-%COMP%], .crm-steps-container-step[_ngcontent-%COMP%]{display:flex;align-items:center}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#3a50e4;border:1px solid #3A50E4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#3a50e4}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#a8a8a8;border:1px solid rgb(168,168,168)}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#a8a8a8}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#a8a8a8}.crm-steps-container-step-circle[_ngcontent-%COMP%]{width:21px;min-width:21px;height:21px;min-height:21px;border-radius:50%;background:#3a50e4;color:#fff;display:flex;justify-content:center;align-items:center;font-weight:700;font-size:12px;margin-right:8px}.crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4;font-weight:500;margin-right:16px;font-size:13px}.crm-steps-container-step-separator[_ngcontent-%COMP%]{width:20px;height:1px;background:#3a50e4;margin-right:16px}.hidden-step[_ngcontent-%COMP%]{height:0;overflow:hidden;opacity:0;position:absolute;width:0;visibility:hidden}.steps-cards-body[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:16px}.steps-cards-body-card[_ngcontent-%COMP%]{border:1px solid var(--crm-border-light-color);border-radius:6px;padding:12px}.steps-cards-body-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--crm-border-light-color);padding-bottom:16px}.steps-cards-body-card-header-title[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:var(--crm-text-color)}.steps-cards-body-card-header-icon[_ngcontent-%COMP%]{font-size:14px;cursor:pointer;color:var(--crm-text-color)}.steps-cards-body-card-text[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color);padding-top:16px}.venta-body[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px}.venta-body[_ngcontent-%COMP%]   .steps-cards-body[_ngcontent-%COMP%]{min-width:300px;width:300px;flex-shrink:0}.venta-body-component[_ngcontent-%COMP%]{flex:1 1 0;min-width:0;overflow-y:auto}"]}),l})()}];let ie=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.iI.forChild(ae),f.iI]}),l})();var ce=s(3895),se=s(9662),le=s(6812),pe=s(969);let de=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,d.YN,h.bv,d.X1,ie,ce.b,se.Y,le.u,pe.rJ]}),l})()},9662:(k,M,s)=>{s.d(M,{Y:()=>h});var p=s(177),d=s(3953);let h=(()=>{var f;class P{}return(f=P).\u0275fac=function(C){return new(C||f)},f.\u0275mod=d.$C({type:f}),f.\u0275inj=d.G2t({imports:[p.MD]}),P})()},4558:(k,M,s)=>{s.d(M,{w:()=>d});var p=s(3953);let d=(()=>{var h;class f{transform(e,...C){if(null==e||""===e)return"";let b;return b="string"==typeof e?parseFloat(e):e,isNaN(b)?"":b.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}}return(h=f).\u0275fac=function(e){return new(e||h)},h.\u0275pipe=p.EJ8({name:"thousandSeparator",type:h,pure:!0}),f})()},6552:(k,M,s)=>{s.d(M,{T:()=>b});var p=s(467),d=s(7376),f=s(6069),P=s(3953),e=s(5188),C=s(6039);let b=(()=>{var g;class y{constructor(i,u){this.router=i,this.api=u}parseBackendDateToFrontendDateInput(i){if(!i)return null;try{const u=new Date(i),m=u.getFullYear();return`${m}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`}catch(u){return console.error("Invalid date format",u),null}}parseProperties(i){for(let m in i)i[m]instanceof Date?i[m]=i[m].toISOString():"string"==typeof i[m]&&i[m].match(/^\d{4}-\d{2}-\d{2}$/)&&(i[m]=new Date(i[m]).toISOString()),"true"===i[m]?i[m]=!0:"false"===i[m]&&(i[m]=!1);const u=d.cloneDeep(i);return delete u.id,u}parseNameToValue(i){return i.toLowerCase().replace(/ /g,"_")}groupPropertiesByPromotion(i,u){return i.map(_=>{const O=u.filter(S=>S.promotionId===_.id);return{..._,properties:O}})}setStepsCompleted(i,u){return i.steps=d.orderBy(i.steps,["order"],["asc"]),i.steps=i.steps.map(m=>(m.order<u.order&&(m.isCompleted=!0),m)),i}hexToRgba(i,u){if(!i)return"";let m,_,O;if(3===(i=i.replace("#","")).length)m=parseInt(i[0]+i[0],16),_=parseInt(i[1]+i[1],16),O=parseInt(i[2]+i[2],16);else{if(6!==i.length)return"";m=parseInt(i.substring(0,2),16),_=parseInt(i.substring(2,4),16),O=parseInt(i.substring(4,6),16)}return`rgba(${m}, ${_}, ${O}, ${u})`}getLanguageInfo(i){return f.e.find(m=>m.code===i)||{}}getCountryInfo(i){return f.X.find(m=>m.code===i)||{}}countAvailableProperties(i){return i&&0!==i.length?i.filter(u=>"available"===u.availabilityStatus).length:0}calculateRangeOfPropertiesPrices(i){if(!i||0===i.length)return{min:0,max:0};const u=i.map(m=>m.price);return{min:Math.min(...u),max:Math.max(...u)}}calculateRangeOfPropertiesRooms(i){if(!i||0===i.length)return{min:0,max:0};const u=i.map(m=>m.bedrooms);return{min:Math.min(...u),max:Math.max(...u)}}onRemoveAgencyAccessToPromotion(i){console.log("onRemoveAgencyAccessToPromotion",i)}redirectToPromoter(i){this.router.navigate([`/promoters/${i.id}`])}filterFilesByCategoryAndSort(i,u){return i&&0!==i.length?i.filter(m=>m.category===u).sort((m,_)=>{var O,S;return(null!==(O=null==m?void 0:m.orderIndex)&&void 0!==O?O:0)-(null!==(S=null==_?void 0:_.orderIndex)&&void 0!==S?S:0)}):[]}transformThousandSeparator(i){if(null==i||""===i)return"";let u;return u="string"==typeof i?parseFloat(i):i,isNaN(u)?"":u.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}detectIfPromotionIsCompleted(i){var u=this;return(0,p.A)(function*(){var m;if(!i)return!1;const _=null===(m=yield u.api.getPromotionById(i.id))||void 0===m||null===(m=m.success)||void 0===m?void 0:m.data;return((null==_?void 0:_.deliveryDateModalityByStatus)||(null==_?void 0:_.deliveryDateModalityByMonths))&&!(null==_||!_.sellCommissionPercentage)&&!(null==_||!_.methodToPayCommissions)&&!(null==_||!_.reservePayment)&&((null==_?void 0:_.registersWithPreRegister)||(null==_?void 0:_.registersWithoutPreRegister))})()}isImageFile(i){var u;const _=null===(u=i.split(".").pop())||void 0===u?void 0:u.toLowerCase();return!!_&&["png","jpg","jpeg","gif","bmp","webp","svg","tiff","tif","ico","heic","jfif"].includes(_)}}return(g=y).\u0275fac=function(i){return new(i||g)(P.KVO(e.Ix),P.KVO(C.i))},g.\u0275prov=P.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),y})()}}]);