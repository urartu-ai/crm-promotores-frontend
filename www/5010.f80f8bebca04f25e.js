"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5010],{3837:(x,E,r)=>{r.d(E,{q:()=>Lt});var h=r(467),F=r(8392),R=r(7376),t=r(3953),s=r(9417),I=r(9333),T=r(6552);let b=(()=>{var e;class l{constructor(o,n,a){this.fb=o,this.contactsService=n,this.utils=a,this.initForm()}initForm(){this.contactForm=this.fb.group({name:["",s.k0.required],contactType:[null],origin:["",s.k0.required],dniPassport:[""],nationality:[""],birthdate:[null],gender:[""],alias:[""],address:[""],urlFacebook:[""],urlInstagram:[""],urlLinkedIn:[""],contactPhones:this.fb.array([this.createPhoneGroup()]),contactEmails:this.fb.array([this.createEmailGroup()]),files:[],photoEdited:!1,type:"particular",reference:[""]})}populateForm(o){var n,a,c,u,d,p,m,$,M,O,j,y,S,D,G;this.contactForm.patchValue({name:null!==(n=o.name)&&void 0!==n?n:"",contactType:null!==(a=o.contactType)&&void 0!==a?a:"",origin:null!==(c=o.origin)&&void 0!==c?c:"",dniPassport:null!==(u=o.dniPassport)&&void 0!==u?u:"",nationality:null!==(d=o.nationality)&&void 0!==d?d:"",birthdate:null!=o&&o.birthdate?this.utils.parseBackendDateToFrontendDateInput(null==o?void 0:o.birthdate):null,gender:null!==(p=o.gender)&&void 0!==p?p:"",alias:null!==(m=o.alias)&&void 0!==m?m:"",address:null!==($=o.address)&&void 0!==$?$:"",urlFacebook:null!==(M=o.urlFacebook)&&void 0!==M?M:"",urlInstagram:null!==(O=o.urlInstagram)&&void 0!==O?O:"",urlLinkedIn:null!==(j=o.urlLinkedIn)&&void 0!==j?j:"",type:null!==(y=o.type)&&void 0!==y?y:"particular",reference:null!==(S=o.reference)&&void 0!==S?S:""}),this.contactPhones.clear(),null===(D=o.phones)||void 0===D||D.forEach(C=>{this.contactPhones.push(this.fb.group({phoneNumber:null!=C?C:""}))}),this.contactEmails.clear(),null===(G=o.emails)||void 0===G||G.forEach(C=>{this.contactEmails.push(this.fb.group({emailAddress:null!=C?C:""}))})}createPhoneGroup(){return this.fb.group({phoneNumber:["+34 ",[s.k0.required]]})}createEmailGroup(){return this.fb.group({emailAddress:["",[s.k0.email]]})}get contactPhones(){return this.contactForm.get("contactPhones")}get contactEmails(){return this.contactForm.get("contactEmails")}addPhone(){this.contactPhones.push(this.createPhoneGroup())}removePhone(o){this.contactPhones.removeAt(o)}addEmail(){this.contactEmails.push(this.createEmailGroup())}removeEmail(o){this.contactEmails.removeAt(o)}onSelectCountry(o,n){var a,c;const u=this.contactPhones.at(n);let d=(null==u||null===(a=u.get("phoneNumber"))||void 0===a||null===(a=a.value)||void 0===a||null===(a=a.split(" "))||void 0===a?void 0:a[1])||"";null===(c=u.get("phoneNumber"))||void 0===c||c.setValue((null==o?void 0:o.phoneCode)+" "+d)}}return(e=l).\u0275fac=function(o){return new(o||e)(t.KVO(s.ok),t.KVO(I.F),t.KVO(T.T))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),l})();var f=r(6039),A=r(5970),_=r(177),g=r(1129),N=r(4954),k=r(6279),U=r(1792),B=r(8359),V=r(1413),X=r(152),Y=r(5558);let w=(()=>{var e;class l{constructor(o){this.api=o,this.searchTermSubject=new V.B,this.searchResults$=this.searchTermSubject.pipe((0,X.B)(300),(0,Y.n)(n=>this.performSearch(n)))}search(o){this.searchTermSubject.next(o)}performSearch(o){var n=this;return(0,h.A)(function*(){var a;o=(o=o.trim()).toLowerCase();const c=yield n.api.getContacts({OR:[{name:{contains:o,mode:"insensitive"}}]},null,{page:0,itemsPerPage:10});return(null==c||null===(a=c.success)||void 0===a?void 0:a.data)||[]})()}}return(e=l).\u0275fac=function(o){return new(o||e)(t.KVO(f.i))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),l})();function H(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",8),t.bIt("click",function(n){const a=t.eBV(i).$implicit,c=t.XpG(2);return t.Njj(c.onContactSelect(a,n))}),t.j41(1,"div",9)(2,"div",10),t.nrm(3,"img",11),t.k0s(),t.j41(4,"div",12)(5,"div",13),t.EFF(6),t.k0s(),t.j41(7,"div",14),t.EFF(8),t.k0s()()(),t.nrm(9,"div",15),t.k0s()}if(2&e){const i=l.$implicit;t.R7$(3),t.Y8G("src",(null==i?null:i.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==i?null:i.name," "),t.R7$(2),t.SpI(" ",null==i||null==i.emails?null:i.emails[0]," ")}}function z(e,l){1&e&&(t.j41(0,"div",16),t.EFF(1," No hay resultados "),t.k0s())}function K(e,l){if(1&e&&(t.j41(0,"div",5),t.Z7z(1,H,10,3,"div",6,t.fX1),t.DNE(3,z,2,0,"div",7),t.k0s()),2&e){const i=t.XpG();t.R7$(),t.Dyx(i.searchResults),t.R7$(2),t.Y8G("ngIf",0===i.searchResults.length)}}let Z=(()=>{var e;class l{constructor(o,n){this.renderer=o,this.searchbarService=n,this.contactSelected=new t.bkB,this.searchTerm="",this.dropdownOpen=!1,this.searchResults=[],this.globalClickUnlistener=null,this.searchSubscription=new B.yU}ngOnInit(){this.searchSubscription=this.searchbarService.searchResults$.subscribe(o=>{this.searchResults=o})}onInputClick(o){o.stopPropagation(),this.dropdownOpen||this.openDropdown()}onSearchTermChange(o){this.searchTerm=o,this.searchbarService.search(o)}onContactSelect(o,n){n.stopPropagation(),this.closeDropdown(),this.contactSelected.emit(o)}openDropdown(){this.dropdownOpen=!0,this.attachDocumentClickListener()}closeDropdown(){this.dropdownOpen=!1,this.detachDocumentClickListener()}attachDocumentClickListener(){this.globalClickUnlistener=this.renderer.listen("document","click",o=>{o.target.closest(".agents-searchbar-container")||this.closeDropdown()})}detachDocumentClickListener(){this.globalClickUnlistener&&(this.globalClickUnlistener(),this.globalClickUnlistener=null)}ngOnDestroy(){this.detachDocumentClickListener(),this.searchSubscription.unsubscribe()}}return(e=l).\u0275fac=function(o){return new(o||e)(t.rXU(t.sFG),t.rXU(w))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contacts-searchbar"]],outputs:{contactSelected:"contactSelected"},decls:5,vars:2,consts:[[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar","crm-input-input-searchbar-square","agents-searchbar-container",3,"click"],[1,"fas","fa-search"],["type","text","placeholder","Nombre",3,"ngModelChange","ngModel"],["class","dropdown-options",4,"ngIf"],[1,"dropdown-options"],[1,"crm-item-searchbar-agent-result"],["class","no-results",4,"ngIf"],[1,"crm-item-searchbar-agent-result",3,"click"],[1,"crm-item-searchbar-agent-result-left"],[1,"crm-item-searchbar-agent-result-left-image"],["alt","",3,"src"],[1,"crm-item-searchbar-agent-result-left-info"],[1,"crm-item-searchbar-agent-result-left-info-name"],[1,"crm-item-searchbar-agent-result-left-info-email"],[1,"crm-item-searchbar-agent-result-right"],[1,"no-results"]],template:function(o,n){1&o&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(c){return n.onInputClick(c)}),t.nrm(2,"i",2),t.j41(3,"input",3),t.mxI("ngModelChange",function(c){return t.DH7(n.searchTerm,c)||(n.searchTerm=c),c}),t.bIt("ngModelChange",function(c){return n.onSearchTermChange(c)}),t.k0s(),t.DNE(4,K,4,1,"div",4),t.k0s()()),2&o&&(t.R7$(3),t.R50("ngModel",n.searchTerm),t.R7$(),t.Y8G("ngIf",n.dropdownOpen))},dependencies:[_.bT,s.me,s.BC,s.vS],styles:[".agents-searchbar-container[_ngcontent-%COMP%]{position:relative;cursor:pointer}.dropdown-options[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:100%;z-index:9999;background-color:#fff;padding:8px 0;border-radius:8px;border:1px solid var(--crm-border-light-color);max-height:150px;overflow-y:auto;font-size:14px}.option[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;cursor:pointer;font-size:14px}.option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.no-results[_ngcontent-%COMP%]{padding:8px;color:#888}"]}),l})();var W=r(8147);const J=["fileUploaderManagerComponent"],Q=e=>({visibility:e}),L=e=>({"crm-section-disabled-inputs":e}),v=e=>({"crm-input-input-error":e}),q=e=>({item:e}),tt=()=>({standalone:!0}),P=e=>({number:e});function nt(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1," Introduce un tipo de contacto "),t.k0s())}function ot(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1," Es necesario introducir una referencia "),t.k0s())}function et(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.GENERAL_DATA.NAME_ERROR_REQUIRED")," "))}function it(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",40)(1,"div",41)(2,"div",42),t.nrm(3,"span"),t.k0s(),t.j41(4,"div",43),t.EFF(5),t.k0s()(),t.j41(6,"div",44),t.bIt("click",function(){t.eBV(i);const n=t.XpG(2);return t.Njj(n.onRemoveNationality())}),t.nrm(7,"i",45),t.k0s()()}if(2&e){let i,o;const n=t.XpG(2);t.R7$(3),t.HbH(null==(i=n.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:i.flagClass),t.R7$(2),t.SpI(" ",null==(o=n.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:o.name," ")}}function at(e,l){if(1&e){const i=t.RV6();t.j41(0,"button",46),t.bIt("click",function(n){t.eBV(i);const a=t.XpG(2);return t.Njj(a.onAddNationality(n))}),t.nrm(1,"i",47),t.EFF(2," Seleccionar nacionalidad "),t.k0s()}}function lt(e,l){if(1&e&&t.DNE(0,it,8,3,"div",40)(1,at,3,0,"button",29),2&e){const i=t.XpG();t.vxM(null!=i.contact&&i.contact.nationality?0:1)}}function ct(e,l){if(1&e&&(t.j41(0,"div",48)(1,"div",41)(2,"div",42),t.nrm(3,"span"),t.k0s(),t.j41(4,"div",43),t.EFF(5),t.k0s()()()),2&e){let i,o;const n=t.XpG(2);t.R7$(3),t.HbH(null==(i=n.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:i.flagClass),t.R7$(2),t.SpI(" ",null==(o=n.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:o.name," ")}}function rt(e,l){if(1&e&&t.DNE(0,ct,6,3,"div",48),2&e){const i=t.XpG();t.vxM(null!=i.contact&&i.contact.nationality?0:-1)}}function st(e,l){if(1&e&&(t.j41(0,"option",21),t.EFF(1),t.k0s()),2&e){const i=l.$implicit;t.FS9("value",i.value),t.R7$(),t.JRh(i.label)}}function dt(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.GENERAL_DATA.CONTACT_TYPE_ERROR_REQUIRED")," "))}function pt(e,l){if(1&e&&(t.j41(0,"option",21),t.EFF(1),t.k0s()),2&e){const i=l.$implicit;t.FS9("value",i.value),t.R7$(),t.JRh(i.label)}}function ut(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.GENERAL_DATA.ORIGIN_ERROR_REQUIRED")," "))}function mt(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",40)(1,"div",41)(2,"div",42),t.nrm(3,"span"),t.k0s(),t.j41(4,"div",43),t.EFF(5),t.k0s()(),t.j41(6,"div",44),t.bIt("click",function(){const n=t.eBV(i).$implicit,a=t.XpG(2);return t.Njj(a.onRemoveLanguage(n))}),t.nrm(7,"i",45),t.k0s()()}if(2&e){let i,o;const n=l.$implicit,a=t.XpG(2);t.R7$(3),t.HbH(null==(i=a.getLanguageInfo(n))?null:i.flagClass),t.R7$(2),t.SpI(" ",null==(o=a.getLanguageInfo(n))?null:o.name," ")}}function _t(e,l){if(1&e){const i=t.RV6();t.Z7z(0,mt,8,3,"div",40,t.fX1),t.j41(2,"button",46),t.bIt("click",function(n){t.eBV(i);const a=t.XpG();return t.Njj(a.onAddLanguage(n))}),t.nrm(3,"i",47),t.EFF(4),t.nI1(5,"translate"),t.nI1(6,"translate"),t.k0s()}if(2&e){const i=t.XpG();t.Dyx(null==i.contact?null:i.contact.languages),t.R7$(4),t.SpI(" ",t.i5U(6,3,"text.add_item",t.eq3(6,q,t.bMT(5,1,"text.language")))," ")}}function vt(e,l){if(1&e&&(t.j41(0,"div",48)(1,"div",41)(2,"div",42),t.nrm(3,"span"),t.k0s(),t.j41(4,"div",43),t.EFF(5),t.k0s()()()),2&e){let i,o;const n=l.$implicit,a=t.XpG(2);t.R7$(3),t.HbH(null==(i=a.getLanguageInfo(n))?null:i.flagClass),t.R7$(2),t.SpI(" ",null==(o=a.getLanguageInfo(n))?null:o.name," ")}}function Ct(e,l){if(1&e&&(t.j41(0,"div",18),t.Z7z(1,vt,6,3,"div",48,t.fX1),t.k0s()),2&e){const i=t.XpG();t.R7$(),t.Dyx(null==i.contact?null:i.contact.languages)}}function ht(e,l){if(1&e){const i=t.RV6();t.j41(0,"app-agents-searchbar",49),t.bIt("userSelected",function(n){t.eBV(i);const a=t.XpG();return t.Njj(a.onSelectUser(n))}),t.k0s()}}function ft(e,l){1&e&&(t.j41(0,"div",32),t.EFF(1," No hay usuarios asociados "),t.k0s())}function Ft(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",44),t.bIt("click",function(){t.eBV(i);const n=t.XpG(2).$implicit,a=t.XpG();return t.Njj(a.onRemoveUser(n))}),t.nrm(1,"i",45),t.k0s()}}function Rt(e,l){if(1&e&&(t.j41(0,"div",33)(1,"div",50)(2,"div",51),t.nrm(3,"img",52),t.k0s(),t.j41(4,"div",53)(5,"div",54),t.EFF(6),t.k0s(),t.j41(7,"div",55),t.EFF(8),t.k0s()()(),t.DNE(9,Ft,2,0,"div",56),t.k0s()),2&e){const i=t.XpG().$implicit,o=t.XpG();t.R7$(3),t.Y8G("src",(null==i?null:i.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==i?null:i.name," "),t.R7$(2),t.SpI(" ",null==i?null:i.email," "),t.R7$(),t.vxM(o.disabled?-1:9)}}function Tt(e,l){if(1&e&&t.DNE(0,Rt,10,4,"div",33),2&e){const i=l.$implicit;t.vxM(null!=i&&i.removed?-1:0)}}function gt(e,l){if(1&e){const i=t.RV6();t.j41(0,"app-contacts-searchbar",57),t.bIt("contactSelected",function(n){t.eBV(i);const a=t.XpG();return t.Njj(a.onSelectContact(n))}),t.k0s()}}function Et(e,l){1&e&&(t.j41(0,"div",32),t.EFF(1," No hay contactos asociados "),t.k0s())}function It(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",58)(1,"div",6)(2,"div",59)(3,"select",60),t.mxI("ngModelChange",function(n){t.eBV(i);const a=t.XpG(2).$implicit;return t.DH7(a.relationType,n)||(a.relationType=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(i);const n=t.XpG(2).$implicit,a=t.XpG();return t.Njj(a.onContactRelationTypeChange(n))}),t.j41(4,"option",20),t.EFF(5,"Tipo de relaci\xf3n"),t.k0s(),t.j41(6,"option",61),t.EFF(7,"Responsable de Empresa"),t.k0s(),t.j41(8,"option",62),t.EFF(9,"Empleado"),t.k0s(),t.j41(10,"option",63),t.EFF(11,"Vinculo familiar"),t.k0s(),t.j41(12,"option",64),t.EFF(13,"Amigo/a"),t.k0s(),t.j41(14,"option",65),t.EFF(15,"Representante"),t.k0s(),t.j41(16,"option",66),t.EFF(17,"Abogado"),t.k0s(),t.j41(18,"option",67),t.EFF(19,"Persona autorizada"),t.k0s()()()(),t.j41(20,"div",44),t.bIt("click",function(){t.eBV(i);const n=t.XpG(2).$implicit,a=t.XpG();return t.Njj(a.onRemoveContactRelation(n))}),t.nrm(21,"i",45),t.k0s()()}if(2&e){const i=t.XpG(2).$implicit;t.R7$(3),t.R50("ngModel",i.relationType),t.Y8G("ngModelOptions",t.lJ4(3,tt)),t.R7$(),t.Y8G("value",null)}}function bt(e,l){if(1&e&&(t.j41(0,"div",54),t.EFF(1),t.k0s()),2&e){const i=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",null==i?null:i.relationType," ")}}function At(e,l){if(1&e&&(t.j41(0,"div",33)(1,"div",50)(2,"div",51),t.nrm(3,"img",52),t.k0s(),t.j41(4,"div",53)(5,"div",54),t.EFF(6),t.k0s(),t.j41(7,"div",55),t.EFF(8),t.k0s()()(),t.DNE(9,It,22,4,"div",58)(10,bt,2,1,"div",54),t.k0s()),2&e){const i=t.XpG().$implicit,o=t.XpG();t.R7$(3),t.Y8G("src",(null==i||null==i.contactRelated?null:i.contactRelated.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==i||null==i.contactRelated?null:i.contactRelated.name," "),t.R7$(2),t.SpI(" ",null==i||null==i.contactRelated||null==i.contactRelated.emails?null:i.contactRelated.emails[0]," "),t.R7$(),t.vxM(o.disabled?10:9)}}function Nt(e,l){if(1&e&&t.DNE(0,At,11,4,"div",33),2&e){const i=l.$implicit;t.vxM(null!=i&&i.removed?-1:0)}}function kt(e,l){if(1&e&&(t.j41(0,"div",33)(1,"div",50)(2,"div",51),t.nrm(3,"img",52),t.k0s(),t.j41(4,"div",53)(5,"div",54),t.EFF(6),t.k0s(),t.j41(7,"div",55),t.EFF(8),t.k0s()()()()),2&e){const i=l.$implicit;t.R7$(3),t.Y8G("src",(null==i||null==i.contact?null:i.contact.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==i||null==i.contact?null:i.contact.name," "),t.R7$(2),t.SpI(" ",null==i||null==i.contact||null==i.contact.emails?null:i.contact.emails[0]," ")}}function $t(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",73),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$index,a=t.XpG();return t.Njj(a.onRemovePhone(n))}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.CONTACT_DATA.PHONE_REMOVE")," "))}function Mt(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.CONTACT_DATA.PHONE_ERROR_REQUIRED")," "))}function Ot(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",34)(1,"div",6)(2,"div",7),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"div",68)(6,"div",8)(7,"app-flag-country-selector",69),t.bIt("emitCountrySelected",function(n){const a=t.eBV(i).$index,c=t.XpG();return t.Njj(c.onSelectCountry(n,a))}),t.k0s(),t.nrm(8,"input",70),t.nI1(9,"translate"),t.k0s(),t.j41(10,"div",71),t.DNE(11,$t,3,3,"div",72),t.k0s()(),t.DNE(12,Mt,3,3,"div",12),t.k0s()()}if(2&e){let i;const o=l.$implicit,n=l.$index,a=t.XpG();t.Y8G("formGroup",o),t.R7$(3),t.SpI(" ",t.i5U(4,8,"CONTACT_FORM.CONTACT_DATA.PHONE_LABEL",t.eq3(13,P,n+1))," "),t.R7$(3),t.Y8G("ngClass",t.eq3(15,v,a.isPhoneControlInvalid(n)))("appInputViewMode",a.disabled),t.R7$(),t.Y8G("selectedPhoneNumber",null==o||null==(i=o.get("phoneNumber"))?null:i.value),t.R7$(),t.Y8G("placeholder",t.bMT(9,11,"CONTACT_FORM.CONTACT_DATA.PHONE_PLACEHOLDER")),t.R7$(3),t.vxM(n>0&&!a.disabled?11:-1),t.R7$(),t.Y8G("ngIf",a.isPhoneControlInvalid(n))}}function jt(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",35)(1,"div",58)(2,"button",46),t.bIt("click",function(){t.eBV(i);const n=t.XpG();return t.Njj(n.onAddPhone())}),t.nrm(3,"i",47),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()}2&e&&(t.R7$(4),t.SpI(" ",t.bMT(5,1,"CONTACT_FORM.CONTACT_DATA.ADD_PHONE_BUTTON")," "))}function yt(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",73),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$index,a=t.XpG();return t.Njj(a.onRemoveEmail(n))}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.CONTACT_DATA.EMAIL_REMOVE")," "))}function St(e,l){1&e&&(t.j41(0,"div",39),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CONTACT_FORM.CONTACT_DATA.EMAIL_ERROR_REQUIRED")," "))}function Dt(e,l){if(1&e&&(t.j41(0,"div",34)(1,"div",6)(2,"div",7),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"div",68)(6,"div",8),t.nrm(7,"input",74),t.nI1(8,"translate"),t.k0s(),t.j41(9,"div",71),t.DNE(10,yt,3,3,"div",72),t.k0s()(),t.DNE(11,St,3,3,"div",12),t.k0s()()),2&e){const i=l.$implicit,o=l.$index,n=t.XpG();t.Y8G("formGroup",i),t.R7$(3),t.SpI(" ",t.i5U(4,7,"CONTACT_FORM.CONTACT_DATA.EMAIL_LABEL",t.eq3(12,P,o+1))," "),t.R7$(3),t.Y8G("ngClass",t.eq3(14,v,n.isEmailControlInvalid(o)))("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder",t.bMT(8,10,"CONTACT_FORM.CONTACT_DATA.EMAIL_PLACEHOLDER")),t.R7$(3),t.vxM(o>0&&!n.disabled?10:-1),t.R7$(),t.Y8G("ngIf",n.isEmailControlInvalid(o))}}function Gt(e,l){if(1&e){const i=t.RV6();t.j41(0,"div",35)(1,"div",58)(2,"button",46),t.bIt("click",function(){t.eBV(i);const n=t.XpG();return t.Njj(n.onAddEmail())}),t.nrm(3,"i",47),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()}2&e&&(t.R7$(4),t.SpI(" ",t.bMT(5,1,"CONTACT_FORM.CONTACT_DATA.ADD_EMAIL_BUTTON")," "))}let Lt=(()=>{var e;class l{constructor(o,n,a,c){this.contactService=o,this.api=n,this.utils=a,this.popoverService=c,this.contact=null,this.disabled=!1,this.contactFormOptions=F.R,this.directiveReloadFinished=!1}ngOnInit(){var o;this.contactForm.reset(),null!==(o=this.contact)&&void 0!==o&&o.id?(this.contactService.populateForm(this.contact),this.fileUploaderManager.config={multiple:!1,size:"medium",showRemove:!1,showName:!1,allowUpload:!1,rounded:!0,accept:"image/*",files:[]},this.fileUploaderManager.createProfileFilePic(this.contact),this.disabled&&setTimeout(()=>{this.disabled=!1,setTimeout(()=>{this.disabled=!0,this.directiveReloadFinished=!0})})):this.directiveReloadFinished=!0}get contactForm(){return this.contactService.contactForm}get contactPhonesControls(){return this.contactService.contactPhones.controls}get contactEmailsControls(){return this.contactService.contactEmails.controls}get isCompanyControl(){return this.contactForm.get("isCompany")}onSelectContact(o){var n,a;o=R.cloneDeep(o);const c={id:null,createdAt:"",updatedAt:"",relationType:null,contact:this.contact,contactId:this.contact.id,contactRelated:R.cloneDeep(o),contactRelatedId:o.id,removed:!1,new:!0};null!==(n=this.contact)&&void 0!==n&&n.contactsRelation||(this.contact=this.contact||{},this.contact.contactsRelation=[]);let u=this.contact.contactsRelation.find(d=>{var p,m;return(null===(p=d.contact)||void 0===p?void 0:p.id)===(null===(m=o)||void 0===m?void 0:m.id)});if(u){if(u.removed){const d=this.contact.contactsRelation.findIndex(p=>p.contact.id===o.id);this.contact.contactsRelation[d].removed=!1}}else null===(a=this.contact)||void 0===a||a.contactsRelation.push(c)}onRemoveContactRelation(o){const n=this.contact.contactsRelation.findIndex(a=>a.id===o.id);this.contact.contactsRelation[n].removed=!0}onContactRelationTypeChange(o){const n=this.contact.contactsRelation.findIndex(a=>a.id===o.id);this.contact.contactsRelation[n].edited=!0}onSelectUser(o){var n;if(null!==(n=this.contact)&&void 0!==n&&n.responsableUsers||(this.contact=this.contact||{},this.contact.responsableUsers=[]),this.contact.responsableUsers.find(a=>a.id===o.id)){if(o.removed){const a=this.contact.responsableUsers.findIndex(c=>c.id===o.id);this.contact.responsableUsers[a].removed=!1}}else o.new=!0,this.contact.responsableUsers.push(o)}onRemoveUser(o){const n=this.contact.responsableUsers.findIndex(a=>a.id===o.id);this.contact.responsableUsers[n].removed=!0}onAddPhone(){this.contactService.addPhone()}onRemovePhone(o){this.contactService.removePhone(o)}onAddEmail(){this.contactService.addEmail()}onRemoveEmail(o){this.contactService.removeEmail(o)}onSelectCountry(o,n){this.contactService.onSelectCountry(o,n)}isControlInvalid(o){const n=this.contactForm.get(o);return!(!n||!n.invalid||!n.dirty&&!n.touched)}isPhoneControlInvalid(o){var n;const a=null===(n=this.contactPhonesControls[o])||void 0===n?void 0:n.get("phoneNumber");return!(!a||!a.invalid||!a.dirty&&!a.touched)}isEmailControlInvalid(o){var n;const a=null===(n=this.contactEmailsControls[o])||void 0===n?void 0:n.get("emailAddress");return!(!a||!a.invalid||!a.dirty&&!a.touched)}getPhoneErrorMessage(o){const n=this.contactPhonesControls[o].get("phoneNumber");if(null!=n&&n.errors){if(n.errors.required)return"El n\xfamero de tel\xe9fono es requerido";if(n.errors.pattern)return"El n\xfamero de tel\xe9fono debe contener solo d\xedgitos"}return""}getEmailErrorMessage(o){const n=this.contactEmailsControls[o].get("emailAddress");if(null!=n&&n.errors){if(n.errors.required)return"El correo electr\xf3nico es requerido";if(n.errors.email)return"Introduce un correo electr\xf3nico v\xe1lido"}return""}getLanguageInfo(o){return this.utils.getLanguageInfo(o)}getCountryInfo(o){return this.utils.getCountryInfo(o)}onAddLanguage(o){var n=this;return(0,h.A)(function*(){var a,c;const u={languageSelector:!0,showCountryCode:!1,selectedCodes:null===(a=n.contact)||void 0===a?void 0:a.languages},d=yield n.popoverService.onShowCountrySelectorPopover(o,u);var p,m;null!=d&&null!==(c=d.data)&&void 0!==c&&c.country&&(n.contact=n.contact||{},n.contact.languages=(null===(p=n.contact)||void 0===p?void 0:p.languages)||[],n.contact.languages.push(null===(m=d.data)||void 0===m||null===(m=m.country)||void 0===m?void 0:m.code))})()}onRemoveLanguage(o){this.contact.languages=this.contact.languages.filter(n=>n!==o)}onAddNationality(o){var n=this;return(0,h.A)(function*(){var a,c;const u={languageSelector:!1,showCountryCode:!1,selectedCodes:[null===(a=n.contact)||void 0===a?void 0:a.nationality]},d=yield n.popoverService.onShowCountrySelectorPopover(o,u);var p;null!=d&&null!==(c=d.data)&&void 0!==c&&c.country&&(n.contact=n.contact||{},console.log("popover",d),n.contact.nationality=null===(p=d.data)||void 0===p||null===(p=p.country)||void 0===p?void 0:p.code),console.log("contact",n.contact)})()}onRemoveNationality(){this.contact.nationality=null}}return(e=l).\u0275fac=function(o){return new(o||e)(t.rXU(b),t.rXU(f.i),t.rXU(T.T),t.rXU(A.m))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contact-form"]],viewQuery:function(o,n){if(1&o&&t.GBs(J,7),2&o){let a;t.mGM(a=t.lsd())&&(n.fileUploaderManager=a.first)}},inputs:{contact:"contact",disabled:"disabled"},decls:156,vars:110,consts:[["fileUploaderManagerComponent",""],[1,"crm-boxes-user-create",3,"formGroup","ngStyle"],[1,"crm-box","crm-section"],[1,"crm-section-title"],[1,"crm-section-inputs",3,"ngClass"],[1,"crm-section-inputs-double-input"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass","appInputViewMode"],["formControlName","type"],["value","particular","default",""],["value","empresa"],["class","crm-input-error",4,"ngIf"],["type","text","placeholder","Referencia","formControlName","reference"],["type","text","formControlName","name",3,"placeholder"],[1,"crm-input-input",3,"appInputViewMode"],["type","text","formControlName","alias",3,"placeholder"],["type","text","formControlName","dniPassport",3,"placeholder"],[1,"crm-section-items"],["formControlName","contactType"],["disabled","","selected","",3,"value"],[3,"value"],["formControlName","origin"],["type","date","formControlName","birthdate",3,"placeholder"],["formControlName","gender"],["value","male"],["value","female"],["value","other"],[1,"crm-input","crm-input-medium"],["type","button",1,"crm-button-secondary","crm-button-secondary-primary"],[1,"crm-section-small-title","crm-section-margin-top-small"],[1,"crm-section-vertical-gap-8"],[1,"crm-text"],[1,"crm-item-associated-user"],[3,"formGroup"],[1,"crm-section-buttons-right"],["type","text","formControlName","urlFacebook",3,"placeholder"],["type","text","formControlName","urlInstagram",3,"placeholder"],["type","text","formControlName","urlLinkedIn",3,"placeholder"],[1,"crm-input-error"],[1,"crm-item-option","crm-item-option-lang","edit"],[1,"crm-item-option-left"],[1,"crm-item-option-flag"],[1,"crm-item-option-label"],[1,"crm-item-option-remove",3,"click"],[1,"fas","fa-trash"],["type","button",1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fas","fa-add"],[1,"crm-item-option","crm-item-option-lang"],[3,"userSelected"],[1,"crm-item-associated-user-left"],[1,"crm-item-associated-user-left-image"],["alt","",3,"src"],[1,"crm-item-associated-user-left-info"],[1,"crm-item-associated-user-left-info-name"],[1,"crm-item-associated-user-left-info-email"],[1,"crm-item-option-remove"],[3,"contactSelected"],[1,"crm-section-buttons-group"],[1,"crm-input-input","crm-input-input-invisible"],[2,"text-align","right",3,"ngModelChange","ngModel","ngModelOptions"],["value","company_responsible"],["value","employee"],["value","family_link"],["value","friend"],["value","representative"],["value","lawyer"],["value","authorized_person"],[1,"crm-input-input-and-icon"],[3,"emitCountrySelected","selectedPhoneNumber"],["type","text","formControlName","phoneNumber",3,"placeholder"],[1,"crm-input-input-and-icon-right"],[1,"crm-text","crm-text-underline","crm-text-underline-red"],[1,"crm-text","crm-text-underline","crm-text-underline-red",3,"click"],["type","email","formControlName","emailAddress",3,"placeholder"]],template:function(o,n){1&o&&(t.j41(0,"form",1)(1,"div",2)(2,"div",3),t.EFF(3," Foto de perfil "),t.k0s(),t.nrm(4,"app-file-uploader-manager",null,0),t.j41(6,"div",3),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.j41(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7),t.EFF(13," Tipo "),t.k0s(),t.j41(14,"div",8)(15,"select",9)(16,"option",10),t.EFF(17,"Particular"),t.k0s(),t.j41(18,"option",11),t.EFF(19,"Empresa"),t.k0s()()(),t.DNE(20,nt,2,0,"div",12),t.k0s(),t.j41(21,"div",6)(22,"div",7),t.EFF(23," Referencia "),t.k0s(),t.j41(24,"div",8),t.nrm(25,"input",13),t.k0s(),t.DNE(26,ot,2,0,"div",12),t.k0s()(),t.j41(27,"div",5)(28,"div",6)(29,"div",7),t.EFF(30),t.k0s(),t.j41(31,"div",8),t.nrm(32,"input",14),t.k0s(),t.DNE(33,et,3,3,"div",12),t.k0s(),t.j41(34,"div",6)(35,"div",7),t.EFF(36),t.k0s(),t.j41(37,"div",15),t.nrm(38,"input",16),t.k0s()()(),t.j41(39,"div",5)(40,"div",6)(41,"div",7),t.EFF(42),t.k0s(),t.j41(43,"div",15),t.nrm(44,"input",17),t.k0s()(),t.j41(45,"div",6)(46,"div",7),t.EFF(47," Nacionalidad "),t.k0s(),t.j41(48,"div",18),t.DNE(49,lt,2,1)(50,rt,1,1),t.k0s()()(),t.j41(51,"div",5)(52,"div",6)(53,"div",7),t.EFF(54),t.nI1(55,"translate"),t.k0s(),t.j41(56,"div",8)(57,"select",19)(58,"option",20),t.EFF(59,"Selecciona un tipo de contacto"),t.k0s(),t.Z7z(60,st,2,2,"option",21,t.fX1),t.k0s()(),t.DNE(62,dt,3,3,"div",12),t.k0s(),t.j41(63,"div",6)(64,"div",7),t.EFF(65),t.nI1(66,"translate"),t.k0s(),t.j41(67,"div",8)(68,"select",22)(69,"option",20),t.EFF(70,"Selecciona un origen"),t.k0s(),t.Z7z(71,pt,2,2,"option",21,t.fX1),t.k0s()(),t.DNE(73,ut,3,3,"div",12),t.k0s()(),t.j41(74,"div",5)(75,"div",6)(76,"div",7),t.EFF(77),t.nI1(78,"translate"),t.k0s(),t.j41(79,"div",15),t.nrm(80,"input",23),t.nI1(81,"translate"),t.k0s()(),t.j41(82,"div",6)(83,"div",7),t.EFF(84),t.nI1(85,"translate"),t.k0s(),t.j41(86,"div",15)(87,"select",24)(88,"option",20),t.EFF(89,"Selecciona un g\xe9nero"),t.k0s(),t.j41(90,"option",25),t.EFF(91),t.nI1(92,"translate"),t.k0s(),t.j41(93,"option",26),t.EFF(94),t.nI1(95,"translate"),t.k0s(),t.j41(96,"option",27),t.EFF(97),t.nI1(98,"translate"),t.k0s()()()()(),t.j41(99,"div",28)(100,"div",7),t.EFF(101," Idiomas "),t.k0s(),t.j41(102,"div",18),t.DNE(103,_t,7,8,"button",29)(104,Ct,3,0,"div",18),t.k0s()()(),t.j41(105,"div",30),t.EFF(106),t.nI1(107,"translate"),t.k0s(),t.DNE(108,ht,1,0,"app-agents-searchbar"),t.j41(109,"div",31),t.DNE(110,ft,2,0,"div",32),t.Z7z(111,Tt,1,1,null,null,t.fX1),t.k0s(),t.j41(113,"div",30),t.EFF(114," Contactos asociados "),t.k0s(),t.DNE(115,gt,1,0,"app-contacts-searchbar"),t.j41(116,"div",31),t.DNE(117,Et,2,0,"div",32),t.Z7z(118,Nt,1,1,null,null,t.fX1),t.Z7z(120,kt,9,3,"div",33,t.fX1),t.k0s()(),t.j41(122,"div",2)(123,"div",3),t.EFF(124),t.nI1(125,"translate"),t.k0s(),t.j41(126,"div",4),t.Z7z(127,Ot,13,17,"div",34,t.fX1),t.DNE(129,jt,6,3,"div",35),t.Z7z(130,Dt,12,16,"div",34,t.fX1),t.DNE(132,Gt,6,3,"div",35),t.j41(133,"div",5)(134,"div",6)(135,"div",7),t.EFF(136),t.nI1(137,"translate"),t.k0s(),t.j41(138,"div",15),t.nrm(139,"input",36),t.nI1(140,"translate"),t.k0s()(),t.j41(141,"div",6)(142,"div",7),t.EFF(143),t.nI1(144,"translate"),t.k0s(),t.j41(145,"div",15),t.nrm(146,"input",37),t.nI1(147,"translate"),t.k0s()()(),t.j41(148,"div",6)(149,"div",7),t.EFF(150),t.nI1(151,"translate"),t.k0s(),t.j41(152,"div",15),t.nrm(153,"input",38),t.nI1(154,"translate"),t.k0s()()()()(),t.nrm(155,"br")),2&o&&(t.Y8G("formGroup",n.contactForm)("ngStyle",t.eq3(94,Q,n.directiveReloadFinished?"visible":"hidden")),t.R7$(7),t.SpI(" ",t.bMT(8,60,"CONTACT_FORM.GENERAL_DATA.TITLE")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(96,L,n.disabled)),t.R7$(5),t.Y8G("ngClass",t.eq3(98,v,n.isControlInvalid("type")))("appInputViewMode",n.disabled),t.R7$(6),t.Y8G("ngIf",n.isControlInvalid("type")),t.R7$(4),t.Y8G("ngClass",t.eq3(100,v,n.isControlInvalid("reference")))("appInputViewMode",n.disabled),t.R7$(2),t.Y8G("ngIf",n.isControlInvalid("reference")),t.R7$(4),t.SpI(" ","empresa"===n.contactForm.get("type").value?"Denominaci\xf3n social":"Nombre y apellidos"," "),t.R7$(),t.Y8G("ngClass",t.eq3(102,v,n.isControlInvalid("name")))("appInputViewMode",n.disabled),t.R7$(),t.FS9("placeholder","empresa"===n.contactForm.get("type").value?"Denominaci\xf3n social":"Nombre y apellidos"),t.R7$(),t.Y8G("ngIf",n.isControlInvalid("name")),t.R7$(3),t.SpI(" ","empresa"===n.contactForm.get("type").value?"Nombre comercial":"Alias"," "),t.R7$(),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder","empresa"===n.contactForm.get("type").value?"Nombre comercial":"Alias"),t.R7$(4),t.SpI(" ","empresa"===n.contactForm.get("type").value?"CIF":"Dni/Pasaporte"," "),t.R7$(),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder","empresa"===n.contactForm.get("type").value?"CIF":"Dni/Pasaporte"),t.R7$(5),t.vxM(n.disabled?50:49),t.R7$(5),t.SpI(" ",t.bMT(55,62,"CONTACT_FORM.GENERAL_DATA.CONTACT_TYPE_LABEL")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(104,v,n.isControlInvalid("contactType")))("appInputViewMode",n.disabled),t.R7$(2),t.Y8G("value",null),t.R7$(2),t.Dyx(n.contactFormOptions.contactType),t.R7$(2),t.Y8G("ngIf",n.isControlInvalid("contactType")),t.R7$(3),t.SpI(" ",t.bMT(66,64,"CONTACT_FORM.GENERAL_DATA.ORIGIN_LABEL")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(106,v,n.isControlInvalid("origin")))("appInputViewMode",n.disabled),t.R7$(2),t.Y8G("value",null),t.R7$(2),t.Dyx(n.contactFormOptions.origin),t.R7$(2),t.Y8G("ngIf",n.isControlInvalid("origin")),t.R7$(4),t.SpI(" ",t.bMT(78,66,"CONTACT_FORM.GENERAL_DATA.BIRTHDATE_LABEL")," "),t.R7$(2),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder",t.bMT(81,68,"CONTACT_FORM.GENERAL_DATA.BIRTHDATE_PLACEHOLDER")),t.R7$(4),t.SpI(" ",t.bMT(85,70,"CONTACT_FORM.GENERAL_DATA.GENDER_LABEL")," "),t.R7$(2),t.Y8G("appInputViewMode",n.disabled),t.R7$(2),t.Y8G("value",null),t.R7$(3),t.JRh(t.bMT(92,72,"CONTACT_FORM.GENERAL_DATA.GENDER_OPTION_MALE")),t.R7$(3),t.JRh(t.bMT(95,74,"CONTACT_FORM.GENERAL_DATA.GENDER_OPTION_FEMALE")),t.R7$(3),t.JRh(t.bMT(98,76,"CONTACT_FORM.GENERAL_DATA.GENDER_OPTION_OTHER")),t.R7$(6),t.vxM(n.disabled?104:103),t.R7$(3),t.SpI(" ",t.bMT(107,78,"CONTACT_FORM.ASSOCIATED_USERS.TITLE")," "),t.R7$(2),t.vxM(n.disabled?-1:108),t.R7$(2),t.vxM(0===(null==n.contact||null==n.contact.responsableUsers?null:n.contact.responsableUsers.length)?110:-1),t.R7$(),t.Dyx(null==n.contact?null:n.contact.responsableUsers),t.R7$(4),t.vxM(n.disabled?-1:115),t.R7$(2),t.vxM(0===(null==n.contact||null==n.contact.contactsRelation?null:n.contact.contactsRelation.length)&&0===(null==n.contact||null==n.contact.contactsRelated?null:n.contact.contactsRelated.length)?117:-1),t.R7$(),t.Dyx(null==n.contact?null:n.contact.contactsRelation),t.R7$(2),t.Dyx(null==n.contact?null:n.contact.contactsRelated),t.R7$(4),t.SpI(" ",t.bMT(125,80,"CONTACT_FORM.CONTACT_DATA.TITLE")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(108,L,n.disabled)),t.R7$(),t.Dyx(n.contactPhonesControls),t.R7$(2),t.vxM(n.disabled?-1:129),t.R7$(),t.Dyx(n.contactEmailsControls),t.R7$(2),t.vxM(n.disabled?-1:132),t.R7$(4),t.SpI(" ",t.bMT(137,82,"CONTACT_FORM.CONTACT_DATA.URL_FACEBOOK_LABEL")," "),t.R7$(2),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder",t.bMT(140,84,"CONTACT_FORM.CONTACT_DATA.URL_FACEBOOK_PLACEHOLDER")),t.R7$(4),t.SpI(" ",t.bMT(144,86,"CONTACT_FORM.CONTACT_DATA.URL_INSTAGRAM_LABEL")," "),t.R7$(2),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder",t.bMT(147,88,"CONTACT_FORM.CONTACT_DATA.URL_INSTAGRAM_PLACEHOLDER")),t.R7$(4),t.SpI(" ",t.bMT(151,90,"CONTACT_FORM.CONTACT_DATA.URL_LINKEDIN_LABEL")," "),t.R7$(2),t.Y8G("appInputViewMode",n.disabled),t.R7$(),t.Y8G("placeholder",t.bMT(154,92,"CONTACT_FORM.CONTACT_DATA.URL_LINKEDIN_PLACEHOLDER")))},dependencies:[_.YU,_.bT,_.B3,s.qT,s.xH,s.y7,s.me,s.wz,s.BC,s.cb,s.vS,s.j4,s.JD,g.Z,N.R,k.F,U.M,Z,W.D9]}),l})()},7294:(x,E,r)=>{r.d(E,{J:()=>A});var h=r(177),F=r(9417),R=r(6812),t=r(68),s=r(8147),I=r(6279),T=r(9465),b=r(2306),f=r(3953);let A=(()=>{var _;class g{}return(_=g).\u0275fac=function(k){return new(k||_)},_.\u0275mod=f.$C({type:_}),_.\u0275inj=f.G2t({imports:[h.MD,F.YN,F.X1,R.u,t.k,s.h,I.F,T.bv,b.T]}),g})()}}]);