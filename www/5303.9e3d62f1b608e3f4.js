"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5303],{5303:(Gt,F,c)=>{c.r(F),c.d(F,{ContactDetailsPageModule:()=>St});var m=c(177),_=c(9417),f=c(9465),v=c(5188),d=c(467),I=c(7376),t=c(3953),P=c(4501),R=c(9333),g=c(8397),k=c(6552),D=c(1213),b=c(2606),E=c(8433),O=c(5419),T=c(6039),S=c(3837),C=c(8147);const A=["contactForm"];function M(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.onSaveContact())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&e&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"CONTACT_DETAILS_INFO.SAVE_CONTACT")," "))}function G(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",9),t.bIt("click",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.onEditContact())}),t.nrm(1,"i",10),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&e&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"CONTACT_DETAILS_INFO.EDIT_CONTACT")," "))}let U=(()=>{var e;class a{constructor(i,n,l){this.api=i,this.toastService=n,this.contactsService=l,this.contact=null,this.saveContact=new t.bkB,this.editing=!1}ngOnInit(){}onEditContact(){this.editing=!0,this.contactForm.fileUploaderManager.setEditingMode(!0)}onSaveContact(){var i=this;return(0,d.A)(function*(){var n;(yield i.contactsService.createOrUpdateContactFromForm(i.contactForm,null===(n=i.contact)||void 0===n?void 0:n.id))&&(i.editing=!1,i.contactForm.fileUploaderManager.setEditingMode(!1),i.saveContact.emit())})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(T.i),t.rXU(g.f),t.rXU(R.F))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contact-details-info"]],viewQuery:function(i,n){if(1&i&&t.GBs(A,5),2&i){let l;t.mGM(l=t.lsd())&&(n.contactForm=l.first)}},inputs:{contact:"contact"},outputs:{saveContact:"saveContact"},decls:8,vars:3,consts:[["contactForm",""],[1,"crm-header-modal","crm-header-modal-empty","details"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary"],[1,"crm-button-secondary"],[1,"crm-boxes-user-create"],[2,"width","100%",3,"contact","disabled"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fa","fa-check"],[1,"crm-button-secondary",3,"click"],[1,"fa","fa-edit"]],template:function(i,n){1&i&&(t.j41(0,"div",1),t.nrm(1,"div"),t.j41(2,"div",2),t.DNE(3,M,4,3,"button",3)(4,G,4,3,"button",4),t.k0s()(),t.j41(5,"div",5),t.nrm(6,"app-contact-form",6,0),t.k0s()),2&i&&(t.R7$(3),t.vxM(n.editing?3:4),t.R7$(3),t.Y8G("contact",n.contact)("disabled",!n.editing))},dependencies:[S.q,C.D9]}),a})();var X=c(6968),N=c(7380),Y=c(363),B=c(1852);const x=e=>({item:e}),V=(e,a)=>({"background-color":e,color:a}),J=e=>({mode:"contact",contactId:e,itemsPerPage:5});function w(e,a){if(1&e&&(t.j41(0,"div",33),t.EFF(1),t.k0s()),2&e){const o=t.XpG().$implicit;t.R7$(),t.SpI(" Propiedad ",null==o||null==o.mainProperty?null:o.mainProperty.reference," ")}}function z(e,a){if(1&e&&(t.j41(0,"div",42),t.EFF(1),t.k0s()),2&e){const o=t.XpG().$implicit,i=t.XpG();t.Y8G("ngStyle",t.l_i(2,V,i.utils.hexToRgba(null==o||null==o.currentPipelineStep?null:o.currentPipelineStep.color,.1),null==o||null==o.currentPipelineStep?null:o.currentPipelineStep.color)),t.R7$(),t.SpI(" ",null==o||null==o.currentPipelineStep?null:o.currentPipelineStep.text," ")}}function H(e,a){1&e&&(t.j41(0,"div",43),t.EFF(1," fill "),t.k0s())}function L(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",27),t.bIt("click",function(){const n=t.eBV(o).$implicit,l=t.XpG();return t.Njj(l.onOpenOperation(n))}),t.j41(1,"div",28)(2,"div",29),t.nrm(3,"img",30),t.k0s(),t.j41(4,"div",31)(5,"div",32),t.EFF(6),t.k0s(),t.DNE(7,w,2,1,"div",33),t.k0s()(),t.j41(8,"div",34)(9,"div",35)(10,"div",36)(11,"div",37),t.EFF(12,"Fecha de creaci\xf3n"),t.k0s(),t.j41(13,"div",38)(14,"div"),t.EFF(15),t.nI1(16,"date"),t.k0s()()(),t.j41(17,"div",36)(18,"div",37),t.EFF(19,"Responsable"),t.k0s(),t.j41(20,"div",38)(21,"div",39)(22,"div",40),t.EFF(23),t.k0s()()()()()(),t.j41(24,"div",41),t.DNE(25,z,2,5,"div",42)(26,H,2,0,"div",43),t.k0s()()}if(2&e){const o=a.$implicit,i=a.$index;t.R7$(3),t.Y8G("src","assets/images/building.png",t.B4B),t.R7$(3),t.SpI(" Operaci\xf3n ",i+1," "),t.R7$(),t.vxM(null!=o&&o.mainProperty?7:-1),t.R7$(8),t.SpI(" ",t.i5U(16,6,o.createdAt,"dd/MM/yyyy")," "),t.R7$(8),t.SpI(" ",(null==o||null==o.responsible?null:o.responsible.name)||(null==o||null==o.createdBy?null:o.createdBy.name)," "),t.R7$(2),t.vxM(null!=o&&null!=o.currentPipelineStep&&o.currentPipelineStep.text?25:26)}}function K(e,a){if(1&e&&(t.j41(0,"div"),t.nrm(1,"app-autolead-email-list-viewer",44),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.Y8G("options",t.eq3(1,J,null==o.contact?null:o.contact.id))}}function Q(e,a){1&e&&t.nrm(0,"i",19)}function Z(e,a){1&e&&t.nrm(0,"i",20)}function W(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",21)(1,"div",45)(2,"button",46),t.nrm(3,"i",47),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"button",48),t.nrm(7,"i",49),t.EFF(8),t.nI1(9,"translate"),t.k0s(),t.j41(10,"button",48),t.nrm(11,"i",50),t.EFF(12),t.nI1(13,"translate"),t.k0s(),t.j41(14,"button",48),t.nrm(15,"i",51),t.EFF(16),t.nI1(17,"translate"),t.k0s()(),t.j41(18,"app-activity-creation-block",52),t.bIt("onNoteCreated",function(n){t.eBV(o);const l=t.XpG();return t.Njj(l.onNoteCreated(n))}),t.k0s()()}if(2&e){const o=t.XpG();t.R7$(4),t.SpI(" ",t.bMT(5,5,"text.note")," "),t.R7$(4),t.SpI(" ",t.bMT(9,7,"text.visit")," "),t.R7$(4),t.SpI(" ",t.bMT(13,9,"text.mail")," "),t.R7$(4),t.SpI(" ",t.bMT(17,11,"text.task")," "),t.R7$(2),t.Y8G("options",o.creationBlockActivityCreationOptions)}}let q=(()=>{var e;class a{constructor(i,n,l,s,r,p){this.modalService=i,this.api=n,this.router=l,this.toast=s,this.byvaroState=r,this.utils=p,this.operationIdToOpenFromUrl=null,this.operationActivityData={notes:[],operationHistorics:[],operation:null},this.operations=[],this.collapsedActivityAdder=!1,this.creationBlockActivityCreationOptions={type:"note",activityType:"contact",contactId:null,operationId:null}}ngOnChanges(){this.contact&&(this.getUserInfo(),this.getOperations(),this.getUserNotes(),this.creationBlockActivityCreationOptions.contactId=this.contact.id)}onOpenOperation(i){var n=this;return(0,d.A)(function*(){yield(yield n.modalService.showOperationModal(null==i?void 0:i.id)).onDidDismiss(),n.getOperations()})()}onNoteCreated(i){console.log("note created",i),this.getUserNotes()}onAddOperation(){var i=this;return(0,d.A)(function*(){var n;const s=yield(yield i.modalService.showOperationPropertiesSearchModal()).onDidDismiss();null!=s&&null!==(n=s.data)&&void 0!==n&&n.checkedProperties&&i.createOperation(s.data.checkedProperties)})()}getUserInfo(){this.byvaroState.getState().subscribe(i=>{this.currentUser=i.user,this.userAgency=i.agency,this.userPromoter=i.promoter})}getUserNotes(){var i=this;return(0,d.A)(function*(){var n;const l=yield i.api.getNote({contactId:{equals:i.contact.id}},{field:"createdAt",order:"desc"},null,{createdBy:{apply:!0,filter:null,onlyCount:!1}});i.operationActivityData.notes=(null===(n=l.success)||void 0===n?void 0:n.data)||[]})()}getPipelines(){var i=this;return(0,d.A)(function*(){var n;return(null===(n=(yield i.api.getPipelines({},null,null,{steps:{apply:!0,filter:null,onlyCount:!1}})).success)||void 0===n?void 0:n.data)||[]})()}getOperations(){var i=this;return(0,d.A)(function*(){var n;const l=yield i.api.getOperation({contactId:{equals:i.contact.id}},null,null,{contact:{apply:!0,filter:null,onlyCount:!1},createdBy:{apply:!0,filter:null,onlyCount:!1},responsible:{apply:!0,filter:null,onlyCount:!1},mainProperty:{apply:!0,filter:null,onlyCount:!1},currentPipeline:{apply:!0,filter:null,onlyCount:!1},currentPipelineStep:{apply:!0,filter:null,onlyCount:!1},promotions:{apply:!0,filter:null,onlyCount:!1},selectedProperties:{apply:!0,filter:null,onlyCount:!1},notes:{apply:!0,filter:null,onlyCount:!1},operations:{apply:!0,filter:null,onlyCount:!1}});if(i.operations=(null===(n=l.success)||void 0===n?void 0:n.data)||[],i.operationIdToOpenFromUrl){const s=i.operations.find(r=>r.id===i.operationIdToOpenFromUrl);s&&(i.onOpenOperation(s),i.operationIdToOpenFromUrl=null)}})()}createOperation(i){var n=this;return(0,d.A)(function*(){var l,s,r,p;let u=null,j=yield n.getPipelines();j.length>0&&(u=j.find(y=>"operaciones"===y.title),u.steps=(0,I.sortBy)(u.steps,"order"));const At={operationType:n.currentUser.accountType,contactId:n.contact.id,promoterId:null===(l=n.userPromoter)||void 0===l?void 0:l.id,agencyId:null===(s=n.userAgency)||void 0===s?void 0:s.id,createdById:n.currentUser.id,responsibleId:n.currentUser.id,currentPipelineId:null===(r=u)||void 0===r?void 0:r.id,currentPipelineStepId:u?u.steps[0].id:null},h=yield n.api.createOperation(At),$=null===(p=h.success)||void 0===p?void 0:p.data,Mt=i.map(y=>y.id);yield n.api.linkPropertiesToOperation($.id,Mt),yield n.setMainProperty(i[0].id,$.id),n.toast.showToast(h.success?{text:"Operaci\xf3n creada correctamente",theme:"success",time:2e3}:{text:"Error al crear la operaci\xf3n. "+h.error.errorMessage,theme:"red",time:2e3}),n.getOperations()})()}setMainProperty(i,n){var l=this;return(0,d.A)(function*(){yield l.api.updateOperationById(n,{mainPropertyId:i})})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(X.M),t.rXU(T.i),t.rXU(v.Ix),t.rXU(g.f),t.rXU(D.c),t.rXU(k.T))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contact-details-operations"]],inputs:{contact:"contact",operationIdToOpenFromUrl:"operationIdToOpenFromUrl"},features:[t.OA$],decls:45,vars:15,consts:[[1,"crm-opp-contact-screen"],[1,"crm-opp-contact-screen-left"],[1,"crm-section","crm-section-padding","big-padding"],[1,"crm-header-icon","no-padding","no-line","no-background"],[1,"crm-header-icon-left"],[1,"crm-square-icon"],[1,"fa-solid","fa-bullseye"],[1,"crm-header-icon-title"],[1,"crm-header-icon-right"],[1,"crm-button",3,"click"],[1,"fas","fa-plus"],[1,"crm-section-operations"],[1,"crm-item-operation"],[1,"crm-opp-contact-screen-right"],[1,"crm-section","crm-section-padding"],[1,"crm-section"],[1,"crm-header-icon","crm-header-icon-less-padding","no-line","no-padding"],[1,"fa-solid","fa-add"],[1,"crm-button-icon-solo",3,"click"],[1,"fas","fa-chevron-up"],[1,"fas","fa-chevron-down"],[1,"crm-activity"],[1,"crm-horizontal-separator"],[1,"fa-solid","fa-clock-rotate-left"],[1,"crm-button-icon-solo"],[1,"fas","fa-filter"],[3,"data"],[1,"crm-item-operation",3,"click"],[1,"crm-item-operation-left"],[1,"crm-item-operation-left-image"],["alt","",3,"src"],[1,"crm-item-operation-left-info"],[1,"crm-item-operation-left-info-promotion"],[1,"crm-item-operation-left-info-property"],[1,"crm-item-operation-center"],[1,"crm-block-info-horizontal"],[1,"crm-info"],[1,"crm-info-title"],[1,"crm-info-content"],[1,"crm-item-reference"],[1,"crm-item-reference-text"],[1,"crm-item-operation-right"],[1,"crm-item-chip","crm-item-chip-warn",3,"ngStyle"],[1,"crm-item-chip","crm-item-chip-warn",2,"visibility","hidden"],[3,"options"],[1,"crm-activity-selector"],[1,"crm-button","crm-button-center"],[1,"fas","fa-note-sticky"],[1,"crm-button-secondary","crm-button-secondary-primary","crm-button-center"],[1,"fas","fa-calendar-alt"],[1,"fas","fa-envelope"],[1,"fas","fa-check"],[3,"onNoteCreated","options"]],template:function(i,n){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t.nrm(6,"i",6),t.k0s(),t.j41(7,"div",7),t.EFF(8),t.nI1(9,"translate"),t.k0s()(),t.j41(10,"div",8)(11,"button",9),t.bIt("click",function(){return n.onAddOperation()}),t.nrm(12,"i",10),t.EFF(13),t.nI1(14,"translate"),t.nI1(15,"translate"),t.k0s()()(),t.j41(16,"div",11),t.Z7z(17,L,27,9,"div",12,t.fX1),t.k0s(),t.DNE(19,K,2,3,"div"),t.k0s()(),t.j41(20,"div",13)(21,"div",14)(22,"div",15)(23,"div",16)(24,"div",4)(25,"div",5),t.nrm(26,"i",17),t.k0s(),t.j41(27,"div",7),t.EFF(28," A\xf1adir actividad "),t.k0s()(),t.j41(29,"div",8)(30,"button",18),t.bIt("click",function(){return n.collapsedActivityAdder=!n.collapsedActivityAdder}),t.DNE(31,Q,1,0,"i",19)(32,Z,1,0,"i",20),t.k0s()()(),t.DNE(33,W,19,13,"div",21),t.nrm(34,"div",22),t.j41(35,"div",16)(36,"div",4)(37,"div",5),t.nrm(38,"i",23),t.k0s(),t.j41(39,"div",7),t.EFF(40," Historial "),t.k0s()(),t.j41(41,"div",8)(42,"button",24),t.nrm(43,"i",25),t.k0s()()(),t.nrm(44,"app-operation-activity-block",26),t.k0s()()()()),2&i&&(t.R7$(8),t.SpI(" ",t.bMT(9,6,"text.operations")," "),t.R7$(5),t.SpI(" ",t.i5U(15,10,"text.add_item",t.eq3(13,x,t.bMT(14,8,"text.operation")))," "),t.R7$(4),t.Dyx(n.operations),t.R7$(2),t.vxM(n.contact?19:-1),t.R7$(12),t.vxM(n.collapsedActivityAdder?31:32),t.R7$(2),t.vxM(n.collapsedActivityAdder?-1:33),t.R7$(11),t.Y8G("data",n.operationActivityData))},dependencies:[m.B3,N.$,Y.T,B.n,m.vh,C.D9]}),a})();const tt=e=>({"no-padding":e}),nt=(e,a,o)=>({startDate:e,destinataryEmail:a,senderEmail:o}),ot=e=>({filter:e}),et=(e,a)=>({title:"Listado de correos",connectionId:e,filter:a,itemsPerPage:100}),it=e=>({father:"contact",operationId:e});function at(e,a){if(1&e&&(t.j41(0,"div",20)(1,"div",21)(2,"div",22),t.nrm(3,"span",23),t.k0s()()()),2&e){let o,i;const n=t.XpG().$implicit,l=t.XpG(2);t.R7$(3),t.HbH(null==(o=l.utils.getLanguageInfo(n))?null:o.flagClass),t.Y8G("title",null==(i=l.utils.getLanguageInfo(n))?null:i.name)}}function lt(e,a){1&e&&t.DNE(0,at,4,3,"div",20),2&e&&t.vxM(a.$index<4?0:-1)}function ct(e,a){if(1&e&&(t.j41(0,"div",16),t.EFF(1),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.SpI(" +",(null==o.contact?null:o.contact.languages.length)-4," ")}}function st(e,a){if(1&e&&(t.j41(0,"div",19),t.Z7z(1,lt,1,1,null,null,t.fX1),t.k0s(),t.DNE(3,ct,2,1,"div",16)),2&e){const o=t.XpG();t.R7$(),t.Dyx(null==o.contact?null:o.contact.languages),t.R7$(2),t.vxM((null==o.contact?null:o.contact.languages.length)>4?3:-1)}}function rt(e,a){1&e&&t.nrm(0,"div",16)}function dt(e,a){1&e&&(t.j41(0,"span"),t.EFF(1,"s"),t.k0s())}function ut(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(null==o.contact||null==o.contact.phones?null:o.contact.phones[0])}}function pt(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(null==o.contact||null==o.contact.phones?null:o.contact.phones[1])}}function mt(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.SpI("+",(null==o.contact||null==o.contact.phones?null:o.contact.phones.length)-2,"")}}function vt(e,a){1&e&&(t.j41(0,"span"),t.EFF(1,"s"),t.k0s())}function ft(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(null==o.contact||null==o.contact.emails?null:o.contact.emails[0])}}function _t(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(null==o.contact||null==o.contact.emails?null:o.contact.emails[1])}}function gt(e,a){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.SpI("+",(null==o.contact||null==o.contact.emails?null:o.contact.emails.length)-2,"")}}function Ct(e,a){if(1&e&&(t.j41(0,"div",13)(1,"div",14),t.EFF(2,"Relacionado con"),t.k0s(),t.j41(3,"div",18)(4,"div",34)(5,"div",35),t.EFF(6),t.k0s()()()()),2&e){const o=t.XpG();t.R7$(6),t.SpI(" ",(null==o.contact||null==o.contact.contactsRelation||null==o.contact.contactsRelation[0]||null==o.contact.contactsRelation[0].contact?null:o.contact.contactsRelation[0].contact.name)||(null==o.contact||null==o.contact.contactsRelated||null==o.contact.contactsRelated[0]||null==o.contact.contactsRelated[0].contact?null:o.contact.contactsRelated[0].contact.name)," ")}}function ht(e,a){1&e&&(t.j41(0,"div",38),t.EFF(1," Este lead ha sido creado autom\xe1ticamente desde un correo, verifica que no hayan errores "),t.k0s())}function yt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",40)(1,"ion-radio-group",41),t.mxI("ngModelChange",function(n){t.eBV(o);const l=t.XpG(3);return t.DH7(l.showReceivedEmails,n)||(l.showReceivedEmails=n),t.Njj(n)}),t.j41(2,"div",42),t.nrm(3,"ion-radio",43),t.j41(4,"div",44),t.EFF(5," Recibidos "),t.k0s()(),t.j41(6,"div",42),t.nrm(7,"ion-radio",43),t.j41(8,"div",44),t.EFF(9," Enviados "),t.k0s()()(),t.nrm(10,"br")(11,"app-imap-email-list-viewer",37),t.k0s()}if(2&e){const o=t.XpG(3);t.R7$(),t.R50("ngModel",o.showReceivedEmails),t.R7$(2),t.Y8G("value",!0),t.R7$(4),t.Y8G("value",!1),t.R7$(4),t.Y8G("options",t.l_i(10,et,o.userEmailAccounts[0].id,t.eq3(8,ot,t.sMw(4,nt,o.toIsoStringDate4YearsAgo,o.showReceivedEmails?o.userEmailAccounts[0].email:null==o.contact||null==o.contact.emails?null:o.contact.emails[0],o.showReceivedEmails?null==o.contact||null==o.contact.emails?null:o.contact.emails[0]:o.userEmailAccounts[0].email))))}}function Ft(e,a){if(1&e){const o=t.RV6();t.DNE(0,ht,2,0,"div",38),t.j41(1,"app-contact-details-info",39),t.bIt("saveContact",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.ngOnInit())}),t.k0s(),t.DNE(2,yt,12,13,"div",40),t.nrm(3,"br")(4,"br")(5,"br")(6,"br")(7,"br")}if(2&e){const o=t.XpG(2);t.vxM(null!=o.contact&&o.contact.isAutoCreatedFromAutoLead?0:-1),t.R7$(),t.Y8G("contact",o.contactCopy),t.R7$(),t.vxM(o.userEmailAccounts.length>0&&null!=o.contact&&null!=o.contact.emails&&o.contact.emails[0]?2:-1)}}function It(e,a){if(1&e&&t.nrm(0,"app-contact-details-operations",36),2&e){const o=t.XpG(2);t.Y8G("contact",o.contact)("operationIdToOpenFromUrl",o.operationIdToOpenFromUrl)}}function Rt(e,a){if(1&e&&t.nrm(0,"app-operation-documents",37),2&e){const o=t.XpG(2);t.Y8G("options",t.eq3(1,it,o.contact.id))}}function kt(e,a){if(1&e&&t.DNE(0,Ft,8,3)(1,It,1,2,"app-contact-details-operations",36)(2,Rt,1,3,"app-operation-documents",37),2&e){const o=t.XpG();t.vxM("info"===o.activeTab?0:-1),t.R7$(),t.vxM("operations"===o.activeTab?1:-1),t.R7$(),t.vxM("documents"===o.activeTab?2:-1)}}const Dt=[{path:"",component:(()=>{var e;class a{constructor(i,n,l,s,r,p,u){this.headerService=i,this.activatedRoute=n,this.contactsService=l,this.toastService=s,this.router=r,this.utils=p,this.byvaroState=u,this.contactParameterId=null,this.contact=null,this.contactCopy=null,this.activeTab="info",this.userEmailAccounts=[],this.showReceivedEmails=!0,this.toIsoStringDate4YearsAgo=new Date((new Date).setFullYear((new Date).getFullYear()-4)).toISOString(),this.tabs=[{id:"1",title:"info",active:!0},{id:"2",title:"operations",active:!1},{id:"3",title:"documents",active:!1}],this.operationIdToOpenFromUrl=null}ngOnInit(){this.contactParameterId=this.activatedRoute.snapshot.paramMap.get("id"),this.getData(),this.getUserInfo()}ionViewWillEnter(){this.headerService.setConfig({title:"contact_details"})}onTabClicked(i){this.activeTab=i}getUserInfo(){this.byvaroState.getState().subscribe(i=>{var n,l,s;this.currentUser=i.user,null!==(n=this.currentUser)&&void 0!==n&&n.imapEmailAccounts&&(null===(l=this.currentUser)||void 0===l?void 0:l.imapEmailAccounts.length)>0&&(this.userEmailAccounts=null===(s=this.currentUser)||void 0===s?void 0:s.imapEmailAccounts)})}getData(){var i=this;return(0,d.A)(function*(){if(i.contact=yield i.getContactById(),i.contactCopy=I.cloneDeep(i.contact),!i.contact)return i.toastService.showToast({text:"No existe ning\xfan contacto con ese ID",icon:"fas fa-exclamation-triangle",theme:"red",time:3e3}),void i.router.navigate(["/contacts"]);console.log(i.contact);const n=i.activatedRoute.snapshot.paramMap.get("operationId")||null;n&&(i.operationIdToOpenFromUrl=n,i.activeTab="operations")})()}getContactById(){var i=this;return(0,d.A)(function*(){return i.contactParameterId?i.contactsService.getContactById(i.contactParameterId):null})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(P.d),t.rXU(v.nX),t.rXU(R.F),t.rXU(g.f),t.rXU(v.Ix),t.rXU(k.T),t.rXU(D.c))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-contact-details"]],decls:91,vars:35,consts:[[1,"crm-block-body"],[1,"crm-block-body-fixed"],[1,"crm-block-details-header"],[1,"crm-block-details-header-top"],[1,"crm-block-details-header-left"],[1,"crm-block-photo-and-info"],[1,"crm-block-photo-and-info-img"],["alt","",3,"src"],[1,"crm-block-photo-and-info-info"],[1,"crm-block-photo-and-info-info-title"],[1,"crm-block-photo-and-info-info-footer"],[1,"crm-vertical-separator"],[1,"crm-block-info-horizontal"],[1,"crm-info","crm-info-size-medium"],[1,"crm-info-title"],[1,"crm-info-content-langs"],[1,"crm-info-content-langs-plus"],[1,"crm-info","crm-info-size-small"],[1,"crm-info-content"],[1,"crm-info-content-langs-langs"],[1,"crm-item-option","crm-item-option-lang"],[1,"crm-item-option-left"],[1,"crm-item-option-flag"],[3,"title"],[1,"crm-item-option-label"],[4,"ngIf"],[1,"crm-info"],[1,"crm-info-content","crm-info-content-with-icon"],[1,"fas","fa-bullseye"],[1,"crm-block-details-header-right"],[1,"crm-buttons-group"],[1,"crm-block-details-bottom"],[3,"tabClicked","tabs"],[1,"crm-block-body-blue-content",3,"ngClass"],[1,"crm-item-reference"],[1,"crm-item-reference-text"],[2,"flex","1",3,"contact","operationIdToOpenFromUrl"],[3,"options"],[1,"crm-item-chip","crm-item-chip-warn"],[3,"saveContact","contact"],[2,"width","600px"],[1,"crm-input-radios",3,"ngModelChange","ngModel"],[1,"crm-input-radio"],[3,"value"],[1,"crm-input-radio-label"]],template:function(i,n){if(1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t.nrm(7,"img",7),t.k0s(),t.j41(8,"div",8)(9,"div")(10,"div",9),t.EFF(11),t.k0s(),t.j41(12,"div",10),t.EFF(13),t.k0s()(),t.j41(14,"div")(15,"div",10),t.EFF(16),t.nI1(17,"date"),t.k0s()()()(),t.nrm(18,"div",11),t.j41(19,"div",12)(20,"div",13)(21,"div",14),t.EFF(22,"Idiomas"),t.k0s(),t.j41(23,"div",15),t.DNE(24,st,4,1)(25,rt,1,0,"div",16),t.k0s()(),t.j41(26,"div",17)(27,"div",14),t.EFF(28,"Nacionalidad"),t.k0s(),t.j41(29,"div",18)(30,"div",19)(31,"div",20)(32,"div",21)(33,"div",22),t.nrm(34,"span",23),t.k0s(),t.j41(35,"div",24),t.EFF(36),t.k0s()()()()()(),t.j41(37,"div",17)(38,"div",14),t.EFF(39,"Alias"),t.k0s(),t.j41(40,"div",18)(41,"div"),t.EFF(42),t.k0s()()(),t.j41(43,"div",17)(44,"div",14),t.EFF(45,"Referencia"),t.k0s(),t.j41(46,"div",18)(47,"div"),t.EFF(48),t.k0s()()(),t.j41(49,"div",13)(50,"div",14),t.EFF(51," Tel\xe9fono"),t.DNE(52,dt,2,0,"span",25),t.k0s(),t.j41(53,"div",18),t.DNE(54,ut,2,1,"div",25)(55,pt,2,1,"div",25)(56,mt,2,1,"div",25),t.k0s()(),t.j41(57,"div",13)(58,"div",14),t.EFF(59," E-mail"),t.DNE(60,vt,2,0,"span",25),t.k0s(),t.j41(61,"div",18),t.DNE(62,ft,2,1,"div",25)(63,_t,2,1,"div",25)(64,gt,2,1,"div",25),t.k0s()(),t.j41(65,"div",17)(66,"div",14),t.EFF(67,"Origen"),t.k0s(),t.j41(68,"div",18)(69,"div"),t.EFF(70),t.k0s()()(),t.j41(71,"div",17)(72,"div",14),t.EFF(73,"Creado el"),t.k0s(),t.j41(74,"div",18)(75,"div"),t.EFF(76),t.nI1(77,"date"),t.k0s()()(),t.j41(78,"div",26)(79,"div",14),t.EFF(80,"Operaciones"),t.k0s(),t.j41(81,"div",27),t.nrm(82,"i",28),t.EFF(83),t.k0s()(),t.DNE(84,Ct,7,1,"div",13),t.k0s()(),t.j41(85,"div",29),t.nrm(86,"div",30),t.k0s()(),t.j41(87,"div",31)(88,"app-tabs",32),t.bIt("tabClicked",function(s){return n.onTabClicked(s)}),t.k0s()()()(),t.j41(89,"div",33),t.DNE(90,kt,3,3),t.k0s()()),2&i){let l,s,r;t.R7$(7),t.Y8G("src",(null==n.contact?null:n.contact.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(4),t.SpI(" ",null==n.contact?null:n.contact.name," "),t.R7$(2),t.SpI(" #",null==n.contact?null:n.contact.byvaroId," "),t.R7$(3),t.SpI(" Creado el ",t.i5U(17,27,null==n.contact?null:n.contact.createdAt,"dd/MM/yyyy")," "),t.R7$(8),t.vxM(null!=n.contact&&n.contact.languages&&(null==n.contact?null:n.contact.languages.length)>0?24:25),t.R7$(10),t.HbH(null==(l=n.utils.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:l.flagClass),t.Y8G("title",null==(s=n.utils.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:s.name),t.R7$(2),t.SpI(" ",null==(r=n.utils.getCountryInfo(null==n.contact?null:n.contact.nationality))?null:r.name," "),t.R7$(6),t.JRh(null==n.contact?null:n.contact.alias),t.R7$(6),t.JRh(null==n.contact?null:n.contact.reference),t.R7$(4),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>1),t.R7$(2),t.Y8G("ngIf",null==n.contact||null==n.contact.phones?null:n.contact.phones[0]),t.R7$(),t.Y8G("ngIf",null==n.contact||null==n.contact.phones?null:n.contact.phones[0]),t.R7$(),t.Y8G("ngIf",(null==n.contact||null==n.contact.phones?null:n.contact.phones.length)>2),t.R7$(4),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>1),t.R7$(2),t.Y8G("ngIf",null==n.contact||null==n.contact.emails?null:n.contact.emails[0]),t.R7$(),t.Y8G("ngIf",null==n.contact||null==n.contact.emails?null:n.contact.emails[0]),t.R7$(),t.Y8G("ngIf",(null==n.contact||null==n.contact.emails?null:n.contact.emails.length)>2),t.R7$(6),t.JRh(null==n.contact?null:n.contact.origin),t.R7$(6),t.JRh(t.i5U(77,30,null==n.contact?null:n.contact.createdAt,"dd/MM/yyyy")),t.R7$(7),t.Lme(" ",null==n.contact||null==n.contact.operations?null:n.contact.operations.length," / ",null==n.contact||null==n.contact.operations?null:n.contact.operations.length," "),t.R7$(),t.vxM((null==n.contact||null==n.contact.contactsRelation?null:n.contact.contactsRelation.length)>0||(null==n.contact||null==n.contact.contactsRelated?null:n.contact.contactsRelated.length)>0?84:-1),t.R7$(4),t.Y8G("tabs",n.tabs),t.R7$(),t.Y8G("ngClass",t.eq3(33,tt,"operations"===n.activeTab)),t.R7$(),t.vxM(null!=n.contact&&n.contact.id?90:-1)}},dependencies:[m.YU,m.bT,_.BC,_.vS,f.KO,f.f0,f.Je,b.O,E.x,O.t,U,q,m.vh]}),a})()}];let bt=(()=>{var e;class a{}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[v.iI.forChild(Dt),v.iI]}),a})();var Et=c(7294),Tt=c(179),jt=c(3675),$t=c(3274),Pt=c(3732),Ot=c(9066);let St=(()=>{var e;class a{}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[m.MD,_.YN,f.bv,bt,b.O,Et.J,C.h,Tt.Y,$t.K,jt.S,E.x,Pt.D,Ot.K]}),a})()}}]);