"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7306],{8129:(T,P,r)=>{r.d(P,{K:()=>h});var s=r(3953);let h=(()=>{var d;class v{constructor(t,p){this.el=t,this.renderer=p,this.isLoading=!1}ngOnChanges(t){"isLoading"in t&&this.updateButtonState()}updateButtonState(){const t=this.el.nativeElement;if(this.isLoading){t.getAttribute("data-original-content")||this.renderer.setAttribute(t,"data-original-content",t.innerHTML),this.renderer.setProperty(t,"disabled",!0),this.renderer.setStyle(t,"opacity","0.6"),this.renderer.setStyle(t,"pointer-events","none"),this.renderer.setStyle(t,"cursor","not-allowed");const p=this.renderer.createElement("ion-spinner"),D=this.renderer.createText(" Cargando...");this.renderer.setProperty(t,"innerHTML",""),this.renderer.appendChild(t,p),this.renderer.appendChild(t,D)}else{this.renderer.setProperty(t,"disabled",!1),this.renderer.removeStyle(t,"opacity"),this.renderer.removeStyle(t,"pointer-events"),this.renderer.removeStyle(t,"cursor");const p=t.getAttribute("data-original-content");p&&(this.renderer.setProperty(t,"innerHTML",p),this.renderer.removeAttribute(t,"data-original-content"))}}}return(d=v).\u0275fac=function(t){return new(t||d)(s.rXU(s.aKT),s.rXU(s.sFG))},d.\u0275dir=s.FsC({type:d,selectors:[["","appLoadingButton",""]],inputs:{isLoading:[0,"appLoadingButton","isLoading"]},standalone:!0,features:[s.OA$]}),v})()},1748:(T,P,r)=>{r.d(P,{z:()=>h});var s=r(3953);let h=(()=>{var d;class v{constructor(t,p){this.el=t,this.renderer=p}ngOnInit(){this.checkbox=this.el.nativeElement.querySelector("ion-checkbox"),this.renderer.listen(this.el.nativeElement,"click",t=>{t.target!==this.checkbox&&this.checkbox&&this.checkbox.click()})}}return(d=v).\u0275fac=function(t){return new(t||d)(s.rXU(s.aKT),s.rXU(s.sFG))},d.\u0275dir=s.FsC({type:d,selectors:[["","appToggleCheckbox",""]],standalone:!0}),v})()},6676:(T,P,r)=>{r.r(P),r.d(P,{PromotionCreatePageModule:()=>V});var s=r(177),h=r(9417),d=r(9465),v=r(517),y=r(467),t=r(293),p=r(7221),D=r(8857),C=r(7376),e=r(3953),I=r(6039),L=r(4501),M=r(8031),G=r(6552),U=r(8397),A=r(8129);const j=i=>({"crm-block-steps-step-disabled":i}),B=i=>({"crm-section-invisible":i}),O=[{path:"",component:(()=>{var i;class S{constructor(o,a,l,b,m,u){this.api=o,this.headerService=a,this.promotionTransformersService=l,this.utils=b,this.router=m,this.toastService=u,this.currentStep=0,this.loadingButton=!1}ngOnInit(){}ionViewWillEnter(){this.headerService.setConfig({title:"promotion_create"})}getData(){}setFormValues(){const o=this.promotionTransformersService.transformPromotionFormStepOne(this.promotion);this.stepOneForm.promotionStepOne=o,this.stepTwoForm.promotionStepTwo=this.promotion,this.promotionTransformersService.transformPromotionFormStepThree(this.promotion)}nextStep(){var o=this;return(0,y.A)(function*(){if(0===o.currentStep&&(o.promotion={...o.promotion,...o.stepOneForm.promotionStepOne}),1===o.currentStep){const a=o.promotionTransformersService.deleteAllPromotionPropertiesExceptFeatures(o.stepTwoForm.promotionStepTwo);o.promotion={...o.promotion,...a},o.stepThreeForm.disabled=!1,o.stepThreeForm.syncFiles()}2===o.currentStep&&(o.promotion={...o.promotion,title_es:o.stepThreeForm.promotionStepThree.title_es,title_en:o.stepThreeForm.promotionStepThree.title_en,title_de:o.stepThreeForm.promotionStepThree.title_de,title_fr:o.stepThreeForm.promotionStepThree.title_fr,title_ru:o.stepThreeForm.promotionStepThree.title_ru,description_es:o.stepThreeForm.promotionStepThree.description_es,description_en:o.stepThreeForm.promotionStepThree.description_en,description_de:o.stepThreeForm.promotionStepThree.description_de,description_fr:o.stepThreeForm.promotionStepThree.description_fr,description_ru:o.stepThreeForm.promotionStepThree.description_ru,promotionFiles:o.stepThreeForm.promotionStepThree.promotionFiles}),o.currentStep>=2&&(console.log("promotion",o.promotion),o.loadingButton=!0,yield o.createPromotion(),o.loadingButton=!1),o.currentStep<2&&o.currentStep++})()}prevStep(){this.currentStep--}createPromotion(){var o=this;return(0,y.A)(function*(){console.log("create promotion"),C.cloneDeep(o.promotion.promotionFiles),delete o.promotion.promotionBlocks,delete o.promotion.propertiesCount,delete o.promotion.checked,delete o.promotion.promotionFiles,o.promotion=o.utils.parseProperties(o.promotion),o.promotion.promotionPaymentInfoIsCompleted=!1;const l=yield o.api.createPromotion(o.promotion),b=l.success.data.id;if(!l.success)return console.error(l.error),void o.toastService.showToast({text:l.error.errorMessage,theme:"red",time:2e3});{var m,u,g,f;let Y=[...C.cloneDeep(null===(m=o.stepThreeForm)||void 0===m||null===(m=m.fileUploaderManager)||void 0===m||null===(m=m.config)||void 0===m?void 0:m.files)||[],...C.cloneDeep(null===(u=o.stepThreeForm)||void 0===u||null===(u=u.planosFileUploadManagerComponent)||void 0===u||null===(u=u.config)||void 0===u?void 0:u.files)||[],...C.cloneDeep(null===(g=o.stepThreeForm)||void 0===g||null===(g=g.catalogsFileUploadManagerComponent)||void 0===g||null===(g=g.config)||void 0===g?void 0:g.files)||[],...C.cloneDeep(null===(f=o.stepThreeForm)||void 0===f||null===(f=f.videosFileUploadManagerComponent)||void 0===f||null===(f=f.config)||void 0===f?void 0:f.files)||[]];for(let n of Y){if(null!=n&&n.new){var k;const c={promotionId:b,name:"",category:n.category,label:n.label,orderIndex:null==n?void 0:n.orderIndex},E=yield o.api.uploadFile(n.fileBlob),K=null==E||null===(k=E.success)||void 0===k||null===(k=k.data)||void 0===k?void 0:k.fileName;c.name=K,yield o.api.addPromotionFile(c)}if(null!=n&&n.deleted&&(yield o.api.removePromotionFileById(null==n?void 0:n.id)),null!=n&&n.moved&&(null==n||!n.deleted)&&(null==n||!n.new)){let c=C.cloneDeep(n);delete c.moved,delete c.fileBase64,delete c.fileBlob,delete c.new,delete c.deleted,delete c.size,delete c.type,yield o.api.editPromotionFile(c)}}}window.location.href="/promotions"})()}}return(i=S).\u0275fac=function(o){return new(o||i)(e.rXU(I.i),e.rXU(L.d),e.rXU(M.J),e.rXU(G.T),e.rXU(v.Ix),e.rXU(U.f))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-promotion-create"]],viewQuery:function(o,a){if(1&o&&(e.GBs(t.N,5),e.GBs(p.T,5),e.GBs(D.f,5)),2&o){let l;e.mGM(l=e.lsd())&&(a.stepOneForm=l.first),e.mGM(l=e.lsd())&&(a.stepTwoForm=l.first),e.mGM(l=e.lsd())&&(a.stepThreeForm=l.first)}},decls:67,vars:16,consts:[["stepOneForm",""],["stepTwoForm",""],["stepThreeForm",""],[1,"crm-block-body"],[1,"crm-block-steps"],[1,"crm-block-steps-step"],[1,"crm-block-steps-step-left"],[1,"crm-block-steps-step-number"],[1,"crm-block-steps-step-right"],[1,"crm-block-steps-step-title"],[1,"crm-block-steps-step-subtitle"],[1,"crm-block-steps-step",3,"ngClass"],[1,"crm-block-body-white-content"],[1,"crm-section","crm-section-center-content",3,"ngClass"],[1,"crm-header-modal","crm-header-modal-padding","crm-header-modal-fixed-top"],[1,"crm-modal-header-title"],[1,"crm-buttons-group"],[1,"crm-button",3,"click"],[1,"crm-button-secondary",3,"click"],[1,"crm-button",3,"click","appLoadingButton"]],template:function(o,a){if(1&o){const l=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7),e.EFF(5," 1 "),e.k0s()(),e.j41(6,"div",8)(7,"div",9),e.EFF(8," Definir la promoci\xf3n "),e.k0s(),e.j41(9,"div",10),e.EFF(10," Establece la informaci\xf3n general de la promoci\xf3n "),e.k0s()()(),e.j41(11,"div",11)(12,"div",6)(13,"div",7),e.EFF(14," 2 "),e.k0s()(),e.j41(15,"div",8)(16,"div",9),e.EFF(17," Caracter\xedsticas "),e.k0s(),e.j41(18,"div",10),e.EFF(19," Selecciona las caracter\xedsticas de las propiedades "),e.k0s()()(),e.j41(20,"div",11)(21,"div",6)(22,"div",7),e.EFF(23," 3 "),e.k0s()(),e.j41(24,"div",8)(25,"div",9),e.EFF(26," Im\xe1genes y textos "),e.k0s(),e.j41(27,"div",10),e.EFF(28," Sube im\xe1genes y selecciona los textos "),e.k0s()()()(),e.j41(29,"div",12)(30,"div",13)(31,"div",14),e.nrm(32,"div",15),e.j41(33,"div",16)(34,"button",17),e.bIt("click",function(){return e.eBV(l),e.Njj(a.nextStep())}),e.EFF(35," Siguiente "),e.k0s()()(),e.nrm(36,"app-step-one-promotion-form",null,0)(38,"br")(39,"br")(40,"br"),e.k0s(),e.j41(41,"div",13)(42,"div",14),e.nrm(43,"div",15),e.j41(44,"div",16)(45,"button",18),e.bIt("click",function(){return e.eBV(l),e.Njj(a.prevStep())}),e.EFF(46," Atr\xe1s "),e.k0s(),e.j41(47,"button",17),e.bIt("click",function(){return e.eBV(l),e.Njj(a.nextStep())}),e.EFF(48," Siguiente "),e.k0s()()(),e.nrm(49,"app-step-two-promotion-form",null,1)(51,"br")(52,"br")(53,"br"),e.k0s(),e.j41(54,"div",13)(55,"div",14),e.nrm(56,"div",15),e.j41(57,"div",16)(58,"button",18),e.bIt("click",function(){return e.eBV(l),e.Njj(a.prevStep())}),e.EFF(59," Atr\xe1s "),e.k0s(),e.j41(60,"button",19),e.bIt("click",function(){return e.eBV(l),e.Njj(a.nextStep())}),e.EFF(61," Siguiente "),e.k0s()()(),e.nrm(62,"app-step-three-promotion-form",null,2)(64,"br")(65,"br")(66,"br"),e.k0s()()()}2&o&&(e.R7$(11),e.Y8G("ngClass",e.eq3(6,j,a.currentStep<1)),e.R7$(9),e.Y8G("ngClass",e.eq3(8,j,a.currentStep<2)),e.R7$(10),e.Y8G("ngClass",e.eq3(10,B,0!==a.currentStep)),e.R7$(11),e.Y8G("ngClass",e.eq3(12,B,1!==a.currentStep)),e.R7$(13),e.Y8G("ngClass",e.eq3(14,B,2!==a.currentStep)),e.R7$(6),e.Y8G("appLoadingButton",a.loadingButton))},dependencies:[s.YU,t.N,p.T,D.f,A.K]}),S})()}];let R=(()=>{var i;class S{}return(i=S).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[v.iI.forChild(O),v.iI]}),S})();var z=r(9083);let V=(()=>{var i;class S{}return(i=S).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[s.MD,h.YN,d.bv,R,z.E]}),S})()},1280:(T,P,r)=>{r.d(P,{B:()=>h,X:()=>s});const s={general:["general","airConditioning","heating"],urbanizacion:["urbanizacion"],cercania:["cercania"],caracteristicas:["caracteristicas"]},h={airConditioning:["AACentralizado","Split","PreInstalacion"],heating:["CentralConGasNatural","CentralConDiesel","CentralConElectricidad","CentralConSueloRadiante","SueloRadianteSoloBanos","CentralConAerotermia","IndividualBombaCalorFrio","IndividualGasPropanoButano"],general:["barbacoa","armariosEmpotrados","puertaBlindada","ascensor","panelesSolares","domotica","gymPrivado","jacuzziPrivado","saunaPrivada","alarma","persianasElectricas","dobleAcristalamiento"],urbanizacion:["Urbanizacion","Portero","UrbanizacionCerrada","Vigilancia24Horas","Gym","PistaDePadel","PistaDeTenis","RestauranteEnElRecinto","SalaDeEventos","Coworking","ZonasAjardinadas","ParqueInfantil","PiscinaInfantil","Hammam","Jacuzzi","Sauna"],cercania:["PrimeraLineaDePlaya","SegundaLineaDePlaya","CercaDeLaPlaya","PrimeraLineaDeGolf","SegundaLineaDeGolf","CercaDeGolf","CentroDeCiudad","CercaDelPuerto"],caracteristicas:["LicenciaTuristica","Balcon","JardinPrivado","Vestidor","Lavanderia","CasaDeInvitados","Chimenea","PistaDeTenisPrivado","PistaDePadelPrivado","Bodega","Despensa"]}}}]);