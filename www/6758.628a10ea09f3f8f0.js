"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6758],{1296:(E,b,u)=>{u.d(b,{a:()=>s});var p=u(3953);let s=(()=>{var f;class P{constructor(){}convertDataToTableRows(e,g){const h=[];let _=0;for(let k of e){const l={rowIndex:_,rawObject:k,checked:!1,rowId:(null==k?void 0:k.id)||(null==k?void 0:k._id)||_,cells:{}};for(let c of g.columns)l.cells[null==c?void 0:c.key]=null!=c&&c.fn?{value:c.fn(k),type:(null==c?void 0:c.type)||"text"}:{value:this.getNestedValue(k,null==c?void 0:c.key)||"",type:(null==c?void 0:c.type)||"text"},null!=c&&c.extraString&&(l.cells[null==c?void 0:c.key].value=l.cells[null==c?void 0:c.key].value+(null==c?void 0:c.extraString),l.cells[null==c?void 0:c.key].extraString=null==c?void 0:c.extraString);h.push(l),_++}return h}getNestedValue(e,g){return g.split(".").reduce((h,_)=>h?h[_]:void 0,e)}setRowsChipsFromOperations(e){return e.map(g=>{var h;return g.cells["currentPipelineStep.text"].chipColor=(null===(h=g.rawObject.currentPipelineStep)||void 0===h?void 0:h.color)||"",g.cells["currentPipelineStep.text"].type="chip",g})}setRowsChipsFromRegistersList(e){return e.map(g=>(g.cells.status.type="chip","rejected"===g.cells.status.value&&(g.cells.status.chipColor="#D92D20"),"accepted"===g.cells.status.value&&(g.cells.status.chipColor="#00C36A"),g))}}return(f=P).\u0275fac=function(e){return new(e||f)},f.\u0275prov=p.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),P})()},6906:(E,b,u)=>{u.d(b,{CP:()=>s,I:()=>f,Rl:()=>P,qA:()=>y});let s=["#686868","#00C751","#C98BDB","#C0AC4C","#3A50E4","#F14E1C"],f={"#686868":"#F0F0F0","#00C751":"#E5F9EE","#C98BDB":"#FAF3FB","#C0AC4C":"#FFFBE8","#3A50E4":"#ECF2FF","#F14E1C":"#FEEDE8"};const P=[{key:"sole_administrator",label:"Administrador \xfanico"},{key:"joint_and_several_administrator",label:"Administrador solidario"},{key:"joint_administrator",label:"Administrador mancomunado"},{key:"delegated_director",label:"Consejero delegado"},{key:"general_attorney",label:"Apoderado general"},{key:"special_attorney",label:"Apoderado especial"},{key:"chairman_of_board",label:"Presidente del Consejo"}],y={sole_administrator:"Administrador \xfanico",joint_and_several_administrator:"Administrador solidario",joint_administrator:"Administrador mancomunado",delegated_director:"Consejero delegado",general_attorney:"Apoderado general",special_attorney:"Apoderado especial",chairman_of_board:"Presidente del Consejo"}},1129:(E,b,u)=>{u.d(b,{Z:()=>y});var p=u(3953),s=u(6069),f=u(1982);function P(e,g){if(1&e){const h=p.RV6();p.j41(0,"app-country-selector-popover",4),p.bIt("countrySelected",function(F){p.eBV(h);const k=p.XpG();return p.Njj(k.selectCountry(F))})("closePopover",function(){p.eBV(h);const F=p.XpG();return p.Njj(F.dropdownOpen=!1)}),p.k0s()}2&e&&p.Y8G("showCountryCode",!0)}let y=(()=>{var e;class g{constructor(){this.emitCountrySelected=new p.bkB,this.countries=s.X,this.selectedCountry=s.X[0],this.dropdownOpen=!1}ngOnChanges(){const _=this.extractCountryPhoneCodeFromPhoneNumber(this.selectedPhoneNumber);_!==this.extractCountryPhoneCodeFromPhoneNumber(this.selectedCountry.phoneCode)&&this.selectCountryByPhoneCode(_)}toggleDropdown(_){_.stopPropagation(),this.dropdownOpen=!this.dropdownOpen}selectCountry(_){_.event.stopPropagation(),this.selectedCountry=_.country,this.emitCountrySelected.emit(_.country),this.dropdownOpen=!1}selectCountryByPhoneCode(_){const F=this.countries.find(k=>k.phoneCode===_);F&&(this.selectedCountry=F,this.emitCountrySelected.emit(F))}extractCountryPhoneCodeFromPhoneNumber(_){return null==_?void 0:_.split(" ")[0]}}return(e=g).\u0275fac=function(_){return new(_||e)},e.\u0275cmp=p.VBU({type:e,selectors:[["app-flag-country-selector"]],inputs:{selectedPhoneNumber:"selectedPhoneNumber"},outputs:{emitCountrySelected:"emitCountrySelected"},features:[p.OA$],decls:5,vars:3,consts:[["tabindex","0",1,"flag-country-selector-container",3,"click"],[1,"selected-country"],[1,"fas","fa-caret-down","dropdown-arrow"],[3,"showCountryCode"],[3,"countrySelected","closePopover","showCountryCode"]],template:function(_,F){1&_&&(p.j41(0,"div",0),p.bIt("click",function(l){return F.toggleDropdown(l)}),p.j41(1,"div",1),p.nrm(2,"span")(3,"i",2),p.k0s(),p.DNE(4,P,1,1,"app-country-selector-popover",3),p.k0s()),2&_&&(p.R7$(2),p.HbH(null==F.selectedCountry?null:F.selectedCountry.flagClass),p.R7$(2),p.vxM(F.dropdownOpen?4:-1))},dependencies:[f.u],styles:[".flag-country-selector-container[_ngcontent-%COMP%]{position:relative;width:50px;cursor:pointer;color:#000}.selected-country[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:40px;width:50px}.dropdown-arrow[_ngcontent-%COMP%]{margin-left:8px}.dropdown-options[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:200px;z-index:9999;background-color:#fff;border:1px solid #ccc;padding:8px 0;border-radius:12px;border:1px solid var(--crm-border-light-color);color:#000;max-height:150px;overflow-y:auto}.option[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;cursor:pointer;font-size:14px}.option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;display:inline-block;margin-right:8px}.option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.flag-country-selector-container[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{color:#000}.selected-country[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;width:18px;height:18px}"]}),g})()},6812:(E,b,u)=>{u.d(b,{u:()=>y});var p=u(177),s=u(9417),f=u(7754),P=u(3953);let y=(()=>{var e;class g{}return(e=g).\u0275fac=function(_){return new(_||e)},e.\u0275mod=P.$C({type:e}),e.\u0275inj=P.G2t({imports:[p.MD,s.YN,f.X]}),g})()},7754:(E,b,u)=>{u.d(b,{X:()=>y});var p=u(177),s=u(9417),f=u(9465),P=u(3953);let y=(()=>{var e;class g{}return(e=g).\u0275fac=function(_){return new(_||e)},e.\u0275mod=P.$C({type:e}),e.\u0275inj=P.G2t({imports:[p.MD,s.YN,f.bv]}),g})()},4821:(E,b,u)=>{u.d(b,{e:()=>s});var p=u(3953);let s=(()=>{var f;class P{constructor(e){this.renderer=e,this.text="",this.maxLength=20,this.tooltipClass="",this.tooltipElement=null}ngOnInit(){}get trimmedText(){return this.text?this.text.length>this.maxLength?this.text.slice(0,this.maxLength)+"...":this.text:""}showTooltip(e){this.text.length<=this.maxLength||(this.tooltipElement=this.renderer.createElement("div"),this.tooltipElement.innerText=this.text,this.renderer.addClass(this.tooltipElement,"custom-tooltip"),this.tooltipClass&&this.tooltipClass.split(" ").forEach(h=>{h.trim()&&this.renderer.addClass(this.tooltipElement,h.trim())}),this.renderer.setStyle(this.tooltipElement,"position","fixed"),this.renderer.setStyle(this.tooltipElement,"top",e.clientY-30+"px"),this.renderer.setStyle(this.tooltipElement,"left",`${e.clientX}px`),this.renderer.setStyle(this.tooltipElement,"z-index","9999"),this.renderer.appendChild(document.body,this.tooltipElement))}hideTooltip(){this.tooltipElement&&(this.renderer.removeChild(document.body,this.tooltipElement),this.tooltipElement=null)}}return(f=P).\u0275fac=function(e){return new(e||f)(p.rXU(p.sFG))},f.\u0275cmp=p.VBU({type:f,selectors:[["app-tooltip-text"]],inputs:{text:"text",maxLength:"maxLength",tooltipClass:"tooltipClass"},standalone:!0,features:[p.aNF],decls:2,vars:1,consts:[[1,"text",3,"mouseenter","mouseleave"]],template:function(e,g){1&e&&(p.j41(0,"span",0),p.bIt("mouseenter",function(_){return g.showTooltip(_)})("mouseleave",function(){return g.hideTooltip()}),p.EFF(1),p.k0s()),2&e&&(p.R7$(),p.SpI(" ",g.trimmedText,"\n"))}}),P})()},2098:(E,b,u)=>{u.r(b),u.d(b,{VentaOperationProcessPageModule:()=>He});var p=u(177),s=u(9417),f=u(9465),P=u(5188),y=u(467),e=u(3953),g=u(6039),h=u(8397);function _(o,d){if(1&o){const i=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.onSelectPromotion(n))}),e.EFF(1," Seleccionada "),e.k0s()}}function F(o,d){if(1&o){const i=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.onSelectPromotion(n))}),e.EFF(1," Seleccionar "),e.k0s()}}function k(o,d){if(1&o&&(e.j41(0,"div",14)(1,"div",15),e.EFF(2),e.k0s(),e.j41(3,"div",16),e.EFF(4),e.k0s(),e.j41(5,"div",17),e.DNE(6,_,2,0,"button",18)(7,F,2,0,"button",19),e.k0s()()),2&o){const i=d.$implicit,t=e.XpG();e.R7$(2),e.SpI(" ",i.projectName," "),e.R7$(2),e.Lme(" ",i.availableProperties.length," / ",i.properties.length," "),e.R7$(2),e.vxM((null==t.selectedPromotion?null:t.selectedPromotion.id)===i.id?6:7)}}let l=(()=>{var o;class d{constructor(t){this.api=t,this.selectPromotion=new e.bkB,this.promotions=[],this.selectedPromotion=null,this.searchTerm=""}ngOnInit(){this.getAllPromotions()}getAllPromotions(){var t=this;return(0,y.A)(function*(){try{const n={page:0,itemsPerPage:500},r=yield t.api.getPromotions({},null,n,{properties:{apply:!0,filter:null,onlyCount:!1},promotionFiles:{apply:!0,filter:null,onlyCount:!1},promoter:{apply:!0,filter:null,onlyCount:!1}});null!=r&&r.success?(t.promotions=r.success.data,t.promotions.forEach(a=>{var v;a.availableProperties=null===(v=a.properties)||void 0===v?void 0:v.filter(x=>"available"===x.availabilityStatus)}),console.log("All Promotions:",t.promotions)):console.error("Error fetching promotions:",null==r?void 0:r.error)}catch(n){console.error("Error in getAllPromotions:",n)}})()}get filteredPromotions(){return this.searchTerm?this.promotions.filter(t=>{var n;return null===(n=t.projectName)||void 0===n?void 0:n.toLowerCase().includes(this.searchTerm.toLowerCase())}):this.promotions}onSelectPromotion(t){this.selectPromotion.emit(t),this.selectedPromotion=t}}return(o=d).\u0275fac=function(t){return new(t||o)(e.rXU(g.i))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-promotion"]],outputs:{selectPromotion:"selectPromotion"},decls:19,vars:3,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"max-width","300px","margin-bottom","16px"],[1,"crm-input-input","crm-input-input-searchbar"],[1,"fas","fa-search"],["type","text","placeholder","Buscar promoci\xf3n...",3,"ngModelChange","ngModel"],[1,"promotions-table"],[1,"promotions-table-header"],[1,"promotions-table-header-title"],[1,"promotions-table-header-availability"],[1,"promotions-table-header-actions"],["class","promotions-table-row",4,"ngFor","ngForOf"],[1,"promotions-table-footer"],[1,"promotions-table-row"],[1,"promotions-table-row-title"],[1,"promotions-table-row-availability"],[1,"promotions-table-row-actions"],["disabled","",1,"crm-button"],[1,"crm-button"],["disabled","",1,"crm-button",3,"click"],[1,"crm-button",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 1. Promoci\xf3n "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.nrm(6,"i",5),e.j41(7,"input",6),e.mxI("ngModelChange",function(a){return e.DH7(n.searchTerm,a)||(n.searchTerm=a),a}),e.k0s()()(),e.j41(8,"div",7)(9,"div",8)(10,"div",9),e.EFF(11,"Promoci\xf3n"),e.k0s(),e.j41(12,"div",10),e.EFF(13,"Viviendas disponibles"),e.k0s(),e.j41(14,"div",11),e.EFF(15,"Acciones"),e.k0s()(),e.DNE(16,k,8,4,"div",12),e.k0s(),e.j41(17,"div",13),e.EFF(18),e.k0s()()()),2&t&&(e.R7$(7),e.R50("ngModel",n.searchTerm),e.R7$(9),e.Y8G("ngForOf",n.filteredPromotions),e.R7$(2),e.SpI(" Total promociones: ",n.filteredPromotions.length," "))},dependencies:[p.Sq,s.me,s.BC,s.vS]}),d})();var c=u(7376),m=u(1296),C=u(6552),j=u(1880);function M(o,d){if(1&o){const i=e.RV6();e.qex(0),e.j41(1,"div",4),e.EFF(2),e.k0s(),e.j41(3,"app-table",5),e.bIt("rowClicked",function(n){e.eBV(i);const r=e.XpG();return e.Njj(r.onRowClicked(n))}),e.k0s(),e.nrm(4,"div",6),e.bVm()}if(2&o){const i=d.$implicit,t=d.index;e.R7$(2),e.SpI(" ",i.name||"Bloque "+(i.index||t+1)," "),e.R7$(),e.Y8G("table",i.tableConfig)}}let R=(()=>{var o;class d{constructor(t,n,r){this.tableService=t,this.utils=n,this.toastService=r,this.selectProperty=new e.bkB,this.blocks=[],this.allColumnsKeysSelected=["externalReference","reference","m2useful","m2total","terrace","plot","bedrooms","bathrooms","pool","storage","parking","price"],this.tableConfig={uniqueId:"table-1",showSelectors:!1,editCellsMode:!1,columns:[{key:"externalReference",label:"Ref. externa",size:"medium",editMode:{inputType:"text"}},{key:"reference",label:"Identificador",size:"medium",editMode:{inputType:"text"}},{key:"m2useful",label:"M2 \xfatiles",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersUseful?a.totalMeasures_squareMetersUseful+" m\xb2":""},{key:"m2total",label:"M2 total",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersBuilt?a.totalMeasures_squareMetersBuilt+" m\xb2":""},{key:"terrace",label:"Terraza",size:"small",fn:a=>{const S=(a.totalMeasures_squareMetersCoveredTerraces||0)+(a.totalMeasures_squareMetersUncoveredTerraces||0);return S?S+" m\xb2":""}},{key:"plot",label:"Parcela",size:"small",extraString:" m\xb2",fn:a=>null!=a&&a.totalMeasures_squareMetersPatch?a.totalMeasures_squareMetersPatch+" m\xb2":""},{key:"bedrooms",label:"Dorm.",size:"small"},{key:"bathrooms",label:"Ba\xf1os",size:"small"},{key:"pool",label:"Piscina",size:"small",fn:a=>a.f_pool_comunitaria?"Comunitaria":a.f_pool_privada?"Privada":"No"},{key:"storage",label:"Trastero",size:"small",fn:a=>a.fcustom_trastero?a.fcustom_trasteroPrice?this.utils.transformThousandSeparator(a.fcustom_trasteroPrice)+" \u20ac":a.fcustom_trasteroIncludedInPrice?"Incluido":"S\xed":"No"},{key:"parking",label:"Parking",size:"small",fn:a=>{let v=a.fcustom_parking?"S\xed":"No";return a.fcustom_parkingPrice&&(v=this.utils.transformThousandSeparator(a.fcustom_parkingPrice)+" \u20ac"),a.fcustom_parkingIncludedInPrice&&(v="Incluido"),a.fcustom_parkingComunitario&&(v+=" (Comunitario)"),v}},{key:"price",label:"Precio",size:"small",fn:a=>null!=a&&a.price?this.utils.transformThousandSeparator(a.price)+" \u20ac":""}],rows:[]}}ngOnInit(){}set selectedPromotion(t){this.promotion=t,this.getData()}getData(){var t;if(this.promotion){this.allColumnsKeysSelected=(null===(t=this.promotion)||void 0===t?void 0:t.tableColumnsKeysSelected)||this.allColumnsKeysSelected,this.blocks=this.promotion.promotionBlocks||[];for(let n=0;n<this.blocks.length;n++){const r=this.blocks[n];!r.properties||0===r.properties.length||(r.tableConfig=c.cloneDeep(this.tableConfig),r.tableConfig.rows=this.tableService.convertDataToTableRows(c.cloneDeep(r.properties),c.cloneDeep(r.tableConfig)),r.tableConfig.rows=this.addBackgroundColorsToTableRows(r.tableConfig.rows))}}}addBackgroundColorsToTableRows(t){for(let n=0;n<t.length;n++)switch(t[n].rawObject.availabilityStatus){case"available":t[n].style={backgroundColor:"success"};break;case"sold":t[n].style={backgroundColor:"red"};break;case"reserved":t[n].style={backgroundColor:"warning"};break;default:t[n].style={backgroundColor:"blocked"}}return t}onRowClicked(t){const n=t.rawObject;console.log("Row clicked, property:",n),this.selectProperty.emit(n)}}return(o=d).\u0275fac=function(t){return new(t||o)(e.rXU(m.a),e.rXU(C.T),e.rXU(h.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-property"]],outputs:{selectProperty:"selectProperty"},decls:5,vars:1,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[4,"ngFor","ngForOf"],[1,"block-title"],[2,"margin-bottom","16px",3,"rowClicked","table"],[2,"margin-bottom","16px"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 2. Vivienda principal "),e.k0s(),e.j41(3,"div",2),e.DNE(4,M,5,2,"ng-container",3),e.k0s()()),2&t&&(e.R7$(4),e.Y8G("ngForOf",n.blocks))},dependencies:[p.Sq,j.O],styles:[".block-title[_ngcontent-%COMP%]{margin-bottom:16px;font-size:14px;font-weight:500}"]}),d})();var I=u(4558);function G(o,d){if(1&o&&(e.j41(0,"option",21),e.EFF(1),e.k0s()),2&o){const i=d.$implicit;e.Y8G("value",i),e.R7$(),e.JRh(i)}}function q(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",22),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.editingPrice=!0)}),e.EFF(1),e.nI1(2,"thousandSeparator"),e.nrm(3,"i",23),e.k0s()}if(2&o){const i=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,i.priceSelected.priceWithoutIva)," \u20ac ")}}function J(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",24)(1,"input",25),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG();return e.DH7(r.priceSelected.priceWithoutIva,n)||(r.priceSelected.priceWithoutIva=n),e.Njj(n)}),e.k0s(),e.j41(2,"i",26),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onPriceConfirm())}),e.k0s()()}if(2&o){const i=e.XpG();e.R7$(),e.R50("ngModel",i.priceSelected.priceWithoutIva)}}let H=(()=>{var o;class d{constructor(){this.selectPrice=new e.bkB,this.priceSelected={priceWithoutIva:0,priceWithIva:0,finalPrice:0,iva:10},this.taxRates=["0%","10%","21%"],this.selectedTaxRate="10%",this.editingPrice=!1}set selectedProperty(t){this.property=t,this.priceSelected.priceWithoutIva=(null==t?void 0:t.price)||0,this.updateCalculations()}ngOnInit(){this.updateCalculations()}onTaxRateChange(){this.updateCalculations()}onPriceConfirm(){this.updateCalculations(),this.editingPrice=!1}updateCalculations(){const t=parseFloat(this.selectedTaxRate);this.priceSelected.iva=isNaN(t)?0:t,this.priceSelected.priceWithIva=this.priceSelected.priceWithoutIva*(this.priceSelected.iva/100),this.priceSelected.finalPrice=this.priceSelected.priceWithoutIva+this.priceSelected.priceWithIva}goNextSection(){this.selectPrice.emit(this.priceSelected),console.log("Go to the next section...")}}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-price"]],outputs:{selectPrice:"selectPrice"},decls:48,vars:17,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"max-width","200px","margin-bottom","24px"],[1,"crm-input-label"],[1,"crm-input-input","crm-input-input-searchbar-square"],[3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"title",2,"margin-bottom","8px"],[1,"price-table-header",2,"padding","0px 16px"],[1,"price-table-header-cell"],[1,"price-table"],[1,"price-table-row"],[1,"price-table-cell"],[1,"price-table-cell","editable-cell"],["class","editable-price-display",3,"click",4,"ngIf"],["class","editable-price-edit",4,"ngIf"],[1,"price-table-footer"],[1,"price-table-footer-cell"],[1,"crm-block-buttons-right",2,"margin-top","16px"],[1,"crm-button",3,"click"],[3,"value"],[1,"editable-price-display",3,"click"],[1,"fas","fa-pencil",2,"color","rgb(130, 130, 130)"],[1,"editable-price-edit"],["type","number",3,"ngModelChange","ngModel"],[1,"fas","fa-check",2,"color","rgb(11, 169, 11)",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 3. Por precio "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.EFF(6," Impuestos IVA/IT "),e.k0s(),e.j41(7,"div",5)(8,"select",6),e.mxI("ngModelChange",function(a){return e.DH7(n.selectedTaxRate,a)||(n.selectedTaxRate=a),a}),e.bIt("change",function(){return n.onTaxRateChange()}),e.DNE(9,G,2,2,"option",7),e.k0s()()(),e.j41(10,"div",8),e.EFF(11," Tabla de precios "),e.k0s(),e.j41(12,"div",9)(13,"div",10),e.EFF(14,"Vivienda"),e.k0s(),e.j41(15,"div",10),e.EFF(16,"Precio"),e.k0s(),e.j41(17,"div",10),e.EFF(18,"IVA/ITP"),e.k0s(),e.j41(19,"div",10),e.EFF(20,"PVP"),e.k0s()(),e.j41(21,"div",11)(22,"div",12)(23,"div",13),e.EFF(24," 1A "),e.k0s(),e.j41(25,"div",14),e.DNE(26,q,4,3,"div",15)(27,J,3,1,"div",16),e.k0s(),e.j41(28,"div",13),e.EFF(29),e.k0s(),e.j41(30,"div",13),e.EFF(31),e.nI1(32,"thousandSeparator"),e.k0s()(),e.j41(33,"div",17)(34,"div",18),e.EFF(35," Total "),e.k0s(),e.j41(36,"div",18),e.EFF(37),e.nI1(38,"thousandSeparator"),e.k0s(),e.j41(39,"div",18),e.EFF(40),e.nI1(41,"thousandSeparator"),e.k0s(),e.j41(42,"div",18),e.EFF(43),e.nI1(44,"thousandSeparator"),e.k0s()()(),e.j41(45,"div",19)(46,"button",20),e.bIt("click",function(){return n.goNextSection()}),e.EFF(47," Ir a la siguiente secci\xf3n "),e.k0s()()()()),2&t&&(e.R7$(8),e.R50("ngModel",n.selectedTaxRate),e.R7$(),e.Y8G("ngForOf",n.taxRates),e.R7$(17),e.Y8G("ngIf",!n.editingPrice),e.R7$(),e.Y8G("ngIf",n.editingPrice),e.R7$(2),e.SpI(" ",n.selectedTaxRate," "),e.R7$(2),e.SpI(" ",e.bMT(32,9,n.priceSelected.finalPrice)," \u20ac "),e.R7$(6),e.SpI(" ",e.bMT(38,11,n.priceSelected.priceWithoutIva)," \u20ac "),e.R7$(3),e.SpI(" ",e.bMT(41,13,n.priceSelected.priceWithIva)," \u20ac "),e.R7$(3),e.SpI(" ",e.bMT(44,15,n.priceSelected.finalPrice)," \u20ac "))},dependencies:[p.Sq,p.bT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.vS,I.w],styles:[".venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .crm-input[_ngcontent-%COMP%]{margin-bottom:16px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table-header[_ngcontent-%COMP%]{display:flex;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table-header[_ngcontent-%COMP%]   .price-table-header-cell[_ngcontent-%COMP%]{flex:1;font-size:14px;padding:8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]{border-radius:12px;padding:0 16px;background:#f9f9f9}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%], .venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 0;border-bottom:1px solid var(--crm-border-light-color)}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer[_ngcontent-%COMP%]{font-weight:500;border:none}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-cell[_ngcontent-%COMP%], .venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-footer-cell[_ngcontent-%COMP%]{flex:1;font-size:14px;padding:8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-cell[_ngcontent-%COMP%]{display:flex;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]{cursor:pointer;display:inline-flex;gap:8px;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-display[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color)}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]{display:inline-flex;gap:8px;align-items:center}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:120px;background:#fff;outline:none;border:1px solid var(--crm-border-light-color);border-radius:8px;padding:4px 8px}.venta-component[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .price-table[_ngcontent-%COMP%]   .price-table-row[_ngcontent-%COMP%]   .editable-price-edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--crm-text-color);cursor:pointer}"]}),d})();const Z=o=>({"text-error":o}),Q=o=>({"border-error":o});let ee=(()=>{var o;class d{constructor(){this.selectDocumentData=new e.bkB,this.reservationAmountError=!1,this.formData={contractType:"propio",signatureType:"papel",reservationAmount:null}}ngOnInit(){}onContinue(){console.log("Form data:",this.formData),this.reservationAmountError=!1,this.formData.reservationAmount?this.selectDocumentData.emit(this.formData):this.reservationAmountError=!0}}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-document"]],outputs:{selectDocumentData:"selectDocumentData"},decls:44,vars:9,consts:[[1,"venta-component"],[1,"title"],[1,"content"],[1,"crm-input",2,"margin-bottom","16px"],[1,"crm-text"],[3,"ngModelChange","ngModel"],[1,"crm-input-radio"],["value","byvaro"],[1,"crm-input-radio-label"],["value","propio"],[2,"border","none","border-bottom","1px solid #e5e5e5","margin","24px 0"],["value","electronica"],["value","papel"],[1,"title","mb8"],[1,"crm-text","small","light","mb16"],[1,"crm-input",2,"margin-bottom","24px","max-width","300px"],[1,"crm-input-label",3,"ngClass"],[1,"crm-input-input",3,"ngClass"],["type","number","placeholder","Por ejemplo 3000\u20ac",3,"ngModelChange","ngModel"],[1,"crm-block-buttons-right"],[1,"crm-button",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," 4. Documento de reserva "),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4),e.EFF(6," Redacci\xf3n del contrato: "),e.k0s(),e.j41(7,"ion-radio-group",5),e.mxI("ngModelChange",function(a){return e.DH7(n.formData.contractType,a)||(n.formData.contractType=a),a}),e.j41(8,"div",6),e.nrm(9,"ion-radio",7),e.j41(10,"div",8),e.EFF(11," Contrato redactado en Byvaro "),e.k0s()(),e.j41(12,"div",6),e.nrm(13,"ion-radio",9),e.j41(14,"div",8),e.EFF(15," Contrato propio "),e.k0s()()()(),e.nrm(16,"hr",10),e.j41(17,"div",3)(18,"div",4),e.EFF(19," T\xe9rminos y condiciones de la firma: "),e.k0s(),e.j41(20,"ion-radio-group",5),e.mxI("ngModelChange",function(a){return e.DH7(n.formData.signatureType,a)||(n.formData.signatureType=a),a}),e.j41(21,"div",6),e.nrm(22,"ion-radio",11),e.j41(23,"div",8),e.EFF(24," Firma electr\xf3nica "),e.k0s()(),e.j41(25,"div",6),e.nrm(26,"ion-radio",12),e.j41(27,"div",8),e.EFF(28," Firma en papel "),e.k0s()()()(),e.nrm(29,"hr",10),e.j41(30,"div",13),e.EFF(31," Cantidad que debe pagar el cliente para reservar: "),e.k0s(),e.j41(32,"div",14),e.EFF(33," Este campo puede heredar autom\xe1ticamente el valor definido en la configuraci\xf3n de la promoci\xf3n."),e.nrm(34,"br"),e.EFF(35," Por favor, rev\xedsalo antes de continuar. "),e.k0s(),e.j41(36,"div",15)(37,"div",16),e.EFF(38," Cantidad de reserva (\u20ac) "),e.k0s(),e.j41(39,"div",17)(40,"input",18),e.mxI("ngModelChange",function(a){return e.DH7(n.formData.reservationAmount,a)||(n.formData.reservationAmount=a),a}),e.k0s()()(),e.j41(41,"div",19)(42,"button",20),e.bIt("click",function(){return n.onContinue()}),e.EFF(43," Continuar la reserva "),e.k0s()()()()),2&t&&(e.R7$(7),e.R50("ngModel",n.formData.contractType),e.R7$(13),e.R50("ngModel",n.formData.signatureType),e.R7$(17),e.Y8G("ngClass",e.eq3(5,Z,n.reservationAmountError)),e.R7$(2),e.Y8G("ngClass",e.eq3(7,Q,n.reservationAmountError)),e.R7$(),e.R50("ngModel",n.formData.reservationAmount))},dependencies:[p.YU,s.me,s.Q0,s.BC,s.vS,f.KO,f.f0,f.Je],styles:[".crm-text[_ngcontent-%COMP%]{font-style:normal;margin-bottom:8px}.crm-input-radio[_ngcontent-%COMP%]{margin-bottom:8px}ion-radio-group[_ngcontent-%COMP%]{display:flex;gap:16px}.mb8[_ngcontent-%COMP%]{margin-bottom:8px}.mb16[_ngcontent-%COMP%]{margin-bottom:16px}"]}),d})();var N=u(6906),te=u(1129);const T=o=>({"crm-input-input-error":o});function ne(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," Por favor, introduce un correo electr\xf3nico v\xe1lido "),e.k0s())}function oe(o,d){if(1&o&&(e.j41(0,"option",12),e.EFF(1),e.k0s()),2&o){const i=d.$implicit;e.FS9("value",i.key),e.R7$(),e.JRh(i.label)}}function re(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," El nombre es requerido "),e.k0s())}function ie(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," La fecha de nacimiento es requerida "),e.k0s())}function ae(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," El n\xfamero de tel\xe9fono es requerido "),e.k0s())}function le(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," El DNI o Pasaporte es requerido "),e.k0s())}function se(o,d){1&o&&(e.j41(0,"div",43),e.EFF(1," Error "),e.k0s())}function ce(o,d){1&o&&(e.j41(0,"div",14),e.nrm(1,"ion-radio",44),e.j41(2,"div",27),e.EFF(3," Gananciales "),e.k0s()(),e.j41(4,"div",28),e.nrm(5,"ion-radio",45),e.j41(6,"div",27),e.EFF(7," Separacion de bienes "),e.k0s()())}function de(o,d){1&o&&(e.j41(0,"div",14),e.nrm(1,"ion-radio",46),e.j41(2,"div",27),e.EFF(3," Soltera "),e.k0s()(),e.j41(4,"div",28),e.nrm(5,"ion-radio",47),e.j41(6,"div",27),e.EFF(7," Separada "),e.k0s()(),e.j41(8,"div",28),e.nrm(9,"ion-radio",48),e.j41(10,"div",27),e.EFF(11," Divorciada "),e.k0s()(),e.j41(12,"div",28),e.nrm(13,"ion-radio",49),e.j41(14,"div",27),e.EFF(15," Viuda "),e.k0s()(),e.j41(16,"div",28),e.nrm(17,"ion-radio",50),e.j41(18,"div",27),e.EFF(19," Pareja de hecho "),e.k0s()())}let pe=(()=>{var o;class d{constructor(){this.responsibilityOptions=N.Rl}ngOnInit(){}isControlInvalid(t){const n=this.form.get(t);return!(!n||!n.invalid||!n.dirty&&!n.touched)}onSelectCountry(t){}onNextStep(){}onChangeMaritalType(t){var n;null===(n=this.form.get("maritalType"))||void 0===n||n.setValue(t)}}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-person-form"]],inputs:{form:"form"},decls:109,vars:25,consts:[["addressInput",""],[3,"ngSubmit","formGroup"],[1,"crm-input",2,"margin-bottom","8px"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass"],["type","text","placeholder","Field","formControlName","email"],["class","crm-input-error",4,"ngIf"],[1,"crm-text","small","light","mb-15"],[1,"crm-input","mb-15"],[1,"crm-input-input"],["formControlName","role",1,"w-full"],["disabled","","selected","",3,"value"],[3,"value"],["formControlName","gender",1,"d-flex","gap-16"],[1,"crm-input-radio"],["value","male"],[1,"crm-input-radio-label"],["value","female"],["type","text","placeholder","ex: Juan","formControlName","name"],["type","date","formControlName","birthDate"],[1,"crm-input"],[1,"crm-input-input-and-icon"],[3,"emitCountrySelected","selectedPhoneNumber"],["type","text","placeholder","N\xfamero de tel\xe9fono","formControlName","phoneNumber"],[1,"crm-text","small","light",2,"margin-bottom","8px"],["formControlName","identityType",1,"gap-16"],["value","dni"],[1,"crm-input-radio-label","text-secondary"],[1,"crm-input-radio","mt-10"],["value","nif"],["value","nie"],["value","passport"],["value","identityCard"],[1,"crm-input-input","mt-10",3,"ngClass"],["type","text","placeholder","ex: 48500285A","formControlName","identityNumber"],[1,"crm-input",2,"margin-bottom","16px"],["type","text","formControlName","address","placeholder","Escribe la direcci\xf3n"],["type","number","formControlName","participationPercentage","placeholder","%"],["formControlName","maritalType",1,"d-flex","gap-16"],[1,"crm-input-radio",3,"click"],["value","married"],["value","other"],["formControlName","maritalStatus",1,"gap-16"],[1,"crm-input-error"],["value","communityProperty"],["value","separateProperty"],["value","single"],["value","separated"],["value","divorced"],["value","widowed"],["value","civilUnion"]],template:function(t,n){if(1&t){const r=e.RV6();e.j41(0,"form",1),e.bIt("ngSubmit",function(){return e.eBV(r),e.Njj(n.onNextStep())}),e.j41(1,"div",2)(2,"div",3),e.EFF(3," Correo electr\xf3nico "),e.k0s(),e.j41(4,"div",4),e.nrm(5,"input",5),e.k0s(),e.DNE(6,ne,2,0,"div",6),e.k0s(),e.j41(7,"div",7),e.EFF(8," Por favor, compruebe que la direcci\xf3n de correo electr\xf3nico ingresada es correcta. "),e.k0s(),e.j41(9,"div",8)(10,"div",3),e.EFF(11," Role "),e.k0s(),e.j41(12,"div",9)(13,"select",10)(14,"option",11),e.EFF(15,"Selecciona un origen"),e.k0s(),e.Z7z(16,oe,2,2,"option",12,e.fX1),e.k0s()()(),e.j41(18,"div",8)(19,"ion-radio-group",13)(20,"div",14),e.nrm(21,"ion-radio",15),e.j41(22,"div",16),e.EFF(23," Don "),e.k0s()(),e.j41(24,"div",14),e.nrm(25,"ion-radio",17),e.j41(26,"div",16),e.EFF(27," Do\xf1a "),e.k0s()()()(),e.j41(28,"div",8)(29,"div",3),e.EFF(30," Nombre y apellidos "),e.k0s(),e.j41(31,"div",4),e.nrm(32,"input",18),e.k0s(),e.DNE(33,re,2,0,"div",6),e.k0s(),e.j41(34,"div",8)(35,"div",3),e.EFF(36," Fecha de nacimiento "),e.k0s(),e.j41(37,"div",9),e.nrm(38,"input",19),e.k0s(),e.DNE(39,ie,2,0,"div",6),e.k0s(),e.j41(40,"div",20)(41,"div",3),e.EFF(42," Phone number "),e.k0s(),e.j41(43,"div",21)(44,"div",4)(45,"app-flag-country-selector",22),e.bIt("emitCountrySelected",function(v){return e.eBV(r),e.Njj(n.onSelectCountry(v))}),e.k0s(),e.nrm(46,"input",23),e.k0s()(),e.DNE(47,ae,2,0,"div",6),e.j41(48,"div",24),e.EFF(49," Por favor, compruebe que el n\xfamero de tel\xe9fono m\xf3vil ingresado es correcto. Ser\xe1 utilizado para la firma electr\xf3nica."),e.nrm(50,"br")(51,"br"),e.k0s()(),e.j41(52,"div",8)(53,"div",3),e.EFF(54," Identificaci\xf3n "),e.k0s(),e.j41(55,"ion-radio-group",25)(56,"div",14),e.nrm(57,"ion-radio",26),e.j41(58,"div",27),e.EFF(59," DNI "),e.k0s()(),e.j41(60,"div",28),e.nrm(61,"ion-radio",29),e.j41(62,"div",27),e.EFF(63," NIF "),e.k0s()(),e.j41(64,"div",28),e.nrm(65,"ion-radio",30),e.j41(66,"div",27),e.EFF(67," NIE "),e.k0s()(),e.j41(68,"div",28),e.nrm(69,"ion-radio",31),e.j41(70,"div",27),e.EFF(71," Pasaporte "),e.k0s()(),e.j41(72,"div",28),e.nrm(73,"ion-radio",32),e.j41(74,"div",27),e.EFF(75," Carta de identidad "),e.k0s()()(),e.j41(76,"div",33),e.nrm(77,"input",34),e.k0s(),e.DNE(78,le,2,0,"div",6),e.k0s(),e.j41(79,"div",35)(80,"div",3),e.EFF(81," Direcci\xf3n "),e.k0s(),e.j41(82,"div",9),e.nrm(83,"input",36,0),e.k0s()(),e.j41(85,"div",8)(86,"div",3),e.EFF(87," Nombre de la empresa "),e.k0s(),e.j41(88,"div",4),e.nrm(89,"input",37),e.k0s(),e.DNE(90,se,2,0,"div",6),e.k0s(),e.j41(91,"div",8)(92,"div",3),e.EFF(93," Estado civil "),e.k0s(),e.j41(94,"ion-radio-group",38)(95,"div",39),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onChangeMaritalType("married"))}),e.nrm(96,"ion-radio",40),e.j41(97,"div",16),e.EFF(98," Casada "),e.k0s()(),e.j41(99,"div",39),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onChangeMaritalType("other"))}),e.nrm(100,"ion-radio",41),e.j41(101,"div",16),e.EFF(102," Otro "),e.k0s()()()(),e.j41(103,"div",35)(104,"div",3),e.EFF(105," Precise "),e.k0s(),e.j41(106,"ion-radio-group",42),e.DNE(107,ce,8,0)(108,de,20,0),e.k0s()()()}if(2&t){let r,a;e.Y8G("formGroup",n.form),e.R7$(4),e.Y8G("ngClass",e.eq3(15,T,n.isControlInvalid("email"))),e.R7$(2),e.Y8G("ngIf",n.isControlInvalid("email")),e.R7$(8),e.Y8G("value",null),e.R7$(2),e.Dyx(n.responsibilityOptions),e.R7$(15),e.Y8G("ngClass",e.eq3(17,T,n.isControlInvalid("name"))),e.R7$(2),e.Y8G("ngIf",n.isControlInvalid("name")),e.R7$(6),e.Y8G("ngIf",n.isControlInvalid("birthDate")),e.R7$(5),e.Y8G("ngClass",e.eq3(19,T,n.isControlInvalid("phoneNumber"))),e.R7$(),e.Y8G("selectedPhoneNumber",null==(r=n.form.get("phoneNumber"))?null:r.value),e.R7$(2),e.Y8G("ngIf",n.isControlInvalid("phoneNumber")),e.R7$(29),e.Y8G("ngClass",e.eq3(21,T,n.isControlInvalid("identityNumber"))),e.R7$(2),e.Y8G("ngIf",n.isControlInvalid("identityNumber")),e.R7$(10),e.Y8G("ngClass",e.eq3(23,T,n.isControlInvalid("participationPercentage"))),e.R7$(2),e.Y8G("ngIf",n.isControlInvalid("participationPercentage")),e.R7$(17),e.vxM("married"===(null==(a=n.form.get("maritalType"))?null:a.value)?107:108)}},dependencies:[p.YU,p.bT,s.qT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.cb,f.KO,f.f0,f.Je,s.j4,s.JD,te.Z]}),d})();const ue=["addressInput"],K=o=>({"background-color":o}),V=o=>({"crm-input-input-error":o});function me(o,d){if(1&o&&(e.j41(0,"div",15),e.EFF(1),e.k0s()),2&o){let i;const t=e.XpG(2).$implicit;e.R7$(),e.JRh(null==(i=t.get("name"))?null:i.value)}}function _e(o,d){1&o&&e.nrm(0,"img",5),2&o&&e.Y8G("src","assets/icon/chevron-down-icon.svg",e.B4B)}function ve(o,d){1&o&&e.nrm(0,"img",5),2&o&&e.Y8G("src","assets/icon/chevron-up-icon.svg",e.B4B)}function ge(o,d){if(1&o){const i=e.RV6();e.j41(0,"div"),e.nrm(1,"app-person-form",18),e.j41(2,"div",19)(3,"button",20),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2).index,r=e.XpG();return e.Njj(r.onSaveContact(n))}),e.EFF(4," Guardar "),e.k0s()()()}if(2&o){const i=e.XpG(2).index,t=e.XpG();e.R7$(),e.Y8G("form",t.getContactForm(i))}}function Ce(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",13)(1,"div",14)(2,"div"),e.EFF(3),e.k0s(),e.DNE(4,me,2,1,"div",15),e.k0s(),e.j41(5,"div",16),e.bIt("click",function(){e.eBV(i);const n=e.XpG().index,r=e.XpG();return e.Njj(r.togglePersonForm(n))}),e.DNE(6,_e,1,1,"img",5)(7,ve,1,1,"img",5),e.k0s()(),e.DNE(8,ge,5,1,"div",17)}if(2&o){let i,t,n;const r=e.XpG(),a=r.$implicit,v=r.index;e.R7$(3),e.SpI(" Comprador ",v+1,""),e.R7$(),e.vxM(null!=(i=a.get("showForm"))&&i.value?-1:4),e.R7$(2),e.vxM(null!=(t=a.get("showForm"))&&t.value?6:7),e.R7$(2),e.Y8G("ngIf",null==(n=a.get("showForm"))?null:n.value)}}function fe(o,d){1&o&&e.nrm(0,"img",5),2&o&&e.Y8G("src","assets/icon/chevron-down-icon.svg",e.B4B)}function he(o,d){1&o&&e.nrm(0,"img",5),2&o&&e.Y8G("src","assets/icon/chevron-up-icon.svg",e.B4B)}function Pe(o,d){if(1&o&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&o){const i=d.$implicit;e.FS9("value",i.key),e.R7$(),e.JRh(i.label)}}function ye(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",35)(1,"div",36)(2,"div",24),e.EFF(3," Role "),e.k0s(),e.j41(4,"div",37)(5,"select",38)(6,"option",39),e.EFF(7,"Selecciona un origen"),e.k0s(),e.Z7z(8,Pe,2,2,"option",40,e.fX1),e.k0s()()(),e.j41(10,"div")(11,"img",41),e.bIt("click",function(){e.eBV(i);const n=e.XpG().index,r=e.XpG(3).index,a=e.XpG();return e.Njj(a.removePersonFromCompany(r,n))}),e.k0s()()()}if(2&o){const i=e.XpG().index,t=e.XpG(3).index,n=e.XpG();e.Y8G("formGroup",n.getCompanyPersonForm(t,i)),e.R7$(6),e.Y8G("value",null),e.R7$(2),e.Dyx(n.responsibilityOptions),e.R7$(3),e.Y8G("src","assets/icon/trash-icon.svg",e.B4B)}}function be(o,d){if(1&o&&(e.j41(0,"div",15),e.EFF(1),e.k0s()),2&o){let i;const t=e.XpG(2).index,n=e.XpG(3).index,r=e.XpG();e.R7$(),e.JRh(null==(i=r.getCompanyPersonForm(n,t).get("name"))?null:i.value)}}function Fe(o,d){if(1&o){const i=e.RV6();e.j41(0,"img",45),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2).index,r=e.XpG(3).index,a=e.XpG();return e.Njj(a.toggleCompanyPersonForm(r,n))}),e.k0s()}2&o&&e.Y8G("src","assets/icon/chevron-down-icon.svg",e.B4B)}function ke(o,d){if(1&o){const i=e.RV6();e.j41(0,"img",45),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2).index,r=e.XpG(3).index,a=e.XpG();return e.Njj(a.toggleCompanyPersonForm(r,n))}),e.k0s()}2&o&&e.Y8G("src","assets/icon/chevron-up-icon.svg",e.B4B)}function xe(o,d){if(1&o){const i=e.RV6();e.nrm(0,"app-person-form",18),e.j41(1,"div",6)(2,"button",46),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2).index,r=e.XpG(3).index,a=e.XpG();return e.Njj(a.removePersonFromCompany(r,n))}),e.EFF(3," Eliminar "),e.k0s(),e.j41(4,"button",47),e.bIt("click",function(){e.eBV(i);const n=e.XpG(5).index,r=e.XpG();return e.Njj(r.onSaveContact(n))}),e.EFF(5," Guardar "),e.k0s()()}if(2&o){const i=e.XpG(2).index,t=e.XpG(3).index,n=e.XpG();e.Y8G("form",n.getCompanyPersonForm(t,i))}}function je(o,d){if(1&o&&(e.j41(0,"div")(1,"div",42)(2,"div")(3,"div"),e.EFF(4),e.k0s(),e.DNE(5,be,2,1,"div",15),e.k0s(),e.j41(6,"div",43),e.DNE(7,Fe,1,1,"img",44)(8,ke,1,1,"img",44),e.k0s()(),e.DNE(9,xe,6,1),e.k0s()),2&o){let i,t,n,r;const a=e.XpG(),v=a.$implicit,x=a.index,S=e.XpG(3).index,O=e.XpG();e.R7$(4),e.JRh(O.responsibilityOptionsObj[null==(i=O.getCompanyPersonForm(S,x).get("role"))?null:i.value]),e.R7$(),e.vxM(null!=(t=v.get("showForm"))&&t.value?-1:5),e.R7$(2),e.vxM(null!=(n=v.get("showForm"))&&n.value?7:8),e.R7$(2),e.vxM(null!=(r=v.get("showForm"))&&r.value?9:-1)}}function Se(o,d){if(1&o&&(e.j41(0,"div")(1,"div",33),e.DNE(2,ye,12,3,"div",34)(3,je,10,4,"div",17),e.k0s()()),2&o){let i,t;const n=d.index,r=e.XpG(3).index,a=e.XpG();e.R7$(2),e.Y8G("ngIf",!(null!=(i=a.getCompanyPersonForm(r,n).get("role"))&&i.value)),e.R7$(),e.Y8G("ngIf",null==(t=a.getCompanyPersonForm(r,n).get("role"))?null:t.value)}}function Ee(o,d){if(1&o){const i=e.RV6();e.j41(0,"div")(1,"form",22)(2,"div",13)(3,"div",23)(4,"div",24),e.EFF(5," Nombre de la empresa "),e.k0s(),e.j41(6,"div",25),e.nrm(7,"input",26),e.k0s()(),e.j41(8,"div",27)(9,"div",24),e.EFF(10," Direcci\xf3n "),e.k0s(),e.j41(11,"div",25),e.nrm(12,"input",28),e.k0s()()(),e.j41(13,"div",13)(14,"div",23)(15,"div",24),e.EFF(16," CIF "),e.k0s(),e.j41(17,"div",25),e.nrm(18,"input",29),e.k0s()(),e.j41(19,"div",27)(20,"div",24),e.EFF(21," Porcentaje de participaci\xf3n "),e.k0s(),e.j41(22,"div",25),e.nrm(23,"input",30),e.k0s()()(),e.DNE(24,Se,4,2,"div",31),e.j41(25,"div",32)(26,"button",4),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2).index,r=e.XpG();return e.Njj(r.addPersonToCompany(n))}),e.nrm(27,"img",5),e.EFF(28," A\xf1adir persona responsable "),e.k0s()()()()}if(2&o){let i;const t=e.XpG(2).index,n=e.XpG();e.R7$(),e.Y8G("formGroup",n.getCompanyForm(t)),e.R7$(5),e.Y8G("ngClass",e.eq3(7,V,n.isControlInvalid(n.getContactForm(t),"name"))),e.R7$(5),e.Y8G("ngClass",e.eq3(9,V,n.isControlInvalid(n.getContactForm(t),"address"))),e.R7$(6),e.Y8G("ngClass",e.eq3(11,V,n.isControlInvalid(n.getContactForm(t),"cif"))),e.R7$(5),e.Y8G("ngClass",e.eq3(13,V,n.isControlInvalid(n.getContactForm(t),"participationPercentage"))),e.R7$(2),e.Y8G("ngForOf",null==(i=n.getPersons(t))?null:i.controls),e.R7$(3),e.Y8G("src","assets/icon/plus-icon.svg",e.B4B)}}function Me(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",13)(1,"div",21),e.EFF(2),e.k0s(),e.j41(3,"div",16),e.bIt("click",function(){e.eBV(i);const n=e.XpG().index,r=e.XpG();return e.Njj(r.toggleCompanyForm(n))}),e.DNE(4,fe,1,1,"img",5)(5,he,1,1,"img",5),e.k0s()(),e.DNE(6,Ee,29,15,"div",17)}if(2&o){let i,t;const n=e.XpG(),r=n.$implicit,a=n.index;e.R7$(2),e.SpI("Comprador ",a+1,""),e.R7$(2),e.vxM(null!=(i=r.get("showForm"))&&i.value?4:5),e.R7$(2),e.Y8G("ngIf",null==(t=r.get("showForm"))?null:t.value)}}function Oe(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12),e.bIt("click",function(){const n=e.eBV(i).index,r=e.XpG();return e.Njj(r.onChangePersonType(n,"particular"))}),e.EFF(4," Personas f\xedsicas "),e.k0s(),e.j41(5,"div",12),e.bIt("click",function(){const n=e.eBV(i).index,r=e.XpG();return e.Njj(r.onChangePersonType(n,"empresa"))}),e.EFF(6," Persona jur\xeddica "),e.k0s()()(),e.DNE(7,Ce,9,4)(8,Me,7,3),e.k0s()}if(2&o){let i,t,n;const r=d.$implicit;e.R7$(3),e.Y8G("ngStyle",e.eq3(3,K,"particular"===(null==(i=r.get("type"))?null:i.value)?"#ECF2FF":"")),e.R7$(2),e.Y8G("ngStyle",e.eq3(5,K,"empresa"===(null==(t=r.get("type"))?null:t.value)?"#ECF2FF":"")),e.R7$(2),e.vxM("particular"===(null==(n=r.get("type"))?null:n.value)?7:8)}}let Te=(()=>{var o;class d{constructor(t,n,r,a){this.fb=t,this.ngZone=n,this.api=r,this.utils=a,this.selectContactData=new e.bkB,this.mapCenter={lat:40.416775,lng:-3.70379},this.mapZoom=6,this.markerPosition=this.mapCenter,this.mapOptions={disableDefaultUI:!1,styles:[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]}]},this.markerOptions={draggable:!0},this.personType="person",this.persons=[1],this.showForms=[],this.FormGroup=s.gE,this.responsibilityOptions=N.Rl,this.responsibilityOptionsObj=N.qA;const v=this.createContactForm("particular");this.contactFormArray=this.fb.array([v])}ngOnInit(){this.contact&&this.patchContactData()}createCompanyForm(){return this.fb.group({participationPercentage:["",[s.k0.required,s.k0.min(1),s.k0.max(100)]],address:[""],cif:[""],name:[""],persons:this.fb.array([]),showForm:[!0],type:["empresa"]})}createPersonForm(){return this.fb.group({email:["",[s.k0.required,s.k0.email]],name:["",s.k0.required],birthDate:["",s.k0.required],phoneNumber:["+34 ",s.k0.required],participationPercentage:["",[s.k0.required,s.k0.min(1),s.k0.max(100)]],identityNumber:["",s.k0.required],identityType:["dni",s.k0.required],address:["",s.k0.required],role:[""],gender:["male"],showForm:[!0],type:["particular"],maritalStatus:["communityProperty"],maritalType:["married"]})}createContactForm(t){var n;const r=this.fb.group({type:[t],showForm:[!0],name:[""],email:[""],phoneNumber:["+34 "],birthDate:[""],identityNumber:[""],identityType:["dni"],address:[""],role:[""],gender:["male"],maritalStatus:["communityProperty"],maritalType:["married"],participationPercentage:["",[s.k0.min(1),s.k0.max(100)]],cif:[""],persons:this.fb.array([])});return this.applyConditionalValidators(r,t),null===(n=r.get("type"))||void 0===n||n.valueChanges.subscribe(a=>{this.applyConditionalValidators(r,a)}),r}applyConditionalValidators(t,n){var r,a,v,x,S,O,$,w,B,A,X,Y,U,W;if(null===(r=t.get("email"))||void 0===r||r.clearValidators(),null===(a=t.get("phoneNumber"))||void 0===a||a.clearValidators(),null===(v=t.get("birthDate"))||void 0===v||v.clearValidators(),null===(x=t.get("identityNumber"))||void 0===x||x.clearValidators(),null===(S=t.get("address"))||void 0===S||S.clearValidators(),null===(O=t.get("cif"))||void 0===O||O.clearValidators(),"particular"===n)null===(B=t.get("email"))||void 0===B||B.setValidators([s.k0.required,s.k0.email]),null===(A=t.get("phoneNumber"))||void 0===A||A.setValidators([s.k0.required]),null===(X=t.get("birthDate"))||void 0===X||X.setValidators([s.k0.required]),null===(Y=t.get("identityNumber"))||void 0===Y||Y.setValidators([s.k0.required]),null===(U=t.get("address"))||void 0===U||U.setValidators([s.k0.required]),null===(W=t.get("role"))||void 0===W||W.setValidators([s.k0.required]);else if("empresa"===n){var L;null===(L=t.get("cif"))||void 0===L||L.setValidators([s.k0.required])}null===($=t.get("participationPercentage"))||void 0===$||$.setValidators([s.k0.required,s.k0.min(1),s.k0.max(100)]),null===(w=t.get("name"))||void 0===w||w.setValidators([s.k0.required]),Object.keys(t.controls).forEach(Ze=>{var z;null===(z=t.get(Ze))||void 0===z||z.updateValueAndValidity()})}removeCompany(t){this.contactFormArray.removeAt(t)}getCompanyForm(t){return this.contactFormArray.at(t)}getPersons(t){return this.getCompanyForm(t).get("persons")}getCompanyPersonForm(t,n){return this.getPersons(t).at(n)}addPersonToCompany(t){this.getPersons(t).push(this.createContactForm("particular"))}removePersonFromCompany(t,n){this.getPersons(t).removeAt(n)}toggleCompanyPersonForm(t,n){var r;const a=this.getCompanyPersonForm(t,n);a.patchValue({showForm:!(null!==(r=a.get("showForm"))&&void 0!==r&&r.value)})}toggleCompanyForm(t){var n;const r=this.getCompanyForm(t);r.patchValue({showForm:!(null!==(n=r.get("showForm"))&&void 0!==n&&n.value)})}addNewForm(){this.contactFormArray.push(this.createContactForm("particular"))}ngAfterViewInit(){this.addressInput&&(this.autocomplete=new google.maps.places.Autocomplete(this.addressInput.nativeElement,{types:["geocode"],componentRestrictions:{country:"es"}}),this.autocomplete.addListener("place_changed",()=>{this.ngZone.run(()=>{const n=this.autocomplete.getPlace();if(!n.geometry)return;this.mapCenter={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()},this.markerPosition=this.mapCenter,this.mapZoom=17;const r=n.formatted_address||n.name||"";this.contactForm.patchValue({address:r}),this.addressInput.nativeElement.value=r})}))}set contactData(t){this.contact=t,this.contact&&this.patchContactData()}patchContactData(){var t,n,r;const a=this.getContactForm(0);let v=this.utils.parseBackendDateToFrontendDateInput(null===(t=this.contact)||void 0===t?void 0:t.birthdate);a.patchValue({email:(null===(n=this.contact.emails)||void 0===n?void 0:n[0])||"",name:this.contact.name||"",birthDate:v||"",phoneNumber:(null===(r=this.contact.phones)||void 0===r?void 0:r[0])||"+34 ",dni:this.contact.dniPassport||"",address:this.contact.address||"",gender:this.contact.gender||"male"}),this.contactFormArray.setControl(0,a)}isControlInvalid(t,n){const r=t.get(n);return!(!r||!r.invalid||!r.dirty&&!r.touched)}onSelectCountry(t){console.log("Selected country prefix:",t);const n=null==t?void 0:t.phoneCode,r=this.contactForm.get("phoneNumber");if(!r)return;const v=(r.value||"").split(" ");v.shift();const x=v.join(" ");r.setValue(`${n} ${x}`)}onAddressSelected(t){console.log("Address selected:",t),this.contactForm.patchValue({address:(null==t?void 0:t.formatted_address)||(null==t?void 0:t.address)||""})}getAddressFromCoordinates(t,n){(new google.maps.Geocoder).geocode({location:{lat:t,lng:n}},(a,v)=>{"OK"===v&&a&&a[0]&&this.ngZone.run(()=>{const x=a[0].formatted_address;this.contactForm.patchValue({address:x}),this.addressInput&&(this.addressInput.nativeElement.value=x),this.markerPosition={lat:t,lng:n}})})}onPrevStep(){console.log("Going to previous step...")}onNextStep(){var t=this;return(0,y.A)(function*(){var n,r,a;if(t.contactFormArray.invalid)return void t.contactFormArray.markAllAsTouched();if(t.contactForm.invalid)return void t.contactForm.markAllAsTouched();let v=(null===(n=t.contact)||void 0===n?void 0:n.phones)||[];v.includes(t.contactForm.value.phoneNumber)||v.unshift(t.contactForm.value.phoneNumber);let x=(null===(r=t.contact)||void 0===r?void 0:r.emails)||[];x.includes(t.contactForm.value.email)||x.unshift(t.contactForm.value.email);const S={name:t.contactForm.value.name,birthdate:new Date(t.contactForm.value.birthDate),phones:v,emails:x,dniPassport:t.contactForm.value.dni,address:t.contactForm.value.address};(yield t.api.updateContactById(null===(a=t.contact)||void 0===a?void 0:a.id,S))&&(console.log("Form data:",t.contactForm.value),t.selectContactData.emit())})()}onChangePersonType(t,n){this.personType=n;const r=this.createContactForm(n),a=this.contactFormArray.at(t).value;console.log(a,"oldForm"),"empresa"===n||r.patchValue({name:a.name||"",email:a.email||"",address:a.address||"",birthDate:a.birthdate||"",phoneNumber:a.phoneNumber||"+34 ",gender:a.gender||"male"}),this.contactFormArray.setControl(t,r)}getContactForm(t){return this.contactFormArray.at(t)}togglePersonForm(t){var n;const r=this.getContactForm(t);r.patchValue({showForm:!(null!==(n=r.get("showForm"))&&void 0!==n&&n.value)})}onResponsibilitySelected(t){}onParticipationPercentageChange(t,n){console.log("Participation % changed to",t,"in group:",n)}removePerson(t){this.contactFormArray.removeAt(t)}onSaveContact(t){const n=this.getContactForm(t);n.invalid&&n.markAllAsTouched()}}return(o=d).\u0275fac=function(t){return new(t||o)(e.rXU(s.ok),e.rXU(e.SKi),e.rXU(g.i),e.rXU(C.T))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-select-contact-data"]],viewQuery:function(t,n){if(1&t&&e.GBs(ue,5),2&t){let r;e.mGM(r=e.lsd())&&(n.addressInput=r.first)}},inputs:{contact:"contact",contactData:"contactData"},outputs:{selectContactData:"selectContactData"},decls:12,vars:2,consts:[[1,"venta-component"],[1,"venta-component-body"],["class","content mt-15",4,"ngFor","ngForOf"],[1,"w-full"],["type","button",1,"crm-button-secondary","w-full","d-flex","justify-center","align-center",3,"click"],["alt","",1,"cursor-pointer",3,"src"],[1,"mt-10",2,"display","flex","gap","16px","justify-content","space-between"],["type","button",1,"crm-button-secondary","w-50p","d-block","text-center","border-primary",3,"click"],["type","submit",1,"crm-button","w-50p","d-block","text-center",3,"click"],[1,"content","mt-15"],[1,"",2,"border","1px solid #E0E0E0","width","100%","padding","6px","border-radius","20px","margin-bottom","16px"],[1,"d-flex","text-14"],[1,"cursor-pointer",2,"padding","6px 10px","border-radius","20px",3,"click","ngStyle"],[1,"d-flex","justify-between"],[1,"title","mb-10"],[1,"text-14","text-secondary","font-weight-400"],[1,"cursor-pointer",3,"click"],[4,"ngIf"],[3,"form"],[1,"mt-10",2,"gap","16px"],["type","button",1,"crm-button","w-full","d-block","text-center",2,"height","30px","padding","0",3,"click"],[1,"title"],[3,"formGroup"],[1,"crm-input","w-50p",2,"margin-bottom","8px"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass"],["type","text","placeholder","Field","formControlName","name"],[1,"crm-input","w-50p","ml-10",2,"margin-bottom","8px"],["type","text","placeholder","Field","formControlName","address"],["type","text","placeholder","Field","formControlName","cif"],["type","number","placeholder","%","formControlName","participationPercentage"],[4,"ngFor","ngForOf"],[1,"w-full","mt-20"],[1,"p-16","mt-10",2,"border","1px solid #EBEBEB","border-radius","12px"],["class","w-full  d-flex justify-between align-end",3,"formGroup",4,"ngIf"],[1,"w-full","d-flex","justify-between","align-end",3,"formGroup"],[1,"crm-input"],[1,"crm-input-input"],["formControlName","role",1,"w-full"],["disabled","","selected","",3,"value"],[3,"value"],["alt","",1,"cursor-pointer",3,"click","src"],[1,"d-flex","justify-between","mb-10"],[1,"d-flex","align-center"],["alt","",1,"cursor-pointer","ml-10",3,"src"],["alt","",1,"cursor-pointer","ml-10",3,"click","src"],["type","button",1,"crm-button-secondary","w-50p","d-block","text-center","border-secondary",2,"height","30px","padding","0",3,"click"],["type","submit",1,"crm-button","w-50p","d-block","text-center",2,"height","30px","padding","0",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,Oe,9,7,"div",2),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){return n.addNewForm()}),e.nrm(5,"img",5),e.EFF(6," A\xf1adir otro comprador "),e.k0s()()(),e.j41(7,"div",6)(8,"button",7),e.bIt("click",function(){return n.onPrevStep()}),e.EFF(9," Anterior "),e.k0s(),e.j41(10,"button",8),e.bIt("click",function(){return n.onNextStep()}),e.EFF(11," Siguiente "),e.k0s()()()),2&t&&(e.R7$(2),e.Y8G("ngForOf",n.contactFormArray.controls),e.R7$(3),e.Y8G("src","assets/icon/user-plus-icon.svg",e.B4B))},dependencies:[p.YU,p.Sq,p.bT,p.B3,s.qT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.cb,s.j4,s.JD,pe],styles:[".venta-component[_ngcontent-%COMP%]{max-width:500px}"]}),d})();const De=["selectPropertyComponent"],Ie=["selectPriceComponent"],D=o=>({"hidden-step":o}),Ve=(o,d)=>({"crm-steps-container-step-current":o,"crm-steps-container-step-inactive":d});function Re(o,d){1&o&&e.nrm(0,"i",24)}function Ge(o,d){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const i=e.XpG().index;e.R7$(),e.JRh(i+1)}}function Ne(o,d){1&o&&e.nrm(0,"div",25)}function $e(o,d){if(1&o&&(e.j41(0,"div",18)(1,"div",19),e.DNE(2,Re,1,0,"i",20)(3,Ge,2,1,"span",21),e.k0s(),e.j41(4,"div",22),e.EFF(5),e.k0s(),e.DNE(6,Ne,1,0,"div",23),e.k0s()),2&o){const i=d.$implicit,t=d.index,n=e.XpG();e.Y8G("ngClass",e.l_i(5,Ve,t==n.activeIndex,t>n.activeIndex)),e.R7$(2),e.Y8G("ngIf",t<n.activeIndex),e.R7$(),e.Y8G("ngIf",t>=n.activeIndex),e.R7$(2),e.SpI(" ",i," "),e.R7$(),e.Y8G("ngIf",t<n.steps.length-1)}}function we(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 1. Promoci\xf3n "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.changeStep(0))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(7),e.SpI(" ",null==i.data||null==i.data.promotion?null:i.data.promotion.projectName," ")}}function Be(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 2. Vivienda principal "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.changeStep(1))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(7),e.SpI(" ",null==i.data||null==i.data.property?null:i.data.property.reference," ")}}function Ae(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 3. Por precio "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.changeStep(2))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.nI1(8,"thousandSeparator"),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(7),e.SpI(" ",e.bMT(8,1,null==i.data||null==i.data.priceSelected?null:i.data.priceSelected.finalPrice)," \u20ac ")}}function Xe(o,d){if(1&o){const i=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30),e.EFF(3," 4. Documento de reserva "),e.k0s(),e.j41(4,"div",31),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.changeStep(3))}),e.nrm(5,"i",32),e.k0s()(),e.j41(6,"div",33),e.EFF(7),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(7),e.SpI(" ",null==i.data||null==i.data.documentData?null:i.data.documentData.contractType," ")}}function Ye(o,d){if(1&o&&(e.j41(0,"div",26),e.DNE(1,we,8,1,"div",27)(2,Be,8,1,"div",27)(3,Ae,9,3,"div",27)(4,Xe,8,1,"div",27),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.data?null:i.data.promotion),e.R7$(),e.Y8G("ngIf",null==i.data?null:i.data.property),e.R7$(),e.Y8G("ngIf",null==i.data||null==i.data.priceSelected?null:i.data.priceSelected.finalPrice),e.R7$(),e.Y8G("ngIf",null==i.data?null:i.data.documentData)}}const Ue=[{path:"",component:(()=>{var o;class d{constructor(t,n,r,a){this.api=t,this.route=n,this.toast=r,this.router=a,this.data={promotion:null,property:null,priceSelected:{priceWithoutIva:null,priceWithIva:null,finalPrice:null,iva:10},documentData:null},this.steps=["Promoci\xf3n","Vivienda principal","Por precio","Documento de reserva","Datos del cliente"],this.activeIndex=0}ngOnInit(){const t=this.route.snapshot.paramMap.get("operationId");t?this.api.getOperation({id:{equals:t}},null,null,{contact:{apply:!0,filter:null,onlyCount:!1},createdBy:{apply:!0,filter:null,onlyCount:!1},responsible:{apply:!0,filter:null,onlyCount:!1},mainProperty:{apply:!0,filter:null,onlyCount:!1},currentPipeline:{apply:!0,filter:null,onlyCount:!1},currentPipelineStep:{apply:!0,filter:null,onlyCount:!1},promotions:{apply:!0,filter:null,onlyCount:!1},selectedProperties:{apply:!0,filter:null,onlyCount:!1},notes:{apply:!0,filter:null,onlyCount:!1},operations:{apply:!0,filter:null,onlyCount:!1},operationRegisters:{apply:!0,filter:null,onlyCount:!1}}).then(n=>{n.success&&n.success.data&&n.success.data.length&&(this.operation=n.success.data[0],console.log("Retrieved operation:",this.operation))}).catch(n=>{console.error("Error retrieving operation:",n)}):console.warn("No operationId parameter found in the URL.")}onSelectPromotion(t){var n=this;return(0,y.A)(function*(){var r;n.data.promotion=t,n.activeIndex=1;const a=yield n.api.getPromotionFullDataById(n.data.promotion.id);n.data.promotion=null==a||null===(r=a.success)||void 0===r?void 0:r.data,n.selectPropertyComponent.selectedPromotion=n.data.promotion})()}onSelectProperty(t){var n=this;return(0,y.A)(function*(){n.data.property=t,n.selectPriceComponent.selectedProperty=t,n.activeIndex=2})()}onSelectPrice(t){this.data.priceSelected=t,this.activeIndex=3}onSelectDocumentData(t){this.data.documentData=t,this.activeIndex=4}onSelectContactData(){console.log("Contact data selected:",this.data.documentData),this.finishFlow()}finishFlow(){var t=this;return(0,y.A)(function*(){const n={propertyId:t.data.property.id,operationId:t.operation.id,priceSelected:t.data.priceSelected,documentData:t.data.documentData};(yield t.api.reserveProperty(n)).success?(t.toast.showSuccessToast("Reserva realizada correctamente"),t.router.navigate(["/contacts",t.operation.contactId,"operations",t.operation.id])):t.toast.showErrorToast("Error al realizar la reserva")})()}changeStep(t){this.activeIndex=t,0===t&&(this.data.property=null,this.data.priceSelected=null,this.data.documentData=null,this.selectPropertyComponent.selectedPromotion=null),1===t&&(this.data.priceSelected=null,this.data.documentData=null,this.selectPriceComponent.selectedProperty=null),console.log("DATAAAA",this.data)}}return(o=d).\u0275fac=function(t){return new(t||o)(e.rXU(g.i),e.rXU(P.nX),e.rXU(h.f),e.rXU(P.Ix))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-venta-operation-process"]],viewQuery:function(t,n){if(1&t&&(e.GBs(De,7),e.GBs(Ie,7)),2&t){let r;e.mGM(r=e.lsd())&&(n.selectPropertyComponent=r.first),e.mGM(r=e.lsd())&&(n.selectPriceComponent=r.first)}},decls:22,vars:19,consts:[["selectPropertyComponent",""],["selectPriceComponent",""],["selectClientComponent",""],[3,"fullscreen"],[1,"crm-block-content"],[1,"crm-block-body"],[1,"crm-block-body-blue-content"],[1,"crm-steps-container"],["class","crm-steps-container-step",3,"ngClass",4,"ngFor","ngForOf"],[1,"venta-body"],[1,"venta-body-component"],[3,"ngClass"],[3,"selectPromotion"],[3,"selectProperty"],[3,"selectPrice"],[3,"selectDocumentData"],[3,"selectContactData","contactData"],["class","steps-cards-body",4,"ngIf"],[1,"crm-steps-container-step",3,"ngClass"],[1,"crm-steps-container-step-circle"],["class","fa fa-check",4,"ngIf"],[4,"ngIf"],[1,"crm-steps-container-step-label"],["class","crm-steps-container-step-separator",4,"ngIf"],[1,"fa","fa-check"],[1,"crm-steps-container-step-separator"],[1,"steps-cards-body"],["class","steps-cards-body-card",4,"ngIf"],[1,"steps-cards-body-card"],[1,"steps-cards-body-card-header"],[1,"steps-cards-body-card-header-title"],[1,"steps-cards-body-card-header-icon",3,"click"],[1,"fa-solid","fa-pencil"],[1,"steps-cards-body-card-text"]],template:function(t,n){if(1&t){const r=e.RV6();e.j41(0,"ion-content",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7),e.DNE(5,$e,7,8,"div",8),e.k0s(),e.j41(6,"div",9)(7,"div",10)(8,"div",11)(9,"app-venta-select-promotion",12),e.bIt("selectPromotion",function(v){return e.eBV(r),e.Njj(n.onSelectPromotion(v))}),e.k0s()(),e.j41(10,"div",11)(11,"app-venta-select-property",13,0),e.bIt("selectProperty",function(v){return e.eBV(r),e.Njj(n.onSelectProperty(v))}),e.k0s()(),e.j41(13,"div",11)(14,"app-venta-select-price",14,1),e.bIt("selectPrice",function(v){return e.eBV(r),e.Njj(n.onSelectPrice(v))}),e.k0s()(),e.j41(16,"div",11)(17,"app-venta-select-document",15,2),e.bIt("selectDocumentData",function(v){return e.eBV(r),e.Njj(n.onSelectDocumentData(v))}),e.k0s()(),e.j41(19,"div",11)(20,"app-venta-select-contact-data",16),e.bIt("selectContactData",function(){return e.eBV(r),e.Njj(n.onSelectContactData())}),e.k0s()()(),e.DNE(21,Ye,5,4,"div",17),e.k0s()()()()()}2&t&&(e.Y8G("fullscreen",!0),e.R7$(5),e.Y8G("ngForOf",n.steps),e.R7$(3),e.Y8G("ngClass",e.eq3(9,D,0!==n.activeIndex)),e.R7$(2),e.Y8G("ngClass",e.eq3(11,D,1!==n.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(13,D,2!==n.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(15,D,3!==n.activeIndex)),e.R7$(3),e.Y8G("ngClass",e.eq3(17,D,4!==n.activeIndex)),e.R7$(),e.Y8G("contactData",null==n.operation?null:n.operation.contact),e.R7$(),e.Y8G("ngIf",null==n.data?null:n.data.promotion))},dependencies:[p.YU,p.Sq,p.bT,f.W9,l,R,H,ee,Te,I.w],styles:[".crm-steps-container[_ngcontent-%COMP%], .crm-steps-container-step[_ngcontent-%COMP%]{display:flex;align-items:center}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#3a50e4;border:1px solid #3A50E4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4}.crm-steps-container-step-current[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#3a50e4}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-circle[_ngcontent-%COMP%]{background:#fff;color:#a8a8a8;border:1px solid rgb(168,168,168)}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-label[_ngcontent-%COMP%]{color:#a8a8a8}.crm-steps-container-step-inactive[_ngcontent-%COMP%]   .crm-steps-container-step-separator[_ngcontent-%COMP%]{background:#a8a8a8}.crm-steps-container-step-circle[_ngcontent-%COMP%]{width:21px;min-width:21px;height:21px;min-height:21px;border-radius:50%;background:#3a50e4;color:#fff;display:flex;justify-content:center;align-items:center;font-weight:700;font-size:12px;margin-right:8px}.crm-steps-container-step-label[_ngcontent-%COMP%]{color:#3a50e4;font-weight:500;margin-right:16px;font-size:13px}.crm-steps-container-step-separator[_ngcontent-%COMP%]{width:20px;height:1px;background:#3a50e4;margin-right:16px}.hidden-step[_ngcontent-%COMP%]{height:0;overflow:hidden;opacity:0;position:absolute;width:0;visibility:hidden}.steps-cards-body[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:16px}.steps-cards-body-card[_ngcontent-%COMP%]{border:1px solid var(--crm-border-light-color);border-radius:6px;padding:12px}.steps-cards-body-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--crm-border-light-color);padding-bottom:16px}.steps-cards-body-card-header-title[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:var(--crm-text-color)}.steps-cards-body-card-header-icon[_ngcontent-%COMP%]{font-size:14px;cursor:pointer;color:var(--crm-text-color)}.steps-cards-body-card-text[_ngcontent-%COMP%]{font-size:13px;color:var(--crm-text-color);padding-top:16px}.venta-body[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px}.venta-body[_ngcontent-%COMP%]   .steps-cards-body[_ngcontent-%COMP%]{min-width:300px;width:300px;flex-shrink:0}.venta-body-component[_ngcontent-%COMP%]{flex:1 1 0;min-width:0;overflow-y:auto}"]}),d})()}];let We=(()=>{var o;class d{}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[P.iI.forChild(Ue),P.iI]}),d})();var Le=u(3895),ze=u(9662),Ke=u(6812),qe=u(969),Je=u(8147);let He=(()=>{var o;class d{}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,s.YN,f.bv,s.X1,We,Le.b,ze.Y,Ke.u,qe.rJ,Je.h]}),d})()},9662:(E,b,u)=>{u.d(b,{Y:()=>f});var p=u(177),s=u(3953);let f=(()=>{var P;class y{}return(P=y).\u0275fac=function(g){return new(g||P)},P.\u0275mod=s.$C({type:P}),P.\u0275inj=s.G2t({imports:[p.MD]}),y})()},4558:(E,b,u)=>{u.d(b,{w:()=>s});var p=u(3953);let s=(()=>{var f;class P{transform(e,...g){if(null==e||""===e)return"";let h;return h="string"==typeof e?parseFloat(e):e,isNaN(h)?"":h.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}}return(f=P).\u0275fac=function(e){return new(e||f)},f.\u0275pipe=p.EJ8({name:"thousandSeparator",type:f,pure:!0}),P})()},6552:(E,b,u)=>{u.d(b,{T:()=>h});var p=u(467),s=u(7376),P=u(6069),y=u(3953),e=u(5188),g=u(6039);let h=(()=>{var _;class F{constructor(l,c){this.router=l,this.api=c}parseBackendDateToFrontendDateInput(l){if(!l)return null;try{const c=new Date(l),m=c.getFullYear();return`${m}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`}catch(c){return console.error("Invalid date format",c),null}}parseProperties(l){for(let m in l)l[m]instanceof Date?l[m]=l[m].toISOString():"string"==typeof l[m]&&l[m].match(/^\d{4}-\d{2}-\d{2}$/)&&(l[m]=new Date(l[m]).toISOString()),"true"===l[m]?l[m]=!0:"false"===l[m]&&(l[m]=!1);const c=s.cloneDeep(l);return delete c.id,c}parseNameToValue(l){return l.toLowerCase().replace(/ /g,"_")}groupPropertiesByPromotion(l,c){return l.map(C=>{const j=c.filter(M=>M.promotionId===C.id);return{...C,properties:j}})}setStepsCompleted(l,c){return l.steps=s.orderBy(l.steps,["order"],["asc"]),l.steps=l.steps.map(m=>(m.order<c.order&&(m.isCompleted=!0),m)),l}hexToRgba(l,c){if(!l)return"";let m,C,j;if(3===(l=l.replace("#","")).length)m=parseInt(l[0]+l[0],16),C=parseInt(l[1]+l[1],16),j=parseInt(l[2]+l[2],16);else{if(6!==l.length)return"";m=parseInt(l.substring(0,2),16),C=parseInt(l.substring(2,4),16),j=parseInt(l.substring(4,6),16)}return`rgba(${m}, ${C}, ${j}, ${c})`}getLanguageInfo(l){return P.e.find(m=>m.code===l)||{}}getCountryInfo(l){return P.X.find(m=>m.code===l)||{}}countAvailableProperties(l){return l&&0!==l.length?l.filter(c=>"available"===c.availabilityStatus).length:0}calculateRangeOfPropertiesPrices(l){if(!l||0===l.length)return{min:0,max:0};const c=l.map(m=>m.price);return{min:Math.min(...c),max:Math.max(...c)}}calculateRangeOfPropertiesRooms(l){if(!l||0===l.length)return{min:0,max:0};const c=l.map(m=>m.bedrooms);return{min:Math.min(...c),max:Math.max(...c)}}onRemoveAgencyAccessToPromotion(l){console.log("onRemoveAgencyAccessToPromotion",l)}redirectToPromoter(l){this.router.navigate([`/promoters/${l.id}`])}filterFilesByCategoryAndSort(l,c){return l&&0!==l.length?l.filter(m=>m.category===c).sort((m,C)=>{var j,M;return(null!==(j=null==m?void 0:m.orderIndex)&&void 0!==j?j:0)-(null!==(M=null==C?void 0:C.orderIndex)&&void 0!==M?M:0)}):[]}transformThousandSeparator(l){if(null==l||""===l)return"";let c;return c="string"==typeof l?parseFloat(l):l,isNaN(c)?"":c.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}detectIfPromotionIsCompleted(l){var c=this;return(0,p.A)(function*(){var m;if(!l)return!1;const C=null===(m=yield c.api.getPromotionById(l.id))||void 0===m||null===(m=m.success)||void 0===m?void 0:m.data;return((null==C?void 0:C.deliveryDateModalityByStatus)||(null==C?void 0:C.deliveryDateModalityByMonths))&&!(null==C||!C.sellCommissionPercentage)&&!(null==C||!C.methodToPayCommissions)&&!(null==C||!C.reservePayment)&&((null==C?void 0:C.registersWithPreRegister)||(null==C?void 0:C.registersWithoutPreRegister))})()}isImageFile(l){var c;const C=null===(c=l.split(".").pop())||void 0===c?void 0:c.toLowerCase();return!!C&&["png","jpg","jpeg","gif","bmp","webp","svg","tiff","tif","ico","heic","jfif"].includes(C)}}return(_=F).\u0275fac=function(l){return new(l||_)(y.KVO(e.Ix),y.KVO(g.i))},_.\u0275prov=y.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),F})()}}]);