"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8205],{7141:(K,R,d)=>{d.d(R,{S:()=>u});var b=d(3953);let u=(()=>{var F;class I{constructor(g,e){this.el=g,this.renderer=e,this.disabled=!1}ngAfterViewInit(){this.updateVisibility()}ngOnChanges(g){this.updateVisibility()}updateVisibility(){if(!this.disabled)return this.renderer.setStyle(this.el.nativeElement,"display","block"),void this.renderer.removeStyle(this.el.nativeElement,"height");this.disabled&&this.isEmpty(this.value)?(this.renderer.setStyle(this.el.nativeElement,"display","none"),this.renderer.setStyle(this.el.nativeElement,"height","0")):(this.renderer.setStyle(this.el.nativeElement,"display","block"),this.renderer.removeStyle(this.el.nativeElement,"height"))}isEmpty(g){return null==g||""===g||Array.isArray(g)&&0===g.length||"object"==typeof g&&0===Object.keys(g).length}}return(F=I).\u0275fac=function(g){return new(g||F)(b.rXU(b.aKT),b.rXU(b.sFG))},F.\u0275dir=b.FsC({type:F,selectors:[["","appHideIfNoData",""]],inputs:{value:[0,"appHideIfNoData","value"],disabled:"disabled"},standalone:!0,features:[b.OA$]}),I})()},8205:(K,R,d)=>{d.r(R),d.d(R,{AgencyDetailsPageModule:()=>Gn});var b=d(177),u=d(9417),F=d(9465),I=d(5188),h=d(467),g=d(7376),e=d(3953),B=d(8397),Q=d(4501),x=d(6039),$=d(1213),L=d(2606),q=d(4874),H=d(6552),W=d(9520),ee=d(4558);const ne=["scrollContainer"];function te(o,l){if(1&o&&(e.j41(0,"div",12)(1,"div",50)(2,"div",51),e.nrm(3,"span"),e.k0s()()()),2&o){let i;const t=l.$implicit,n=e.XpG();e.R7$(3),e.HbH(null==(i=n.utils.getLanguageInfo(t))?null:i.flagClass)}}function oe(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",52),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.goToUrl(n.agency.instagramUrl))}),e.nrm(1,"i",53),e.k0s()}}function ie(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",52),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.goToUrl(n.agency.facebookUrl))}),e.nrm(1,"i",54),e.k0s()}}function ae(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",52),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.goToUrl(n.agency.linkedinUrl))}),e.nrm(1,"i",55),e.k0s()}}function le(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",52),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.goToUrl(n.agency.twitterUrl))}),e.nrm(1,"i",56),e.k0s()}}function re(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",57)(1,"div",14),e.EFF(2," Descarga y desc\xfabre nuestra agencia "),e.k0s(),e.j41(3,"div",58),e.nrm(4,"img",59),e.k0s(),e.j41(5,"div",60),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onDownloadCatalogue())}),e.EFF(6," Descargar "),e.k0s()()}}function se(o,l){if(1&o&&e.nrm(0,"app-card-system-user",36),2&o){const i=l.$implicit;e.Y8G("showCheckbox",!1)("user",i)}}function ce(o,l){if(1&o&&(e.j41(0,"div",61)(1,"div",62)(2,"div",63),e.EFF(3),e.k0s(),e.j41(4,"div",64),e.EFF(5),e.k0s()(),e.nrm(6,"div",65),e.j41(7,"div",66)(8,"div",67),e.nrm(9,"i",68),e.j41(10,"span"),e.EFF(11),e.k0s()(),e.j41(12,"div",67),e.nrm(13,"i",69),e.j41(14,"span"),e.EFF(15),e.k0s()(),e.j41(16,"div",67),e.nrm(17,"i",70),e.j41(18,"span"),e.EFF(19),e.k0s()()()()),2&o){const i=l.$implicit;e.R7$(3),e.SpI(" ",(null==i?null:i.city)||"Valencia"," "),e.R7$(2),e.Lme(" ",null==i?null:i.address,", ",null==i?null:i.postalCode," "),e.R7$(6),e.JRh((null==i?null:i.phoneNumber)||"+48 608 188 424"),e.R7$(4),e.JRh((null==i?null:i.email)||"office.poland@luxinmo.pl"),e.R7$(4),e.JRh((null==i?null:i.web)||"www.luxinmo.com")}}let de=(()=>{var o;class l{constructor(t,n,a){this.byvaroState=t,this.utils=n,this.api=a,this.agency=null,this.user=null,this.users=[],this.canEdit=!1,this.agencyCountry=null}ngOnInit(){var t=this;this.byvaroState.getState().subscribe(function(){var n=(0,h.A)(function*(a){var r,s;t.user=a.user,(null==a||null===(r=a.user)||void 0===r?void 0:r.agencyId)===(null===(s=t.agency)||void 0===s?void 0:s.id)&&(t.canEdit=!0)});return function(a){return n.apply(this,arguments)}}()),this.getData()}getData(){var t=this;return(0,h.A)(function*(){try{var n;t.agencyCountry=t.utils.getCountryInfo(null===(n=t.agency)||void 0===n?void 0:n.country)}catch(a){console.error(a)}})()}goToUrl(t){window.open(t,"_blank")}scrollLeft(){this.scrollContainer.nativeElement.scrollBy({left:-550,behavior:"smooth"})}scrollRight(){this.scrollContainer.nativeElement.scrollBy({left:550,behavior:"smooth"})}onDownloadCatalogue(){var t;console.log("DOWNLOAD CATALOGUE");const n=null===(t=this.agency)||void 0===t||null===(t=t.agencyFiles)||void 0===t?void 0:t.find(a=>"catalog"===a.category);n&&window.open(n.url,"_blank")}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU($.c),e.rXU(H.T),e.rXU(x.i))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-agency-details-presentation"]],viewQuery:function(t,n){if(1&t&&e.GBs(ne,5),2&t){let a;e.mGM(a=e.lsd())&&(n.scrollContainer=a.first)}},inputs:{agency:"agency"},decls:117,vars:32,consts:[[1,"crm-section",2,"gap","16px","padding","20px"],[1,"agency-banner"],[1,"agency-banner-img"],["alt","",3,"src"],[1,"agency-banner-bottom"],[1,"agency-banner-bottom-image"],[1,"agency-banner-bottom-info"],[2,"display","flex","flex-direction","column","gap","4px"],[1,"crm-block-photo-and-info-info-title"],[1,"crm-block-photo-and-info-info-footer"],[1,"fa-solid","fa-calendar"],[1,"crm-info-content-langs-langs",2,"overflow","hidden"],[1,"crm-item-option","crm-item-option-lang"],[1,"agency-block"],[1,"agency-block-title"],[1,"agency-block-rowdata"],[1,"agency-block-rowdata-text"],[2,"display","flex","align-items","center","gap","8px"],[1,"fa-solid","fa-location-dot"],[1,"fa-solid","fa-phone"],[1,"fa-solid","fa-envelope"],[1,"agency-block-rowdata-text",2,"width","fit-content"],["style","cursor: pointer;",3,"click",4,"ngIf"],[1,"agency-block","agency-block-empty"],[1,"agency-number-quantities"],[1,"agency-number-quantities-block"],[1,"agency-number-quantities-block-title"],[1,"agency-number-quantities-block-number"],[1,"agency-block-helper-text"],[1,"agency-block","agency-about-us"],[2,"display","flex","flex-direction","column","gap","16px","flex","1"],[1,"agency-about-us-block"],[1,"agency-block-text"],["class","agency-about-us-catalogue",4,"ngIf"],[1,"crm-section-inline-cards-wrapper"],[1,"crm-section-inline-cards"],[3,"showCheckbox","user"],[1,"agency-block-double"],[1,"agency-block","agency-block-empty",2,"gap","16px"],[1,"agency-offices-list"],["class","agency-office-card",4,"ngFor","ngForOf"],[1,"agency-portals-grid"],["src","https://logo.clearbit.com/habitaclia.com","alt","habitaclia"],["src","https://logo.clearbit.com/tucasa.com","alt","tucasa"],["src","https://logo.clearbit.com/wallapop.com","alt","wallapop"],["src","https://logo.clearbit.com/idealista.com","alt","idealista"],["src","https://logo.clearbit.com/fotocasa.es","alt","fotocasa"],["src","https://logo.clearbit.com/enalquiler.com","alt","enalquiler"],["src","https://logo.clearbit.com/yaencontre.com","alt","yaencontre"],["src","https://logo.clearbit.com/pisos.com","alt","pisos"],[1,"crm-item-option-left"],[1,"crm-item-option-flag"],[2,"cursor","pointer",3,"click"],[1,"fa-brands","fa-instagram",2,"font-family","'Font Awesome 6 Brands' !important","font-size","18px"],[1,"fa-brands","fa-facebook",2,"font-family","'Font Awesome 6 Brands' !important","font-size","18px"],[1,"fa-brands","fa-linkedin",2,"font-family","'Font Awesome 6 Brands' !important","font-size","18px"],[1,"fa-brands","fa-twitter",2,"font-family","'Font Awesome 6 Brands' !important","font-size","18px"],[1,"agency-about-us-catalogue"],[1,"catalogue-image"],["src","assets/images/catalogue.png","alt",""],[1,"crm-button-secondary",3,"click"],[1,"agency-office-card"],[1,"agency-office-header"],[1,"agency-office-title"],[1,"agency-office-address"],[1,"agency-office-separator"],[1,"agency-office-contact"],[1,"agency-office-contact-item"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],[1,"fas","fa-globe"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"img",3),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.nrm(6,"img",3),e.k0s(),e.j41(7,"div",6)(8,"div",7)(9,"div",8),e.EFF(10),e.k0s(),e.j41(11,"div",9),e.nrm(12,"i",10),e.EFF(13),e.k0s()(),e.j41(14,"div")(15,"div",11),e.Z7z(16,te,4,2,"div",12,e.fX1),e.k0s()()()()(),e.j41(18,"div",13)(19,"div",14),e.EFF(20),e.k0s(),e.j41(21,"div",15)(22,"div",16)(23,"div",17),e.nrm(24,"i",18),e.EFF(25),e.k0s(),e.j41(26,"div"),e.EFF(27),e.k0s()(),e.j41(28,"div",16)(29,"div"),e.EFF(30),e.k0s(),e.j41(31,"div"),e.EFF(32),e.k0s()(),e.j41(33,"div",16)(34,"div",17),e.nrm(35,"i",19),e.EFF(36),e.k0s(),e.j41(37,"div",17),e.nrm(38,"i",20),e.EFF(39),e.k0s()(),e.j41(40,"div",21)(41,"div",17),e.DNE(42,oe,2,0,"div",22)(43,ie,2,0,"div",22)(44,ae,2,0,"div",22)(45,le,2,0,"div",22),e.k0s(),e.j41(46,"div"),e.EFF(47),e.k0s()()()(),e.j41(48,"div",23)(49,"div",24)(50,"div",25)(51,"div",26),e.EFF(52," Ventas anuales "),e.k0s(),e.j41(53,"div",27),e.EFF(54),e.nI1(55,"thousandSeparator"),e.k0s()(),e.j41(56,"div",25)(57,"div",26),e.EFF(58," Ingresos anuales "),e.k0s(),e.j41(59,"div",27),e.EFF(60),e.nI1(61,"thousandSeparator"),e.k0s()(),e.j41(62,"div",25)(63,"div",26),e.EFF(64," Portfolio "),e.k0s(),e.j41(65,"div",27),e.EFF(66),e.k0s()(),e.j41(67,"div",25)(68,"div",26),e.EFF(69," Agentes "),e.k0s(),e.j41(70,"div",27),e.EFF(71),e.k0s()(),e.j41(72,"div",25)(73,"div",26),e.EFF(74," Oficinas "),e.k0s(),e.j41(75,"div",27),e.EFF(76),e.k0s()()(),e.j41(77,"div",28),e.EFF(78," Informaci\xf3n proporcionada por la agencia "),e.k0s()(),e.j41(79,"div",29)(80,"div",30)(81,"div",31)(82,"div",14),e.EFF(83," Sobre nosotros "),e.k0s(),e.j41(84,"div",32),e.EFF(85),e.k0s()(),e.j41(86,"div",31)(87,"div",14),e.EFF(88," Un poco de historia "),e.k0s(),e.j41(89,"div",32),e.EFF(90),e.k0s()()(),e.DNE(91,re,7,0,"div",33),e.k0s(),e.j41(92,"div",13)(93,"div",14),e.EFF(94," Equipo "),e.k0s(),e.j41(95,"div",34)(96,"div",35),e.Z7z(97,se,1,2,"app-card-system-user",36,e.fX1),e.k0s()()(),e.j41(99,"div",37)(100,"div",38)(101,"div",14),e.EFF(102,"Offices"),e.k0s(),e.j41(103,"div",39),e.DNE(104,ce,20,6,"div",40),e.k0s()(),e.j41(105,"div",38)(106,"div",14),e.EFF(107,"Following real estate portals"),e.k0s(),e.j41(108,"div",41),e.nrm(109,"img",42)(110,"img",43)(111,"img",44)(112,"img",45)(113,"img",46)(114,"img",47)(115,"img",48)(116,"img",49),e.k0s()()()()),2&t&&(e.R7$(3),e.Y8G("src",(null==n.agency?null:n.agency.bannerUrl)||"assets/images/banner-agency-model.png",e.B4B),e.R7$(3),e.Y8G("src",(null==n.agency?null:n.agency.photoUrl)||"assets/images/agency-photo-model.png",e.B4B),e.R7$(4),e.SpI(" ",null==n.agency?null:n.agency.name," "),e.R7$(3),e.E5c(" Fundado en ",null==n.agency?null:n.agency.foundationYear," / ",null==n.agency?null:n.agency.city," / ",null==n.agencyCountry?null:n.agencyCountry.name," "),e.R7$(3),e.Dyx(null==n.agency?null:n.agency.languages),e.R7$(4),e.SpI(" ",(null==n.agency?null:n.agency.legalName)||"Luxinmo Real State SLU"," "),e.R7$(5),e.Lme(" ",(null==n.agencyCountry?null:n.agencyCountry.name)||"Espa\xf1a"," / ",(null==n.agency?null:n.agency.city)||"Valencia"," "),e.R7$(2),e.SpI(" ",(null==n.agency?null:n.agency.address)||"Calle de la Paz, 1"," "),e.R7$(3),e.SpI(" NIF/CIF: ",(null==n.agency?null:n.agency.nifCif)||""," "),e.R7$(2),e.SpI(" C\xf3digo postal: ",(null==n.agency?null:n.agency.postalCode)||""," "),e.R7$(4),e.SpI(" ",(null==n.agency||null==n.agency.phones?null:n.agency.phones[0])||""," "),e.R7$(3),e.SpI(" ",(null==n.agency||null==n.agency.emails?null:n.agency.emails[0])||""," "),e.R7$(3),e.Y8G("ngIf",null==n.agency?null:n.agency.instagramUrl),e.R7$(),e.Y8G("ngIf",null==n.agency?null:n.agency.facebookUrl),e.R7$(),e.Y8G("ngIf",null==n.agency?null:n.agency.linkedinUrl),e.R7$(),e.Y8G("ngIf",null==n.agency?null:n.agency.twitterUrl),e.R7$(2),e.SpI(" ",null==n.agency?null:n.agency.webUrl," "),e.R7$(7),e.SpI(" +",e.bMT(55,28,null==n.agency?null:n.agency.annualSales)||"-"," "),e.R7$(6),e.SpI(" +",e.bMT(61,30,null==n.agency?null:n.agency.annualRevenue)||"-"," "),e.R7$(6),e.SpI(" ",(null==n.agency?null:n.agency.portfolioSize)||"-"," "),e.R7$(5),e.SpI(" ",(null==n.users?null:n.users.length)||"-"," "),e.R7$(5),e.SpI(" ",(null==n.agency||null==n.agency.agencyOffices?null:n.agency.agencyOffices.length)||"-"," "),e.R7$(9),e.SpI(" ",null==n.agency?null:n.agency.aboutUs," "),e.R7$(5),e.SpI(" ",null==n.agency?null:n.agency.storyAboutUs," "),e.R7$(),e.Y8G("ngIf",(null==n.agency||null==n.agency.agencyFiles?null:n.agency.agencyFiles.length)>0),e.R7$(6),e.Dyx(null==n.agency?null:n.agency.users),e.R7$(7),e.Y8G("ngForOf",null==n.agency?null:n.agency.agencyOffices))},dependencies:[b.Sq,b.bT,W.k,ee.w],styles:[".agency-block[_ngcontent-%COMP%]{padding:20px;border-radius:12px;background:#fff;max-width:1000px;border:none;gap:16px;display:flex;flex-direction:column}.agency-block-empty[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--crm-border-light-color);gap:0}.agency-block[_ngcontent-%COMP%]   .crm-section-inline-cards[_ngcontent-%COMP%]{display:flex;gap:16px;overflow-x:auto;scroll-behavior:smooth;-ms-overflow-style:none;scrollbar-width:none;white-space:nowrap;max-width:100%;padding:8px 0;flex-wrap:nowrap}.agency-block[_ngcontent-%COMP%]   .crm-section-inline-cards[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.agency-block-helper-text[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--crm-font-color-light);width:100%;text-align:right}.agency-block-title[_ngcontent-%COMP%]{font-size:var(--crm-font-size);font-weight:600}.agency-block-text[_ngcontent-%COMP%]{font-size:var(--crm-font-size);font-weight:400;color:var(--crm-font-color-light);line-height:1.5}.agency-number-quantities[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:60%}.agency-number-quantities-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.agency-number-quantities-block-title[_ngcontent-%COMP%]{font-size:12px}.agency-number-quantities-block-number[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.agency-block-rowdata[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.agency-block-rowdata-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;width:25%;font-size:var(--crm-font-size);font-weight:400;color:var(--crm-font-color-light)}.agency-block-rowdata-text[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.agency-banner[_ngcontent-%COMP%]{max-width:1000px}.agency-banner-img[_ngcontent-%COMP%]{max-width:1000px;border-top-right-radius:12px;border-top-left-radius:12px;height:220px}.agency-banner-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-top-right-radius:12px;border-top-left-radius:12px}.agency-banner-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;background:#fff;border-bottom-right-radius:12px;border-bottom-left-radius:12px;padding-bottom:12px}.agency-banner-bottom-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex:1;padding:16px}.agency-banner-bottom-info[_ngcontent-%COMP%]   .crm-info-content-langs-langs[_ngcontent-%COMP%]{background:#ebebeb;border-radius:100px;padding:5px 8px}.agency-banner-bottom-info[_ngcontent-%COMP%]   .crm-info-content-langs-langs[_ngcontent-%COMP%]   .crm-item-option-flag[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:1.333333em;height:auto;font-size:13px}.agency-banner-bottom-image[_ngcontent-%COMP%]{width:110px;height:110px;border-radius:50%;border:2px solid #fff;margin-top:-50px;margin-left:24px;background:#fff}.agency-banner-bottom-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}.agency-about-us[_ngcontent-%COMP%]{display:flex;align-items:flex-start;flex-wrap:nowrap;flex-direction:row}.agency-about-us-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.agency-about-us-catalogue[_ngcontent-%COMP%]{border:1px solid var(--crm-border-light-color);padding:12px;border-radius:8px;max-width:230px;min-width:230px;flex:1;display:flex;flex-direction:column;gap:12px}.agency-about-us-catalogue[_ngcontent-%COMP%]   .crm-button-secondary[_ngcontent-%COMP%]{margin:auto}.catalogue-image[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;border-radius:8px;overflow:hidden;position:relative}.catalogue-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%;object-fit:cover;max-width:180px}.promotion-card__content[_ngcontent-%COMP%]{border:none!important}.agency-block-double[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:nowrap;max-width:1000px}.agency-block-double[_ngcontent-%COMP%]   .agency-block[_ngcontent-%COMP%]{width:50%}.agency-offices-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.agency-office-card[_ngcontent-%COMP%]{max-width:280px;width:100%;background:#fff;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:12px}.agency-office-card[_ngcontent-%COMP%]   .agency-office-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.agency-office-card[_ngcontent-%COMP%]   .agency-office-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--crm-font-color)}.agency-office-card[_ngcontent-%COMP%]   .agency-office-address[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:var(--crm-font-color-light);line-height:1.4}.agency-office-card[_ngcontent-%COMP%]   .agency-office-separator[_ngcontent-%COMP%]{border-top:1px solid #eaeaea;margin:4px 0}.agency-office-card[_ngcontent-%COMP%]   .agency-office-contact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.agency-office-card[_ngcontent-%COMP%]   .agency-office-contact-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;color:var(--crm-font-color)}.agency-office-card[_ngcontent-%COMP%]   .agency-office-contact-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px;color:var(--crm-font-color-light)}.agency-portals-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:12px}.agency-portals-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:90px;height:auto;object-fit:contain;border-radius:8px;background:#f9f9f9;padding:6px;box-shadow:0 0 0 1px #eee}"]}),l})();var pe=d(5990),ge=d(9604),ue=d(5180),me=d(8323);let fe=(()=>{var o;class l{constructor(t){this.fb=t,this.initForm()}initForm(){this.agencyForm=this.fb.group({name:["",u.k0.required],facebookUrl:[""],instagramUrl:[""],linkedinUrl:[""],twitterUrl:[""],webUrl:[""],phones:this.fb.array([this.createPhoneGroup()]),emails:this.fb.array([this.createEmailGroup()]),aboutUs:[""],storyAboutUs:[""],legalName:[""],foundationYear:[""],nifCif:[""],annualSales:[null],annualRevenue:[null],portfolioSize:[null],country:[""],city:[""],address:[""],postalCode:[""],province:[""]})}populateForm(t){var n,a,r,s,p,f,_,v,y,c,m,C,A,E,U,O,w,V,S,Y,X;console.log("populateForm",t),this.agencyForm.patchValue({name:null!==(n=t.name)&&void 0!==n?n:"",facebookUrl:null!==(a=t.facebookUrl)&&void 0!==a?a:"",instagramUrl:null!==(r=t.instagramUrl)&&void 0!==r?r:"",linkedinUrl:null!==(s=t.linkedinUrl)&&void 0!==s?s:"",twitterUrl:null!==(p=t.twitterUrl)&&void 0!==p?p:"",webUrl:null!==(f=t.webUrl)&&void 0!==f?f:"",aboutUs:null!==(_=t.aboutUs)&&void 0!==_?_:"",storyAboutUs:null!==(v=t.storyAboutUs)&&void 0!==v?v:"",legalName:null!==(y=t.legalName)&&void 0!==y?y:"",foundationYear:null!==(c=t.foundationYear)&&void 0!==c?c:null,nifCif:null!==(m=t.nifCif)&&void 0!==m?m:"",annualSales:null!==(C=t.annualSales)&&void 0!==C?C:null,annualRevenue:null!==(A=t.annualRevenue)&&void 0!==A?A:null,portfolioSize:null!==(E=t.portfolioSize)&&void 0!==E?E:null,country:null!==(U=t.country)&&void 0!==U?U:"",city:null!==(O=t.city)&&void 0!==O?O:"",address:null!==(w=t.address)&&void 0!==w?w:"",postalCode:null!==(V=t.postalCode)&&void 0!==V?V:"",province:null!==(S=t.province)&&void 0!==S?S:""}),this.phones.clear(),null===(Y=t.phones)||void 0===Y||Y.forEach(M=>{this.phones.push(this.fb.group({phoneNumber:null!=M?M:""}))}),this.emails.clear(),null===(X=t.emails)||void 0===X||X.forEach(M=>{this.emails.push(this.fb.group({emailAddress:null!=M?M:""}))})}createPhoneGroup(){return this.fb.group({phoneNumber:["",[u.k0.pattern(/^\d+$/)]]})}createEmailGroup(){return this.fb.group({emailAddress:["",[u.k0.email]]})}get phones(){return this.agencyForm.get("phones")}get emails(){return this.agencyForm.get("emails")}addPhone(){this.phones.push(this.createPhoneGroup())}removePhone(t){this.phones.removeAt(t)}addEmail(){this.emails.push(this.createEmailGroup())}removeEmail(t){this.emails.removeAt(t)}onSelectCountry(t,n){var a;null===(a=this.phones.at(n).get("country"))||void 0===a||a.setValue(t)}}return(o=l).\u0275fac=function(t){return new(t||o)(e.KVO(u.ok))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),l})();var ye=d(5970),ve=d(1129),_e=d(1792),z=d(6279),be=d(7141),j=d(3955);const he=["fileUploaderManagerComponent"],Fe=["bannerFileUploaderManagerComponent"],Ce=["catalogFileUploaderManagerComponent"],Ie=["provinceInput"],ke=["cityInput"],Me=["fileUploaderOfficeManager"],D=o=>({"crm-section-disabled-inputs":o}),T=o=>({"crm-input-input-error":o}),G=o=>({field:o}),Ae=o=>({edit:o}),P=o=>({item:o}),J=o=>({number:o}),k=()=>({standalone:!0});function Re(o,l){1&o&&(e.j41(0,"div",48),e.EFF(1," Foto de perfil "),e.k0s())}function je(o,l){1&o&&(e.j41(0,"div",48),e.EFF(1," Banner de la agencia "),e.k0s())}function Ee(o,l){1&o&&(e.j41(0,"div",48),e.EFF(1," Cat\xe1logo "),e.k0s())}function xe(o,l){1&o&&(e.j41(0,"div",49),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"errors.required")," "))}function $e(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",54),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,a=e.XpG();return e.Njj(a.onRemoveLanguage(n))}),e.nrm(1,"i",55),e.k0s()}}function De(o,l){if(1&o&&(e.j41(0,"div",20)(1,"div",50)(2,"div",51),e.nrm(3,"span"),e.k0s(),e.j41(4,"div",52),e.EFF(5),e.k0s()(),e.DNE(6,$e,2,0,"div",53),e.k0s()),2&o){let i,t;const n=l.$implicit,a=e.XpG();e.Y8G("ngClass",e.eq3(5,Ae,!a.disabled)),e.R7$(3),e.HbH(null==(i=a.getLanguageInfo(n))?null:i.flagClass),e.R7$(2),e.SpI(" ",null==(t=a.getLanguageInfo(n))?null:t.name," "),e.R7$(),e.vxM(a.disabled?-1:6)}}function Te(o,l){if(1&o){const i=e.RV6();e.j41(0,"button",56),e.bIt("click",function(n){e.eBV(i);const a=e.XpG();return e.Njj(a.onAddLanguage(n))}),e.nrm(1,"i",57),e.EFF(2),e.nI1(3,"translate"),e.nI1(4,"translate"),e.k0s()}2&o&&(e.R7$(2),e.SpI(" ",e.i5U(4,3,"text.add_item",e.eq3(6,P,e.bMT(3,1,"text.language")))," "))}function Ge(o,l){if(1&o&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.SpI(" ",i.agencyForm.controls.aboutUs.value," ")}}function Pe(o,l){if(1&o&&(e.j41(0,"div",24),e.nrm(1,"textarea",58),e.k0s()),2&o){const i=e.XpG();e.Y8G("appInputViewMode",i.disabled)}}function Ne(o,l){if(1&o&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.SpI(" ",i.agencyForm.controls.storyAboutUs.value," ")}}function Ue(o,l){if(1&o&&(e.j41(0,"div",24),e.nrm(1,"textarea",59),e.k0s()),2&o){const i=e.XpG();e.Y8G("appInputViewMode",i.disabled)}}function Oe(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",60)(1,"div",50)(2,"div",51),e.nrm(3,"span"),e.k0s(),e.j41(4,"div",52),e.EFF(5),e.k0s()(),e.j41(6,"div",54),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.onRemoveNationality())}),e.nrm(7,"i",55),e.k0s()()}if(2&o){let i,t;const n=e.XpG(2);e.R7$(3),e.HbH(null==(i=n.getCountryInfo(null==(i=n.agencyForm.get("country"))?null:i.value))?null:i.flagClass),e.R7$(2),e.SpI(" ",null==(t=n.getCountryInfo(null==(t=n.agencyForm.get("country"))?null:t.value))?null:t.name," ")}}function we(o,l){if(1&o){const i=e.RV6();e.j41(0,"button",56),e.bIt("click",function(n){e.eBV(i);const a=e.XpG(2);return e.Njj(a.onAddNationality(n))}),e.nrm(1,"i",57),e.EFF(2," Seleccionar pa\xeds "),e.k0s()}}function Ve(o,l){if(1&o&&e.DNE(0,Oe,8,3,"div",60)(1,we,3,0,"button",21),2&o){let i;const t=e.XpG();e.vxM(null!=(i=t.agencyForm.get("country"))&&i.value?0:1)}}function Se(o,l){if(1&o&&(e.j41(0,"div",61)(1,"div",50)(2,"div",51),e.nrm(3,"span"),e.k0s(),e.j41(4,"div",52),e.EFF(5),e.k0s()()()),2&o){let i,t;const n=e.XpG(2);e.R7$(3),e.HbH(null==(i=n.getCountryInfo(null==(i=n.agencyForm.get("country"))?null:i.value))?null:i.flagClass),e.R7$(2),e.SpI(" ",null==(t=n.getCountryInfo(null==(t=n.agencyForm.get("country"))?null:t.value))?null:t.name," ")}}function Ye(o,l){if(1&o&&e.DNE(0,Se,6,3,"div",61),2&o){let i;const t=e.XpG();e.vxM(null!=(i=t.agencyForm.get("country"))&&i.value?0:-1)}}function Xe(o,l){1&o&&(e.j41(0,"div",49),e.EFF(1," Debes elegir una provincia de la lista. "),e.k0s())}function Be(o,l){1&o&&(e.j41(0,"div",49),e.EFF(1," Debes elegir una ciudad de la lista. "),e.k0s())}function Le(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",68),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$index,a=e.XpG();return e.Njj(a.onRemovePhone(n))}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"text.delete")," "))}function He(o,l){1&o&&(e.j41(0,"div",49),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"errors.required")," "))}function ze(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",37)(1,"div",13)(2,"div",14),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",62)(6,"div",63)(7,"app-flag-country-selector",64),e.bIt("emitCountrySelected",function(n){const a=e.eBV(i).$index,r=e.XpG();return e.Njj(r.onSelectCountry(n,a))}),e.k0s(),e.nrm(8,"input",65),e.nI1(9,"translate"),e.nI1(10,"translate"),e.k0s(),e.j41(11,"div",66),e.DNE(12,Le,3,3,"div",67),e.k0s()(),e.DNE(13,He,3,3,"div",17),e.k0s()()}if(2&o){const i=l.$implicit,t=l.$index,n=e.XpG();e.Y8G("formGroup",i),e.R7$(3),e.SpI(" ",e.i5U(4,7,"text.phone_loop_label",e.eq3(15,J,t+1))," "),e.R7$(3),e.Y8G("appInputViewMode",n.disabled)("ngClass",e.eq3(17,T,n.isPhoneControlInvalid(t))),e.R7$(2),e.Y8G("placeholder",e.i5U(10,12,"text.input_placeholder",e.eq3(19,G,e.bMT(9,10,"text.phone")))),e.R7$(4),e.vxM(t>0?12:-1),e.R7$(),e.Y8G("ngIf",n.isPhoneControlInvalid(t))}}function Je(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",38)(1,"div",69)(2,"button",56),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onAddPhone())}),e.nrm(3,"i",57),e.EFF(4),e.nI1(5,"translate"),e.nI1(6,"translate"),e.k0s()()()}2&o&&(e.R7$(4),e.SpI(" ",e.i5U(6,3,"text.add_item",e.eq3(6,P,e.bMT(5,1,"text.phone")))," "))}function Ze(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",68),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$index,a=e.XpG();return e.Njj(a.onRemoveEmail(n))}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"text.delete")," "))}function Ke(o,l){1&o&&(e.j41(0,"div",49),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"errors.required")," "))}function Qe(o,l){if(1&o&&(e.j41(0,"div",37)(1,"div",13)(2,"div",14),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",70)(6,"div",71),e.nrm(7,"input",72),e.nI1(8,"translate"),e.nI1(9,"translate"),e.k0s(),e.j41(10,"div",66),e.DNE(11,Ze,3,3,"div",67),e.k0s()(),e.DNE(12,Ke,3,3,"div",17),e.k0s()()),2&o){const i=l.$implicit,t=l.$index,n=e.XpG();e.Y8G("formGroup",i),e.R7$(3),e.SpI(" ",e.i5U(4,7,"text.email_loop_label",e.eq3(15,J,t+1))," "),e.R7$(2),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("ngClass",e.eq3(17,T,n.isEmailControlInvalid(t))),e.R7$(),e.Y8G("placeholder",e.i5U(9,12,"text.input_placeholder",e.eq3(19,G,e.bMT(8,10,"text.email")))),e.R7$(4),e.vxM(t>0?11:-1),e.R7$(),e.Y8G("ngIf",n.isEmailControlInvalid(t))}}function qe(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",38)(1,"div",69)(2,"button",56),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onAddEmail())}),e.nrm(3,"i",57),e.EFF(4),e.nI1(5,"translate"),e.nI1(6,"translate"),e.k0s()()()}2&o&&(e.R7$(4),e.SpI(" ",e.i5U(6,3,"text.add_item",e.eq3(6,P,e.bMT(5,1,"text.email")))," "))}function We(o,l){if(1&o){const i=e.RV6();e.j41(0,"button",82),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$index,a=e.XpG();return e.Njj(a.onRemoveOffice(n))}),e.nrm(1,"i",55),e.k0s()}}function en(o,l){if(1&o){const i=e.RV6();e.j41(0,"app-flag-country-selector",64),e.bIt("emitCountrySelected",function(n){e.eBV(i);const a=e.XpG().$index,r=e.XpG();return e.Njj(r.onSelectCountry(n,null,a))}),e.k0s()}}function nn(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",46)(1,"div",73)(2,"div",74),e.EFF(3),e.k0s(),e.j41(4,"div",75),e.DNE(5,We,2,0,"button",76),e.k0s()(),e.j41(6,"div",77)(7,"div",78)(8,"div",22)(9,"div",14),e.EFF(10," Nombre "),e.k0s(),e.j41(11,"div",25)(12,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.name,n)||(a.name=n),e.Njj(n)}),e.k0s()()(),e.j41(13,"div",22)(14,"div",14),e.EFF(15," Direcci\xf3n "),e.k0s(),e.j41(16,"div",25)(17,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.address,n)||(a.address=n),e.Njj(n)}),e.k0s()()(),e.j41(18,"div",22)(19,"div",14),e.EFF(20," Ciudad "),e.k0s(),e.j41(21,"div",25)(22,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.city,n)||(a.city=n),e.Njj(n)}),e.k0s()()(),e.j41(23,"div",22)(24,"div",14),e.EFF(25," C\xf3digo Postal "),e.k0s(),e.j41(26,"div",25)(27,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.postalCode,n)||(a.postalCode=n),e.Njj(n)}),e.k0s()()(),e.j41(28,"div",22)(29,"div",14),e.EFF(30," Email "),e.k0s(),e.j41(31,"div",25)(32,"input",80),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.email,n)||(a.email=n),e.Njj(n)}),e.k0s()()(),e.j41(33,"div",22)(34,"div",14),e.EFF(35," Tel\xe9fono "),e.k0s(),e.j41(36,"div",25),e.DNE(37,en,1,0,"app-flag-country-selector",81),e.j41(38,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.phoneNumber,n)||(a.phoneNumber=n),e.Njj(n)}),e.k0s()()(),e.j41(39,"div",22)(40,"div",14),e.EFF(41," Web "),e.k0s(),e.j41(42,"div",25)(43,"input",79),e.mxI("ngModelChange",function(n){const a=e.eBV(i).$implicit;return e.DH7(a.web,n)||(a.web=n),e.Njj(n)}),e.k0s()()()()()()}if(2&o){const i=l.$implicit,t=l.$index,n=e.XpG();e.R7$(3),e.SpI(" Oficina ",t+1," "),e.R7$(2),e.Y8G("ngIf",!n.disabled),e.R7$(3),e.Y8G("appHideIfNoData",i.name)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.name),e.Y8G("ngModelOptions",e.lJ4(38,k)),e.R7$(),e.Y8G("appHideIfNoData",i.address)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.address),e.Y8G("ngModelOptions",e.lJ4(39,k)),e.R7$(),e.Y8G("appHideIfNoData",i.city)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.city),e.Y8G("ngModelOptions",e.lJ4(40,k)),e.R7$(),e.Y8G("appHideIfNoData",i.postalCode)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.postalCode),e.Y8G("ngModelOptions",e.lJ4(41,k)),e.R7$(),e.Y8G("appHideIfNoData",i.email)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.email),e.Y8G("ngModelOptions",e.lJ4(42,k)),e.R7$(),e.Y8G("appHideIfNoData",i.phoneNumber)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("ngIf",!n.disabled),e.R7$(),e.R50("ngModel",i.phoneNumber),e.Y8G("ngModelOptions",e.lJ4(43,k)),e.R7$(),e.Y8G("appHideIfNoData",i.web)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.R50("ngModel",i.web),e.Y8G("ngModelOptions",e.lJ4(44,k))}}function tn(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",38)(1,"div",69)(2,"button",56),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onAddOffice())}),e.nrm(3,"i",57),e.EFF(4," A\xf1adir oficina "),e.k0s()()()}}let on=(()=>{var o;class l{constructor(t,n,a,r,s){this.fb=t,this.agencyFormService=n,this.popoverService=a,this.utils=r,this.ngZone=s,this.agency=null,this.disabled=!1,this.files=[],this.agencyOffices=[{name:"Oficina Central",address:"Calle 123, Madrid",web:"www.oficinacentral.com",email:"as@gmail.com",phoneNumber:"123456789"}],this.provinceValid=!1,this.cityValid=!1}get agencyForm(){return this.agencyFormService.agencyForm}get phonesControls(){return this.agencyFormService.phones.controls}get emailsControls(){return this.agencyFormService.emails.controls}ngOnInit(){this.agency&&(this.agencyFormService.populateForm(this.agency),this.agency.languages=this.agency.languages||[],this.agencyOffices=g.cloneDeep(this.agency.agencyOffices)||[],this.disabled?setTimeout(()=>{this.disabled=!1,setTimeout(()=>{this.disabled=!0,this.syncFiles()})}):this.syncFiles());const t=this.agencyForm.get("province"),n=this.agencyForm.get("city"),a=r=>s=>r()?null:{mustSelect:!0};t.setValidators([u.k0.required,a(()=>this.provinceValid)]),n.setValidators([u.k0.required,a(()=>this.cityValid)]),n.disable(),t.updateValueAndValidity(),n.updateValueAndValidity()}ngAfterViewInit(){const t=(r,s,p)=>{const f=new google.maps.places.Autocomplete(r,s);return f.addListener("place_changed",()=>this.ngZone.run(()=>p(f.getPlace()))),f};this.provinceAutocomplete=t(this.provinceInput.nativeElement,{types:["(regions)"],componentRestrictions:{country:"es"},fields:["address_component","geometry"]},r=>{var s,p;const f=null===(s=r.address_components)||void 0===s?void 0:s.find(c=>c.types.includes("administrative_area_level_2"));if(!f)return;this.provinceValid=!0;const _=this.agencyForm.get("province");_.setValue(f.long_name),_.updateValueAndValidity(),_.setErrors(null),_.markAsPristine(),_.markAsUntouched();const v=null===(p=r.geometry)||void 0===p?void 0:p.viewport;this.agencyForm.get("city").enable(),v&&this.cityAutocomplete.setBounds(v)}),this.cityAutocomplete=t(this.cityInput.nativeElement,{types:["locality"],componentRestrictions:{country:"es"},fields:["address_component"]},r=>{var s,p;const f=null===(s=r.address_components)||void 0===s?void 0:s.find(c=>c.types.includes("locality")),_=null===(p=r.address_components)||void 0===p?void 0:p.find(c=>c.types.includes("administrative_area_level_2")),v=this.agencyForm.get("province").value;if(!f||!_||_.long_name!==v){const c=this.agencyForm.get("city");return this.cityValid=!1,c.setValue(""),c.setErrors({mustSelect:!0}),void(this.cityInput.nativeElement.value="")}this.cityValid=!0;const y=this.agencyForm.get("city");y.setValue(f.long_name),y.updateValueAndValidity(),y.setErrors(null),y.markAsPristine(),y.markAsUntouched()});const n=this.agencyForm.get("province");n.value&&(this.provinceValid=!0,this.provinceInput.nativeElement.value=n.value,n.setErrors(null),n.markAsPristine(),this.agencyForm.get("city").enable());const a=this.agencyForm.get("city");a.value&&(this.cityValid=!0,this.cityInput.nativeElement.value=a.value,a.setErrors(null),a.markAsPristine())}resetCity(){const t=this.agencyForm.get("city");this.cityValid=!1,t.reset(),t.disable()}syncFiles(){setTimeout(()=>{var t;const n={multiple:!1,size:"medium",showRemove:!this.disabled,showName:!1,rounded:!1,allowUpload:!this.disabled,accept:"image/*",files:[]};this.fileUploaderManager.config=g.cloneDeep(n),this.bannerFileUploaderManagerComponent.config=g.cloneDeep({...n,rounded:!1}),this.fileUploaderManager.createProfileFilePic(this.agency),this.bannerFileUploaderManagerComponent.createAgencyBanner(this.agency),this.fileUploaderOfficeManagers.forEach((a,r)=>{a.config=g.cloneDeep(n),a.createOfficeImage(this.agencyOffices[r])}),this.catalogFileUploaderManagerComponent.config=g.cloneDeep({...n,filesCategory:"catalog",files:null===(t=this.agency)||void 0===t||null===(t=t.agencyFiles)||void 0===t?void 0:t.filter(a=>"catalog"===a.category),accept:"image/*,application/pdf"})})}getLanguageInfo(t){return this.utils.getLanguageInfo(t)}onAddLanguage(t){var n=this;return(0,h.A)(function*(){var a,r;const s=yield n.popoverService.onShowCountrySelectorPopover(t,{languageSelector:!0,showCountryCode:!1,selectedCodes:null===(a=n.agency)||void 0===a?void 0:a.languages});null!=s&&null!==(r=s.data)&&void 0!==r&&r.country&&n.agency.languages.push(s.data.country.code)})()}onRemoveLanguage(t){this.agency.languages=this.agency.languages.filter(n=>n!==t)}onAddPhone(){this.agencyFormService.addPhone()}onRemovePhone(t){this.agencyFormService.removePhone(t)}onAddEmail(){this.agencyFormService.addEmail()}onRemoveEmail(t){this.agencyFormService.removeEmail(t)}onSelectCountry(t,n,a){null!=a?this.agencyOffices[a].phoneNumber=t.phoneCode+" ":this.agencyFormService.onSelectCountry(t,n)}onAddOffice(){this.agencyOffices.push({name:"",address:"",web:"",email:"",phoneNumber:""}),setTimeout(()=>{this.fileUploaderOfficeManagers.last.config=g.cloneDeep({multiple:!1,size:"medium",showRemove:!this.disabled,showName:!1,rounded:!0,allowUpload:!this.disabled,accept:"image/*",files:[]})})}isControlInvalid(t){const n=this.agencyForm.get(t);return!(!n||!n.invalid||!n.dirty&&!n.touched)}isPhoneControlInvalid(t){const n=this.phonesControls[t].get("phoneNumber");return!(!n||!n.invalid||!n.dirty&&!n.touched)}isEmailControlInvalid(t){const n=this.emailsControls[t].get("emailAddress");return!(!n||!n.invalid||!n.dirty&&!n.touched)}getPhoneErrorMessage(t){var n,a;const r=this.phonesControls[t].get("phoneNumber");return null!=r&&null!==(n=r.errors)&&void 0!==n&&n.required?"El n\xfamero de tel\xe9fono es requerido":null!=r&&null!==(a=r.errors)&&void 0!==a&&a.pattern?"El n\xfamero de tel\xe9fono debe contener solo d\xedgitos":""}getEmailErrorMessage(t){var n,a;const r=this.emailsControls[t].get("emailAddress");return null!=r&&null!==(n=r.errors)&&void 0!==n&&n.required?"El correo electr\xf3nico es requerido":null!=r&&null!==(a=r.errors)&&void 0!==a&&a.email?"Introduce un correo electr\xf3nico v\xe1lido":""}onRemoveOffice(t){this.agencyOffices.splice(t,1)}onAddNationality(t){var n=this;return(0,h.A)(function*(){var a,r;const s=yield n.popoverService.onShowCountrySelectorPopover(t,{languageSelector:!1,showCountryCode:!1,selectedCodes:[null===(a=n.agencyForm.get("country"))||void 0===a?void 0:a.value]});null!=s&&null!==(r=s.data)&&void 0!==r&&r.country&&n.agencyForm.get("country").setValue(s.data.country.code)})()}onRemoveNationality(){this.agencyForm.get("country").setValue("")}getCountryInfo(t){return this.utils.getCountryInfo(t)}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(u.ok),e.rXU(fe),e.rXU(ye.m),e.rXU(H.T),e.rXU(e.SKi))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-agency-form"]],viewQuery:function(t,n){if(1&t&&(e.GBs(he,5),e.GBs(Fe,5),e.GBs(Ce,5),e.GBs(Ie,5),e.GBs(ke,5),e.GBs(Me,5)),2&t){let a;e.mGM(a=e.lsd())&&(n.fileUploaderManager=a.first),e.mGM(a=e.lsd())&&(n.bannerFileUploaderManagerComponent=a.first),e.mGM(a=e.lsd())&&(n.catalogFileUploaderManagerComponent=a.first),e.mGM(a=e.lsd())&&(n.provinceInput=a.first),e.mGM(a=e.lsd())&&(n.cityInput=a.first),e.mGM(a=e.lsd())&&(n.fileUploaderOfficeManagers=a)}},inputs:{agency:"agency",disabled:"disabled"},decls:164,vars:90,consts:[["fileUploaderManagerComponent",""],["bannerFileUploaderManagerComponent",""],["catalogFileUploaderManagerComponent",""],["provinceInput",""],["cityInput",""],["type","text","autocomplete","username",2,"display","none"],["type","password","autocomplete","new-password",2,"display","none"],["autocomplete","off","novalidate","",1,"crm-boxes-user-create",3,"formGroup"],[1,"crm-box"],[1,"crm-section","size-medium-small"],["class","crm-section-smaller-title",4,"ngIf"],[1,"crm-section-title"],[1,"crm-section-inputs",3,"ngClass"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass","appInputViewMode"],["type","text","formControlName","name",3,"placeholder"],["class","crm-input-error",4,"ngIf"],[1,"crm-input","crm-input-medium"],[1,"crm-section-items"],[1,"crm-item-option","crm-item-option-lang",3,"ngClass"],["type","button",1,"crm-button-secondary","crm-button-secondary-primary"],[1,"crm-input",3,"appHideIfNoData","disabled"],[1,"crm-text",2,"font-style","normal","color","black"],[1,"crm-input-input","crm-input-input-textarea",3,"appInputViewMode"],[1,"crm-input-input",3,"appInputViewMode"],["type","text","formControlName","legalName","placeholder","Introduce el nombre legal"],["type","number","formControlName","foundationYear","placeholder","Introduce el a\xf1o de fundaci\xf3n"],["type","text","formControlName","nifCif","placeholder","Introduce el NIF/CIF"],["type","number","formControlName","annualSales","placeholder","Introduce las ventas anuales (ej. '42+')"],["type","number","formControlName","annualRevenue","placeholder","Introduce los ingresos anuales (ej. '\u20ac1.8M+')"],["type","number","formControlName","portfolioSize","placeholder","Introduce el tama\xf1o del portfolio"],["id","provinceInput","type","text","formControlName","province","placeholder","Introduce la provincia","autocomplete","off","autocorrect","off","spellcheck","false",3,"input","disabled"],["id","cityInput","type","text","formControlName","city","placeholder","Introduce la ciudad","autocomplete","off","autocorrect","off","spellcheck","false",3,"input","disabled"],["type","text","formControlName","address","placeholder","Introduce el c\xf3digo postal"],["type","text","formControlName","postalCode","placeholder","Introduce el c\xf3digo postal"],[1,"crm-box","crm-section"],[3,"formGroup"],[1,"crm-section-buttons-right"],[1,"crm-section-inputs-double-input"],["type","text","formControlName","webUrl",3,"placeholder"],["type","text","formControlName","facebookUrl",3,"placeholder"],["type","text","formControlName","instagramUrl",3,"placeholder"],["type","text","formControlName","linkedinUrl",3,"placeholder"],["type","text","formControlName","twitterUrl",3,"placeholder"],[1,"crm-section-inline-cards"],[1,"crm-card"],["class","crm-section-buttons-right",4,"ngIf"],[1,"crm-section-smaller-title"],[1,"crm-input-error"],[1,"crm-item-option-left"],[1,"crm-item-option-flag"],[1,"crm-item-option-label"],[1,"crm-item-option-remove"],[1,"crm-item-option-remove",3,"click"],[1,"fas","fa-trash"],["type","button",1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fas","fa-add"],["rows","5","placeholder","Introduce la descripci\xf3n","formControlName","aboutUs"],["rows","5","placeholder","Introduce la descripci\xf3n","formControlName","storyAboutUs"],[1,"crm-item-option","crm-item-option-lang","edit"],[1,"crm-item-option","crm-item-option-lang"],[1,"crm-input-input-and-icon"],[1,"crm-input-input",3,"appInputViewMode","ngClass"],[3,"emitCountrySelected"],["type","text","formControlName","phoneNumber",3,"placeholder"],[1,"crm-input-input-and-icon-right"],[1,"crm-text","crm-text-underline","crm-text-underline-red"],[1,"crm-text","crm-text-underline","crm-text-underline-red",3,"click"],[1,"crm-section-buttons-group"],[1,"crm-input-input-and-icon",3,"appInputViewMode"],[1,"crm-input-input",3,"ngClass"],["type","email","formControlName","emailAddress",3,"placeholder"],[1,"crm-header-modal","crm-header-modal-no-padding",2,"margin-bottom","12px"],[1,"crm-card-title"],[1,"crm-buttons-group"],["class","crm-button-icon-solo red small",3,"click",4,"ngIf"],[1,"crm-card-content"],[1,"crm-section-inputs"],["type","text",3,"ngModelChange","ngModel","ngModelOptions"],["type","email",3,"ngModelChange","ngModel","ngModelOptions"],[3,"emitCountrySelected",4,"ngIf"],[1,"crm-button-icon-solo","red","small",3,"click"]],template:function(t,n){if(1&t){const a=e.RV6();e.nrm(0,"input",5)(1,"input",6),e.j41(2,"form",7)(3,"div",8)(4,"div",9),e.DNE(5,Re,2,0,"div",10),e.nrm(6,"app-file-uploader-manager",null,0),e.DNE(8,je,2,0,"div",10),e.nrm(9,"app-file-uploader-manager",null,1),e.DNE(11,Ee,2,0,"div",10),e.nrm(12,"app-file-uploader-manager",null,2),e.j41(14,"div",11),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"div",12)(18,"div",13)(19,"div",14),e.EFF(20),e.nI1(21,"translate"),e.k0s(),e.j41(22,"div",15),e.nrm(23,"input",16),e.nI1(24,"translate"),e.nI1(25,"translate"),e.k0s(),e.DNE(26,xe,3,3,"div",17),e.k0s(),e.j41(27,"div",18)(28,"div",14),e.EFF(29," Idiomas "),e.k0s(),e.j41(30,"div",19),e.Z7z(31,De,7,7,"div",20,e.fX1),e.DNE(33,Te,5,8,"button",21),e.k0s()(),e.j41(34,"div",22)(35,"div",14),e.EFF(36," Texto sobre nosotros "),e.k0s(),e.DNE(37,Ge,2,1,"div",23)(38,Pe,2,1,"div",24),e.k0s(),e.j41(39,"div",22)(40,"div",14),e.EFF(41," Texto nuestra historia "),e.k0s(),e.DNE(42,Ne,2,1,"div",23)(43,Ue,2,1,"div",24),e.k0s()(),e.j41(44,"div",11),e.EFF(45," Informaci\xf3n adicional "),e.k0s(),e.j41(46,"div",12)(47,"div",13)(48,"div",14),e.EFF(49,"Nombre Legal"),e.k0s(),e.j41(50,"div",25),e.nrm(51,"input",26),e.k0s()(),e.j41(52,"div",13)(53,"div",14),e.EFF(54,"A\xf1o de Fundaci\xf3n"),e.k0s(),e.j41(55,"div",25),e.nrm(56,"input",27),e.k0s()(),e.j41(57,"div",13)(58,"div",14),e.EFF(59,"NIF/CIF"),e.k0s(),e.j41(60,"div",25),e.nrm(61,"input",28),e.k0s()(),e.j41(62,"div",13)(63,"div",14),e.EFF(64,"Ventas Anuales"),e.k0s(),e.j41(65,"div",25),e.nrm(66,"input",29),e.k0s()(),e.j41(67,"div",13)(68,"div",14),e.EFF(69,"Ingresos Anuales"),e.k0s(),e.j41(70,"div",25),e.nrm(71,"input",30),e.k0s()(),e.j41(72,"div",13)(73,"div",14),e.EFF(74,"Portfolio"),e.k0s(),e.j41(75,"div",25),e.nrm(76,"input",31),e.k0s()(),e.j41(77,"div",13)(78,"div",14),e.EFF(79," Pa\xeds "),e.k0s(),e.j41(80,"div",19),e.DNE(81,Ve,2,1)(82,Ye,1,1),e.k0s()(),e.j41(83,"div",13)(84,"div",14),e.EFF(85,"Provincia"),e.k0s(),e.j41(86,"div",25)(87,"input",32,3),e.bIt("input",function(){return e.eBV(a),e.Njj(n.provinceValid=!1)}),e.k0s()(),e.DNE(89,Xe,2,0,"div",17),e.k0s(),e.j41(90,"div",13)(91,"div",14),e.EFF(92,"Ciudad"),e.k0s(),e.j41(93,"div",25)(94,"input",33,4),e.bIt("input",function(){return e.eBV(a),e.Njj(n.cityValid=!1)}),e.k0s()(),e.DNE(96,Be,2,0,"div",17),e.k0s(),e.j41(97,"div",13)(98,"div",14),e.EFF(99,"Direcci\xf3n"),e.k0s(),e.j41(100,"div",25),e.nrm(101,"input",34),e.k0s()(),e.j41(102,"div",13)(103,"div",14),e.EFF(104,"C\xf3digo Postal"),e.k0s(),e.j41(105,"div",25),e.nrm(106,"input",35),e.k0s()()()()(),e.j41(107,"div",36)(108,"div",11),e.EFF(109),e.nI1(110,"translate"),e.k0s(),e.j41(111,"div",12),e.Z7z(112,ze,14,21,"div",37,e.fX1),e.DNE(114,Je,7,8,"div",38),e.Z7z(115,Qe,13,21,"div",37,e.fX1),e.DNE(117,qe,7,8,"div",38),e.j41(118,"div",39)(119,"div",22)(120,"div",14),e.EFF(121," Web URL "),e.k0s(),e.j41(122,"div",25),e.nrm(123,"input",40),e.nI1(124,"translate"),e.k0s()()(),e.j41(125,"div",39)(126,"div",22)(127,"div",14),e.EFF(128," Facebook URL "),e.k0s(),e.j41(129,"div",25),e.nrm(130,"input",41),e.nI1(131,"translate"),e.k0s()(),e.j41(132,"div",22)(133,"div",14),e.EFF(134," Instagram URL "),e.k0s(),e.j41(135,"div",25),e.nrm(136,"input",42),e.nI1(137,"translate"),e.k0s()()(),e.j41(138,"div",39)(139,"div",22)(140,"div",14),e.EFF(141," LinkedIn URL "),e.k0s(),e.j41(142,"div",25),e.nrm(143,"input",43),e.nI1(144,"translate"),e.k0s()(),e.j41(145,"div",22)(146,"div",14),e.EFF(147," Twitter URL "),e.k0s(),e.j41(148,"div",25),e.nrm(149,"input",44),e.nI1(150,"translate"),e.k0s()()(),e.j41(151,"div",11),e.EFF(152," Oficinas "),e.k0s(),e.j41(153,"div",45),e.Z7z(154,nn,44,45,"div",46,e.fX1),e.k0s(),e.DNE(156,tn,5,0,"div",47),e.k0s()(),e.nrm(157,"br")(158,"br")(159,"br")(160,"br")(161,"br")(162,"br")(163,"br"),e.k0s()}if(2&t){let a,r;e.R7$(2),e.Y8G("formGroup",n.agencyForm),e.R7$(3),e.Y8G("ngIf",(null==n.agency?null:n.agency.photoUrl)||!n.disabled),e.R7$(3),e.Y8G("ngIf",(null==n.agency?null:n.agency.bannerUrl)||!n.disabled),e.R7$(3),e.Y8G("ngIf",(null==n.agency||null==n.agency.agencyFiles?null:n.agency.agencyFiles.length)>0||!n.disabled),e.R7$(4),e.SpI(" ",e.bMT(16,59,"text.general_info")," "),e.R7$(2),e.Y8G("ngClass",e.eq3(80,D,n.disabled)),e.R7$(3),e.SpI(" ",e.bMT(21,61,"text.name")," "),e.R7$(2),e.Y8G("ngClass",e.eq3(82,T,n.isControlInvalid("name")))("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.i5U(25,65,"text.input_placeholder",e.eq3(84,G,e.bMT(24,63,"text.name")))),e.R7$(3),e.Y8G("ngIf",n.isControlInvalid("name")),e.R7$(5),e.Dyx(null==n.agency?null:n.agency.languages),e.R7$(2),e.vxM(n.disabled?-1:33),e.R7$(),e.Y8G("appHideIfNoData",n.agencyForm.controls.aboutUs.value)("disabled",n.disabled),e.R7$(3),e.vxM(n.disabled?37:38),e.R7$(2),e.Y8G("appHideIfNoData",n.agencyForm.controls.storyAboutUs.value)("disabled",n.disabled),e.R7$(3),e.vxM(n.disabled?42:43),e.R7$(4),e.Y8G("ngClass",e.eq3(86,D,n.disabled)),e.R7$(4),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(6),e.vxM(n.disabled?82:81),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("disabled",n.disabled),e.R7$(2),e.Y8G("ngIf",null==(a=n.agencyForm.get("province"))?null:a.hasError("mustSelect")),e.R7$(4),e.Y8G("appInputViewMode",n.disabled||!n.provinceValid),e.R7$(),e.Y8G("disabled",n.disabled||!n.provinceValid),e.R7$(2),e.Y8G("ngIf",null==(r=n.agencyForm.get("city"))?null:r.hasError("mustSelect")),e.R7$(4),e.Y8G("appInputViewMode",n.disabled),e.R7$(5),e.Y8G("appInputViewMode",n.disabled),e.R7$(4),e.SpI(" ",e.bMT(110,68,"text.contact_info")," "),e.R7$(2),e.Y8G("ngClass",e.eq3(88,D,n.disabled)),e.R7$(),e.Dyx(n.phonesControls),e.R7$(2),e.vxM(n.disabled?-1:114),e.R7$(),e.Dyx(n.emailsControls),e.R7$(2),e.vxM(n.disabled?-1:117),e.R7$(2),e.Y8G("appHideIfNoData",n.agencyForm.controls.webUrl.value)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.bMT(124,70,"CONTACT_FORM.CONTACT_DATA.URL_FACEBOOK_PLACEHOLDER")),e.R7$(3),e.Y8G("appHideIfNoData",n.agencyForm.controls.facebookUrl.value)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.bMT(131,72,"CONTACT_FORM.CONTACT_DATA.URL_FACEBOOK_PLACEHOLDER")),e.R7$(2),e.Y8G("appHideIfNoData",n.agencyForm.controls.instagramUrl.value)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.bMT(137,74,"CONTACT_FORM.CONTACT_DATA.URL_INSTAGRAM_PLACEHOLDER")),e.R7$(3),e.Y8G("appHideIfNoData",n.agencyForm.controls.linkedinUrl.value)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.bMT(144,76,"CONTACT_FORM.CONTACT_DATA.URL_LINKEDIN_PLACEHOLDER")),e.R7$(2),e.Y8G("appHideIfNoData",n.agencyForm.controls.twitterUrl.value)("disabled",n.disabled),e.R7$(3),e.Y8G("appInputViewMode",n.disabled),e.R7$(),e.Y8G("placeholder",e.bMT(150,78,"CONTACT_FORM.CONTACT_DATA.URL_LINKEDIN_PLACEHOLDER")),e.R7$(5),e.Dyx(n.agencyOffices),e.R7$(2),e.Y8G("ngIf",!n.disabled)}},dependencies:[b.YU,b.bT,u.qT,u.me,u.Q0,u.BC,u.cb,u.j4,u.JD,u.vS,ve.Z,_e.M,z.F,be.S,j.D9]}),l})();const an=["agencyForm"];function ln(o,l){if(1&o){const i=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.onSaveUser())}),e.nrm(1,"i",7),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&o&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"text.save")," "))}function rn(o,l){if(1&o){const i=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.onEditUser())}),e.nrm(1,"i",9),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&o&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"text.edit")," "))}function sn(o,l){if(1&o&&e.DNE(0,ln,4,3,"button",4)(1,rn,4,3,"button",5),2&o){const i=e.XpG();e.vxM(i.editing?0:1)}}let cn=(()=>{var o;class l{constructor(t,n,a){this.api=t,this.toastService=n,this.state=a,this.agency=null,this.reloadData=new e.bkB,this.files=[],this.editing=!1}ngOnInit(){this.getState(),console.log("LA AGENCIA EN EL INFO",this.agency)}getState(){this.state.getState().subscribe(t=>{this.currentUser=t.user})}onSaveUser(){var t=this;return(0,h.A)(function*(){var n,a,r,s;let p={...t.agency,...t.agencyForm.agencyForm.value};p=yield t.agencyForm.fileUploaderManager.processProfilePic(p),p=yield t.agencyForm.bannerFileUploaderManagerComponent.processAgencyBanner(p),p.phones=p.phones.map(c=>c.phoneNumber),p.emails=p.emails.map(c=>c.emailAddress),p.agencyOffices=yield t.updateAgencyOffices(g.cloneDeep(t.agencyForm.agencyOffices)),null===(n=p)||void 0===n||delete n.promotions,null===(a=p)||void 0===a||delete a.agencyFiles,null===(r=p)||void 0===r||delete r.users;const f=yield t.api.updateAgencyById(p.id,p);let _=g.cloneDeep(null===(s=t.agencyForm)||void 0===s||null===(s=s.catalogFileUploaderManagerComponent)||void 0===s||null===(s=s.config)||void 0===s?void 0:s.files)||[];for(let c of _){if(null!=c&&c.new){var v,y;const m={agencyId:null===(v=t.agency)||void 0===v?void 0:v.id,name:"",category:c.category,label:c.label,orderIndex:null==c?void 0:c.orderIndex},C=yield t.api.uploadFile(c.fileBlob),A=null==C||null===(y=C.success)||void 0===y||null===(y=y.data)||void 0===y?void 0:y.fileName;m.name=A,yield t.api.createAgencyFiles(m)}if(null!=c&&c.deleted&&(yield t.api.deleteAgencyFilesById(null==c?void 0:c.id)),null!=c&&c.moved&&(null==c||!c.deleted)&&(null==c||!c.new)){let m=g.cloneDeep(c);delete m.moved,delete m.fileBase64,delete m.fileBlob,delete m.new,delete m.deleted,delete m.size,delete m.type,yield t.api.updateAgencyFilesById(null==m?void 0:m.id,m)}}null!=f&&f.success?t.toastService.showSuccessToast("La agencia ha sido actualizada correctamente"):t.toastService.showErrorToast("Ha ocurrido un error al actualizar la agencia"),t.editing=!1,t.agencyForm.fileUploaderManager.setEditingMode(!1),t.agencyForm.bannerFileUploaderManagerComponent.setEditingMode(!1),t.agencyForm.fileUploaderOfficeManagers.forEach((c,m)=>{c.setEditingMode(!1)}),t.agencyForm.catalogFileUploaderManagerComponent.setEditingMode(!1),t.reloadData.emit()})()}updateAgencyOffices(t){return(0,h.A)(function*(){return t})()}onEditUser(){this.editing=!0,this.agencyForm.fileUploaderManager.setEditingMode(!0),this.agencyForm.bannerFileUploaderManagerComponent.setEditingMode(!0),this.agencyForm.fileUploaderOfficeManagers.forEach((t,n)=>{t.setEditingMode(!0)}),this.agencyForm.catalogFileUploaderManagerComponent.setEditingMode(!0)}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(x.i),e.rXU(B.f),e.rXU($.c))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-agency-details-info"]],viewQuery:function(t,n){if(1&t&&e.GBs(an,5),2&t){let a;e.mGM(a=e.lsd())&&(n.agencyForm=a.first)}},inputs:{agency:"agency"},outputs:{reloadData:"reloadData"},decls:6,vars:3,consts:[["agencyForm",""],[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-buttons-group"],[3,"agency","disabled"],[1,"crm-button"],[1,"crm-button-secondary","crm-button-secondary-primary"],[1,"crm-button",3,"click"],[1,"fa","fa-check"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fa","fa-edit"]],template:function(t,n){1&t&&(e.j41(0,"div",1),e.nrm(1,"div"),e.j41(2,"div",2),e.DNE(3,sn,2,1),e.k0s()(),e.nrm(4,"app-agency-form",3,0)),2&t&&(e.R7$(3),e.vxM("agency"===(null==n.currentUser?null:n.currentUser.accountType)?3:-1),e.R7$(),e.Y8G("agency",n.agency)("disabled",!n.editing))},dependencies:[on,j.D9]}),l})();const dn=o=>({"crm-block-body-blue-content-no-padding":o}),N=o=>({fatherObj:o,type:"agency"}),pn=()=>({type:"agencyFolder"});function gn(o,l){if(1&o){const i=e.RV6();e.j41(0,"div",5)(1,"app-agency-details-presentation",7),e.bIt("reloadData",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.ngOnInit())}),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(),e.Y8G("agency",i.agency)}}function un(o,l){if(1&o&&e.nrm(0,"app-dashboard",8),2&o){const i=e.XpG(3);e.Y8G("isMainPage",!1)("isAgency",!0)("options",i.agencyDashboardOptions)}}function mn(o,l){if(1&o){const i=e.RV6();e.j41(0,"app-agency-details-info",7),e.bIt("reloadData",function(){e.eBV(i);const n=e.XpG(3);return e.Njj(n.ngOnInit())}),e.k0s()}if(2&o){const i=e.XpG(3);e.Y8G("agency",i.agency)}}function fn(o,l){if(1&o&&e.nrm(0,"app-users-list",10),2&o){const i=e.XpG(3);e.Y8G("options",e.eq3(1,N,i.agency))}}function yn(o,l){if(1&o&&e.nrm(0,"app-operations-list",10),2&o){const i=e.XpG(3);e.Y8G("options",e.eq3(1,N,i.agency))}}function vn(o,l){if(1&o&&e.nrm(0,"app-file-explorer",11),2&o){const i=e.XpG(3);e.Y8G("options",e.lJ4(2,pn))("directoryBaseElement",i.agencyFolder)}}function _n(o,l){if(1&o&&e.nrm(0,"app-registers-list",10),2&o){const i=e.XpG(3);e.Y8G("options",e.eq3(1,N,i.agency))}}function bn(o,l){if(1&o&&(e.j41(0,"div",6),e.DNE(1,un,1,3,"app-dashboard",8)(2,mn,1,1,"app-agency-details-info",9)(3,fn,1,3,"app-users-list",10)(4,yn,1,3,"app-operations-list",10)(5,vn,1,3,"app-file-explorer",11)(6,_n,1,3,"app-registers-list",10),e.k0s()),2&o){const i=e.XpG(2);e.Y8G("ngClass",e.eq3(7,dn,"users"===i.activeTab||"operations"===i.activeTab||"registers"===i.activeTab)),e.R7$(),e.vxM("agency_dashboard"===i.activeTab?1:-1),e.R7$(),e.vxM("info"===i.activeTab?2:-1),e.R7$(),e.vxM("users"===i.activeTab?3:-1),e.R7$(),e.vxM("operations"===i.activeTab?4:-1),e.R7$(),e.vxM("files"===i.activeTab?5:-1),e.R7$(),e.vxM("registers"===i.activeTab?6:-1)}}function hn(o,l){if(1&o&&e.DNE(0,gn,2,1,"div",5)(1,bn,7,9,"div",6),2&o){const i=e.XpG();e.vxM("presentation"===i.activeTab?0:1)}}const Fn=[{path:"",component:(()=>{var o;class l{constructor(t,n,a,r,s,p){this.activatedRoute=t,this.toastService=n,this.headerService=a,this.router=r,this.api=s,this.byvaroState=p,this.agencyParameterId=null,this.agency=null,this.activeTab="info",this.agencyTabs=[],this.baseTabs=[{id:"3",title:"presentation",active:!0},{id:"7",title:"agency_dashboard",active:!0},{id:"1",title:"info",active:!1},{id:"2",title:"users",active:!1},{id:"4",title:"operations",active:!1},{id:"5",title:"files",active:!1},{id:"6",title:"registers",active:!1}],this.agencyDashboardOptions={},this.currentUser=null,this.agencyFolder=null}ngOnInit(){var t=this;return(0,h.A)(function*(){if(t.agencyParameterId=t.activatedRoute.snapshot.paramMap.get("id"),t.agencyDashboardOptions={agencyId:t.agencyParameterId},t.byvaroState.getState().subscribe(r=>{t.currentUser=r.user}),"mine"===t.agencyParameterId){var n;t.agencyTabs=t.baseTabs;const r=yield t.api.getCurrentAgency();if(null!=r&&null!==(n=r.success)&&void 0!==n&&n.data){var a;t.agency=r.success.data;let p={},f=null,_={page:0,itemsPerPage:50};const v=yield t.api.getUser(p,f,_);null!=v&&null!==(a=v.success)&&void 0!==a&&a.data&&(t.agency.users=v.success.data)}}else t.agencyTabs=t.baseTabs.filter(r=>"1"!==r.id),yield t.getData();t.agencyFolder={type:"agency_folder",name:"Agencia",parent:t.agency}})()}ionViewWillEnter(){this.headerService.setConfig({title:"agency_details"})}getData(){var t=this;return(0,h.A)(function*(){if(t.agency=yield t.getAgencyById(),console.log("agency",t.agency),!t.agency)return t.toastService.showToast({text:"No existe ninguna agencia con ese ID",icon:"fas fa-exclamation-triangle",theme:"red",time:3e3}),void t.router.navigate(["/promoters"])})()}getAgencyById(){var t=this;return(0,h.A)(function*(){var n,a;if(!t.agencyParameterId)return null;const r=yield t.api.getAgency({id:{equals:t.agencyParameterId}},null,null,{promotions:{apply:!0}});r.error&&t.toastService.showToast({text:"Error al leer esta Agencia",icon:"fas fa-exclamation-triangle",theme:"red",time:3e3});const[s]=null==r||null===(n=r.success)||void 0===n?void 0:n.data,p=yield t.api.getUsersOfAccount(s.id);return s.users=(null===(a=p.success)||void 0===a?void 0:a.data)||[],s})()}onEditAgency(){var t=this;return(0,h.A)(function*(){var n;const a=g.cloneDeep(t.agency);null==a||delete a.promotions,null==a||delete a.users,null==a||delete a.agencyFiles,null==a||delete a.agencyInvitationToPromotions,console.log("agencyToEdit",a),a.officesCount=(null===(n=a.offices)||void 0===n?void 0:n.length)||0,(yield t.api.updateAgencyById(t.agencyParameterId,a)).success?t.toastService.showToast({text:"Agencia actualizada correctamente",theme:"success",time:2e3}):t.toastService.showToast({text:"Error al actualizar la agencia",icon:"fas fa-exclamation-triangle",theme:"red",time:3e3})})()}onTabClicked(t){this.activeTab=t}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(I.nX),e.rXU(B.f),e.rXU(Q.d),e.rXU(I.Ix),e.rXU(x.i),e.rXU($.c))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-agency-details"]],decls:6,vars:2,consts:[[1,"crm-block-body"],[1,"crm-block-body-fixed"],[1,"crm-block-details-header"],[1,"crm-block-details-bottom"],[3,"tabClicked","tabs"],[1,"crm-block-body-blue-content",2,"padding","0"],[1,"crm-block-body-blue-content",3,"ngClass"],[3,"reloadData","agency"],[3,"isMainPage","isAgency","options"],[3,"agency"],[3,"options"],[3,"options","directoryBaseElement"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-tabs",4),e.bIt("tabClicked",function(r){return n.onTabClicked(r)}),e.k0s()()()(),e.DNE(5,hn,2,1),e.k0s()),2&t&&(e.R7$(4),e.Y8G("tabs",n.agencyTabs),e.R7$(),e.vxM(null!=n.agency&&n.agency.id?5:-1))},dependencies:[b.YU,L.O,q.s,de,pe.Q,ge.b,ue.c,me.G,cn]}),l})()}];let Cn=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[I.iI.forChild(Fn),I.iI]}),l})();var Z=d(2652),In=d(6812);let kn=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[b.MD,u.X1,u.YN,j.h,In.u,F.bv,Z.T,z.F]}),l})();var Mn=d(4831),An=d(3263),Rn=d(9662),jn=d(7991);let En=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[b.MD,F.bv,u.X1,An.l,Rn.Y,jn.S]}),l})();var xn=d(5166),$n=d(8284),Dn=d(1362),Tn=d(1414);let Gn=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[b.MD,u.YN,F.bv,Cn,L.O,Z.T,j.h,kn,Mn.UsersListPageModule,En,xn.OperationsListPageModule,$n.o,Dn.RegistersListPageModule,Tn.DashboardPageModule]}),l})()}}]);